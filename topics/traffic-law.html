<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Interactive Texas Transportation Code Study Guide for Law Enforcement - Mobile Optimized">
    <meta name="keywords" content="Texas Transportation Code, Law Enforcement Training, BPOC, Interactive Study Guide">
    <meta name="theme-color" content="#2c3e50">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <title>Texas Transportation Code Study Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Prevent text size adjust on iOS */
        html {
            -webkit-text-size-adjust: 100%;
            -moz-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-size: 16px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Enhanced Header Design */
        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.98);
            padding: 3rem 2rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 20px 60px rgba(31, 38, 135, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #3498db, #2ecc71);
            background-size: 400% 400%;
            animation: gradient 3s ease infinite;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .header h1 {
            font-size: 3rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 1.3rem;
            color: #34495e;
            margin-bottom: 1.5rem;
            font-weight: 500;
        }

        /* Enhanced Progress Bar */
        .progress-container {
            background: rgba(236, 240, 241, 0.9);
            border-radius: 25px;
            padding: 15px;
            margin-top: 2rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .progress-bar {
            background: linear-gradient(90deg, #3498db, #2ecc71, #e74c3c);
            height: 12px;
            border-radius: 6px;
            width: 0%;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: progress-animation 2s linear infinite;
        }

        @keyframes progress-animation {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 1rem;
            color: #34495e;
            font-weight: 600;
        }

        /* Enhanced Navigation */
        .navigation {
            background: rgba(255, 255, 255, 0.98);
            padding: 1.5rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 
                0 15px 50px rgba(31, 38, 135, 0.12),
                0 5px 20px rgba(31, 38, 135, 0.08);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            position: relative;
            overflow: hidden;
        }

        .navigation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #667eea, #764ba2, #3498db, #2ecc71, #f39c12);
            background-size: 300% 300%;
            animation: shimmer 3s ease-in-out infinite;
            opacity: 0.8;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #3498db 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 35px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            min-width: 110px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent
            );
            transition: left 0.6s ease;
            z-index: 1;
        }

        .nav-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
            border-radius: 50%;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translate(-50%, -50%);
            z-index: 0;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover::after {
            width: 200px;
            height: 200px;
        }

        .nav-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 
                0 15px 40px rgba(102, 126, 234, 0.35),
                0 5px 15px rgba(102, 126, 234, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 50%, #2980b9 100%);
        }

        .nav-btn:active {
            transform: translateY(-2px) scale(1.02);
            transition: all 0.1s ease;
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 50%, #16a085 100%);
            box-shadow: 
                0 12px 35px rgba(46, 204, 113, 0.4),
                0 5px 15px rgba(46, 204, 113, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            animation: activeGlow 2s ease-in-out infinite alternate;
        }

        @keyframes activeGlow {
            0% { 
                box-shadow: 
                    0 12px 35px rgba(46, 204, 113, 0.4),
                    0 5px 15px rgba(46, 204, 113, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
            100% { 
                box-shadow: 
                    0 15px 45px rgba(46, 204, 113, 0.5),
                    0 8px 20px rgba(46, 204, 113, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.4);
            }
        }

        /* Enhanced Module Cards */
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 2.5rem;
            margin-bottom: 2rem;
        }

        .module-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            padding: 2.5rem;
            box-shadow: 
                0 20px 60px rgba(31, 38, 135, 0.08),
                0 8px 25px rgba(31, 38, 135, 0.05),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #3498db 50%, 
                #2ecc71 75%, 
                #f39c12 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 25px 25px 0 0;
        }

        .module-card::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, 
                rgba(102, 126, 234, 0.08) 0%, 
                rgba(118, 75, 162, 0.05) 30%,
                transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 0;
        }

        .module-card:hover::before {
            transform: scaleX(1);
        }

        .module-card:hover::after {
            transform: translate(-50%, -50%) scale(4);
        }

        .module-card:hover {
            transform: translateY(-12px) scale(1.03) rotateX(2deg);
            box-shadow: 
                0 35px 80px rgba(31, 38, 135, 0.15),
                0 15px 35px rgba(31, 38, 135, 0.1),
                0 0 0 1px rgba(102, 126, 234, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        .module-card:active {
            transform: translateY(-8px) scale(1.01);
            transition: all 0.1s ease;
        }

        .module-card.completed {
            border-left: 8px solid #2ecc71;
            background: linear-gradient(135deg, 
                rgba(46, 204, 113, 0.08) 0%, 
                rgba(255, 255, 255, 0.98) 100%);
            box-shadow: 
                0 20px 60px rgba(46, 204, 113, 0.15),
                0 8px 25px rgba(46, 204, 113, 0.1),
                0 0 30px rgba(46, 204, 113, 0.05);
            animation: completedPulse 3s ease-in-out infinite;
        }

        .module-card.completed::before {
            background: linear-gradient(90deg, 
                #2ecc71 0%, 
                #27ae60 50%, 
                #16a085 100%);
            transform: scaleX(1);
            animation: completedShimmer 2s ease infinite;
        }

        @keyframes completedPulse {
            0%, 100% { 
                box-shadow: 
                    0 20px 60px rgba(46, 204, 113, 0.15),
                    0 8px 25px rgba(46, 204, 113, 0.1),
                    0 0 30px rgba(46, 204, 113, 0.05);
            }
            50% { 
                box-shadow: 
                    0 25px 70px rgba(46, 204, 113, 0.2),
                    0 12px 30px rgba(46, 204, 113, 0.15),
                    0 0 40px rgba(46, 204, 113, 0.08);
            }
        }

        @keyframes completedShimmer {
            0% { 
                background-position: 0% 50%;
                opacity: 0.8;
            }
            50% { 
                background-position: 100% 50%;
                opacity: 1;
            }
            100% { 
                background-position: 0% 50%;
                opacity: 0.8;
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 200% 50%; }
            75% { background-position: 300% 50%; }
            100% { background-position: 400% 50%; }
        }

        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .module-number {
            background: linear-gradient(135deg, 
                #667eea 0%, 
                #764ba2 30%, 
                #3498db 70%, 
                #2980b9 100%);
            color: white;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.6rem;
            margin-right: 1.5rem;
            box-shadow: 
                0 12px 30px rgba(102, 126, 234, 0.4),
                0 4px 15px rgba(102, 126, 234, 0.2),
                0 0 0 4px rgba(255, 255, 255, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.5),
                inset 0 -2px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .module-number::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                transparent 50%,
                rgba(0, 0, 0, 0.1) 100%);
            transform: translate(-50%, -50%) scale(0);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .module-number::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            background: linear-gradient(45deg, 
                rgba(102, 126, 234, 0.6) 0%,
                rgba(118, 75, 162, 0.6) 25%,
                rgba(52, 152, 219, 0.6) 50%,
                rgba(41, 128, 185, 0.6) 100%);
            z-index: -2;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .module-card:hover .module-number {
            transform: scale(1.2) rotate(15deg);
            box-shadow: 
                0 20px 45px rgba(102, 126, 234, 0.5),
                0 8px 20px rgba(102, 126, 234, 0.3),
                0 0 0 6px rgba(255, 255, 255, 0.4),
                0 0 40px rgba(102, 126, 234, 0.3),
                inset 0 3px 0 rgba(255, 255, 255, 0.6),
                inset 0 -3px 0 rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, 
                #764ba2 0%, 
                #667eea 30%, 
                #2980b9 70%, 
                #3498db 100%);
        }

        .module-card:hover .module-number::before {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .module-card:hover .module-number::after {
            opacity: 1;
            transform: scale(1.3);
            animation: numberGlow 2s ease-in-out infinite alternate;
        }

        @keyframes numberGlow {
            0% { 
                opacity: 0.6;
                transform: scale(1.3);
            }
            100% { 
                opacity: 0.9;
                transform: scale(1.4);
            }
        }

        .module-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
            letter-spacing: -0.01em;
        }

        .module-description {
            color: #7f8c8d;
            margin-bottom: 1.5rem;
            font-size: 1rem;
            line-height: 1.6;
        }

        .module-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .status-badge {
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .status-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left 0.6s ease;
        }

        .status-badge:hover::before {
            left: 100%;
        }

        .status-badge.not-started {
            background: linear-gradient(135deg, 
                #bdc3c7 0%, 
                #95a5a6 25%,
                #7f8c8d 50%,
                #34495e 100%);
            color: white;
            box-shadow: 
                0 6px 20px rgba(189, 195, 199, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .status-badge.not-started:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 
                0 10px 30px rgba(189, 195, 199, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .status-badge.in-progress {
            background: linear-gradient(135deg, 
                #f39c12 0%, 
                #e67e22 25%,
                #d68910 50%,
                #b7950b 100%);
            color: white;
            box-shadow: 
                0 6px 20px rgba(243, 156, 18, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: progressPulse 2s ease-in-out infinite alternate;
        }

        @keyframes progressPulse {
            0% { 
                box-shadow: 
                    0 6px 20px rgba(243, 156, 18, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
            }
            100% { 
                box-shadow: 
                    0 8px 25px rgba(243, 156, 18, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
        }

        .status-badge.in-progress:hover {
            transform: translateY(-2px) scale(1.05);
            animation: none;
            box-shadow: 
                0 10px 30px rgba(243, 156, 18, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .status-badge.completed {
            background: linear-gradient(135deg, 
                #2ecc71 0%, 
                #27ae60 25%,
                #1e8449 50%,
                #148f77 100%);
            color: white;
            box-shadow: 
                0 6px 20px rgba(46, 204, 113, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: completedGlow 3s ease-in-out infinite alternate;
        }

        @keyframes completedGlow {
            0% { 
                box-shadow: 
                    0 6px 20px rgba(46, 204, 113, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
            }
            100% { 
                box-shadow: 
                    0 10px 30px rgba(46, 204, 113, 0.4),
                    0 0 20px rgba(46, 204, 113, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
        }

        .status-badge.completed:hover {
            transform: translateY(-2px) scale(1.05);
            animation: none;
            box-shadow: 
                0 12px 35px rgba(46, 204, 113, 0.4),
                0 0 25px rgba(46, 204, 113, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        /* Enhanced Module Content */
        .module-content {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 3rem;
            margin-top: 2rem;
            box-shadow: 0 20px 60px rgba(31, 38, 135, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: none;
        }

        .module-content.active {
            display: block;
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-section {
            margin-bottom: 3rem;
        }

        .content-section h3 {
            color: #2c3e50;
            margin-bottom: 2rem;
            font-size: 2rem;
            font-weight: 800;
            border-bottom: 3px solid #3498db;
            padding-bottom: 1rem;
            position: relative;
            letter-spacing: -0.02em;
        }

        .content-section h3::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #e74c3c, #f39c12);
        }

        .content-section h4 {
            color: #34495e;
            margin: 2rem 0 1.5rem 0;
            font-size: 1.4rem;
            font-weight: 700;
            position: relative;
            padding-left: 20px;
        }

        .content-section h4::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-radius: 2px;
        }

        .content-section p {
            margin-bottom: 1.5rem;
            text-align: left;
            font-size: 1.05rem;
            line-height: 1.8;
            color: #2c3e50;
        }

        .content-section p strong {
            color: #2c3e50;
            font-weight: 700;
        }

        .content-section ul, .content-section ol {
            margin-left: 2rem;
            margin-bottom: 1.5rem;
        }

        .content-section li {
            margin-bottom: 0.8rem;
            font-size: 1.05rem;
            line-height: 1.7;
        }

        /* Enhanced Information Boxes */
        .highlight-box {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
            font-weight: 600;
            box-shadow: 0 15px 40px rgba(238, 90, 82, 0.3);
            position: relative;
            overflow: hidden;
        }

        .highlight-box::before {
            content: '💡';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            opacity: 0.8;
        }

        .info-box {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
            box-shadow: 0 15px 40px rgba(52, 152, 219, 0.3);
            position: relative;
            overflow: hidden;
        }

        .info-box::before {
            content: 'ℹ️';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            opacity: 0.8;
        }

        /* Enhanced Apply It Sections with Better Mobile Support */
        .apply-it-section {
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.98) 0%,
                rgba(255, 255, 255, 0.95) 50%,
                rgba(248, 249, 250, 0.98) 100%);
            border: 3px solid rgba(102, 126, 234, 0.2);
            border-radius: 25px;
            padding: 3rem 2.5rem;
            margin: 3rem 0;
            position: relative;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(25px);
            box-shadow: 
                0 20px 60px rgba(102, 126, 234, 0.08),
                0 8px 25px rgba(102, 126, 234, 0.05),
                0 0 0 1px rgba(102, 126, 234, 0.1);
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .apply-it-section::before {
            content: '🎯 APPLY IT';
            position: absolute;
            top: -18px;
            left: 30px;
            background: linear-gradient(135deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #5dade2 50%,
                #3498db 100%);
            color: white;
            padding: 14px 25px;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 800;
            box-shadow: 
                0 10px 30px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid rgba(255, 255, 255, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            animation: applyItPulse 4s ease-in-out infinite;
            z-index: 10;
        }

        @keyframes applyItPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 10px 30px rgba(102, 126, 234, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 
                    0 15px 40px rgba(102, 126, 234, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.4);
            }
        }

        .apply-it-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #3498db 50%,
                #2ecc71 75%,
                #667eea 100%);
            background-size: 300% 100%;
            animation: gradientFlow 4s ease-in-out infinite;
            border-radius: 25px 25px 0 0;
            opacity: 0.8;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .apply-it-section:hover {
            transform: translateY(-10px) scale(1.02) rotateX(3deg);
            box-shadow: 
                0 35px 80px rgba(102, 126, 234, 0.15),
                0 15px 35px rgba(102, 126, 234, 0.1),
                0 0 0 1px rgba(102, 126, 234, 0.2),
                0 0 50px rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.4);
        }

        .apply-it-section:hover::after {
            height: 8px;
            opacity: 1;
            animation-duration: 2s;
        }

        /* Enhanced Apply It Header */
        .apply-it-header {
            color: #2c3e50;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 2rem;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.02em;
        }

        /* Enhanced Apply It Scenario Text */
        .apply-it-scenario {
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(248, 249, 250, 0.9) 100%);
            padding: 2.2rem 2.5rem;
            border-radius: 18px;
            margin: 1.5rem 0;
            border-left: 6px solid #f39c12;
            font-style: italic;
            line-height: 1.7;
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.1);
            position: relative;
            color: #2c3e50;
            font-size: 1.05rem;
        }

        .apply-it-scenario p {
            margin: 0;
            color: #34495e;
            font-weight: 500;
            letter-spacing: 0.01em;
        }

        /* Enhanced Apply It Question Text */
        .apply-it-question {
            background: linear-gradient(145deg, 
                rgba(52, 152, 219, 0.08) 0%,
                rgba(255, 255, 255, 0.95) 100%);
            padding: 2rem 2.5rem;
            border-radius: 18px;
            margin: 1.5rem 0;
            border-left: 6px solid #3498db;
            font-weight: 600;
            line-height: 1.7;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.1);
            position: relative;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        .apply-it-question p {
            margin: 0;
            color: #2c3e50;
            font-size: 1.15rem;
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        .apply-it-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1.2rem;
            margin: 1.5rem 0;
        }

        .apply-it-option {
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.98) 0%,
                rgba(248, 249, 250, 0.95) 100%);
            border: 3px solid rgba(52, 152, 219, 0.2);
            padding: 1.5rem 2rem;
            border-radius: 22px;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            user-select: none;
            text-align: center;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            box-shadow: 
                0 8px 25px rgba(52, 152, 219, 0.08),
                0 2px 10px rgba(52, 152, 219, 0.05),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            transform-style: preserve-3d;
            font-size: 1.05rem;
            line-height: 1.5;
        }

        .apply-it-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(52, 152, 219, 0.15), 
                transparent);
            transition: left 0.7s ease;
            z-index: 1;
        }

        .apply-it-option::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, 
                rgba(52, 152, 219, 0.2) 0%, 
                rgba(52, 152, 219, 0.08) 50%,
                transparent 70%);
            border-radius: 50%;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translate(-50%, -50%);
            z-index: 0;
        }

        .apply-it-option:hover::before {
            left: 100%;
        }

        .apply-it-option:hover::after {
            width: 300px;
            height: 300px;
        }

        .apply-it-option:hover {
            background: linear-gradient(145deg, 
                rgba(52, 152, 219, 0.12) 0%, 
                rgba(52, 152, 219, 0.08) 50%,
                rgba(255, 255, 255, 0.98) 100%);
            border-color: #3498db;
            transform: translateY(-5px) scale(1.03) rotateX(3deg);
            box-shadow: 
                0 15px 40px rgba(52, 152, 219, 0.15),
                0 5px 15px rgba(52, 152, 219, 0.1),
                0 0 0 1px rgba(52, 152, 219, 0.2);
        }

        .apply-it-option:active {
            transform: translateY(-3px) scale(1.01);
            transition: all 0.1s ease;
        }

        .apply-it-option.selected {
            background: linear-gradient(135deg, 
                #3498db 0%, 
                #2980b9 25%,
                #5dade2 50%,
                #2471a3 100%);
            color: white;
            border-color: #2980b9;
            transform: scale(1.05) rotateX(2deg);
            box-shadow: 
                0 12px 35px rgba(52, 152, 219, 0.3),
                0 4px 15px rgba(52, 152, 219, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            animation: selectedGlow 2s ease-in-out infinite alternate;
        }

        @keyframes selectedGlow {
            0% { 
                box-shadow: 
                    0 12px 35px rgba(52, 152, 219, 0.3),
                    0 4px 15px rgba(52, 152, 219, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
            100% { 
                box-shadow: 
                    0 18px 45px rgba(52, 152, 219, 0.4),
                    0 8px 20px rgba(52, 152, 219, 0.25),
                    inset 0 1px 0 rgba(255, 255, 255, 0.4);
            }
        }

        .apply-it-option.correct {
            background: linear-gradient(135deg, 
                #2ecc71 0%, 
                #27ae60 25%,
                #58d68d 50%,
                #1e8449 100%);
            color: white;
            border-color: #27ae60;
            transform: scale(1.05) rotateX(2deg);
            box-shadow: 
                0 15px 40px rgba(46, 204, 113, 0.35),
                0 5px 15px rgba(46, 204, 113, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            animation: correctPulse 1.2s ease-out 2;
        }

        @keyframes correctPulse {
            0%, 100% { 
                transform: scale(1.05) rotateX(2deg);
            }
            50% { 
                transform: scale(1.1) rotateX(3deg);
                box-shadow: 
                    0 20px 50px rgba(46, 204, 113, 0.4),
                    0 8px 20px rgba(46, 204, 113, 0.25),
                    inset 0 1px 0 rgba(255, 255, 255, 0.4);
            }
        }

        .apply-it-option.incorrect {
            background: linear-gradient(135deg, 
                #e74c3c 0%, 
                #c0392b 25%,
                #ec7063 50%,
                #a93226 100%);
            color: white;
            border-color: #c0392b;
            transform: scale(1.05) rotateX(2deg);
            box-shadow: 
                0 15px 40px rgba(231, 76, 60, 0.35),
                0 5px 15px rgba(231, 76, 60, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            animation: incorrectShake 0.8s ease-out;
        }

        /* Enhanced Apply It Feedback Readability */
        .apply-it-feedback {
            background: linear-gradient(145deg, 
                rgba(255, 255, 255, 0.98) 0%,
                rgba(248, 249, 250, 0.95) 100%);
            padding: 2.5rem;
            border-radius: 20px;
            margin-top: 2rem;
            border-left: 6px solid #2ecc71;
            opacity: 0;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(20px);
            box-shadow: 
                0 15px 40px rgba(46, 204, 113, 0.15),
                0 5px 15px rgba(46, 204, 113, 0.1);
            position: relative;
            overflow: hidden;
            color: #2c3e50;
        }

        .apply-it-feedback::before {
            content: '✅';
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 1.5rem;
            animation: successBounce 0.8s ease-out;
        }

        .apply-it-feedback.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .apply-it-feedback.incorrect {
            border-left-color: #e74c3c;
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.1);
        }

        .apply-it-feedback.incorrect::before {
            content: '❌';
            animation: errorShake 0.8s ease-out;
        }

        .apply-it-feedback p {
            margin: 0 0 1rem 0;
            color: #2c3e50;
            font-size: 1.05rem;
            line-height: 1.6;
            font-weight: 500;
        }

        .apply-it-feedback strong {
            color: #27ae60;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .apply-it-feedback.incorrect strong {
            color: #e74c3c;
        }

        .apply-it-feedback ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .apply-it-feedback li {
            margin: 0.5rem 0;
            color: #34495e;
            font-size: 1rem;
            line-height: 1.5;
        }

        .apply-it-fill-blank {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            border: 2px solid rgba(52, 152, 219, 0.3);
            border-radius: 10px;
            padding: 1rem 1.2rem;
            font-size: 1rem;
            margin: 0 0.8rem;
            min-width: 180px;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
        }

        .apply-it-fill-blank::placeholder {
            color: rgba(52, 152, 219, 0.6);
            font-style: italic;
        }

        .apply-it-fill-blank:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2), 0 4px 15px rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }

        .apply-it-fill-blank.correct {
            border-color: #2ecc71;
            background: linear-gradient(145deg, rgba(46, 204, 113, 0.15), rgba(46, 204, 113, 0.08));
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2);
        }

        .apply-it-fill-blank.incorrect {
            border-color: #e74c3c;
            background: linear-gradient(145deg, rgba(231, 76, 60, 0.15), rgba(231, 76, 60, 0.08));
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.2);
            animation: inputShake 0.5s ease-out;
        }

        .warning-box {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
            box-shadow: 0 15px 40px rgba(243, 156, 18, 0.3);
            position: relative;
            overflow: hidden;
        }

        .warning-box::before {
            content: '⚠️';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            opacity: 0.8;
        }

        /* Add subtle animations to boxes */
        .highlight-box, .info-box, .warning-box {
            transition: all 0.3s ease;
        }

        .highlight-box:hover, .info-box:hover, .warning-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }

        /* Enhanced Footer */
        .footer {
            text-align: center;
            background: rgba(255, 255, 255, 0.98);
            padding: 2rem;
            border-radius: 20px;
            margin-top: 3rem;
            box-shadow: 0 15px 50px rgba(31, 38, 135, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .footer p {
            color: #7f8c8d;
            font-size: 1rem;
            font-weight: 500;
        }

        /* Reading Progress Indicator */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            z-index: 1000;
            transition: width 0.1s ease;
        }

        /* Scroll to Top Button */
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, 
                #667eea 0%, 
                #764ba2 25%,
                #3498db 50%,
                #2980b9 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.4rem;
            box-shadow: 
                0 10px 30px rgba(102, 126, 234, 0.3),
                0 4px 15px rgba(102, 126, 234, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            visibility: hidden;
            z-index: 1000;
            transform-style: preserve-3d;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .scroll-to-top::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.2) 0%,
                transparent 50%,
                rgba(0, 0, 0, 0.1) 100%);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .scroll-to-top::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, 
                rgba(102, 126, 234, 0.6) 0%,
                rgba(118, 75, 162, 0.6) 25%,
                rgba(52, 152, 219, 0.6) 50%,
                rgba(41, 128, 185, 0.6) 100%);
            border-radius: 50%;
            z-index: -1;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
            animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100px) scale(0.8);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .scroll-to-top:hover::before {
            opacity: 1;
        }

        .scroll-to-top:hover::after {
            opacity: 1;
            transform: scale(1.2);
            animation: buttonGlow 2s ease-in-out infinite alternate;
        }

        @keyframes buttonGlow {
            0% { 
                opacity: 0.6;
                transform: scale(1.2);
            }
            100% { 
                opacity: 0.9;
                transform: scale(1.3);
            }
        }

        .scroll-to-top:hover {
            transform: translateY(-5px) scale(1.1) rotateX(10deg);
            box-shadow: 
                0 20px 50px rgba(102, 126, 234, 0.4),
                0 8px 20px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            background: linear-gradient(135deg, 
                #764ba2 0%, 
                #667eea 25%,
                #2980b9 50%,
                #3498db 100%);
        }

        .scroll-to-top:active {
            transform: translateY(-3px) scale(1.05);
            transition: all 0.1s ease;
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
            }

            .header {
                padding: 2rem 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1.1rem;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .module-card {
                padding: 2rem 1.5rem;
            }
            
            .navigation {
                padding: 1rem;
            }
            
            .nav-buttons {
                flex-direction: column;
                align-items: center;
                gap: 0.8rem;
            }
            
            .nav-btn {
                width: 100%;
                max-width: 250px;
                text-align: center;
                padding: 0.8rem 1.5rem;
            }
            
            .module-content {
                padding: 2rem 1rem;
                margin: 1rem 0;
            }
            
            .content-section {
                padding: 1.5rem;
            }
            
            .content-section h3 {
                font-size: 1.6rem;
            }
            
            .content-section h4 {
                font-size: 1.3rem;
            }

            /* Apply It Mobile Optimizations */
            .apply-it-section {
                padding: 2.5rem 1.8rem;
                margin: 2rem 0;
                border-radius: 20px;
            }

            .apply-it-section::before {
                top: -15px;
                left: 20px;
                padding: 10px 18px;
                font-size: 0.85rem;
            }

            .apply-it-header {
                font-size: 1.3rem;
                margin-bottom: 1.5rem;
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .apply-it-scenario {
                padding: 1.8rem;
                margin: 1rem 0;
                font-size: 1rem;
                line-height: 1.6;
            }

            .apply-it-question {
                padding: 1.8rem;
                margin: 1rem 0;
                font-size: 1.05rem;
                line-height: 1.6;
            }

            .apply-it-question p {
                font-size: 1.1rem;
                font-weight: 700;
            }

            .apply-it-options {
                grid-template-columns: 1fr;
                gap: 1.2rem;
            }

            .apply-it-option {
                padding: 1.5rem 1.8rem;
                font-size: 1rem;
                border-radius: 18px;
                line-height: 1.5;
                font-weight: 600;
            }

            .apply-it-feedback {
                padding: 2rem 1.8rem;
                margin-top: 1.5rem;
                font-size: 1rem;
                border-radius: 18px;
            }

            .apply-it-feedback p {
                font-size: 1rem;
                line-height: 1.5;
            }

            .apply-it-feedback strong {
                font-size: 1.05rem;
            }

            .apply-it-fill-blank {
                min-width: 140px;
                padding: 1rem 1.2rem;
                margin: 0.5rem;
                font-size: 1rem;
                display: block;
                width: 100%;
                box-sizing: border-box;
                box-sizing: border-box;
            }

            /* Info Boxes Mobile */
            .highlight-box, .info-box, .warning-box {
                padding: 1.5rem;
                margin: 1.5rem 0;
                font-size: 0.95rem;
            }
        }

        /* Enhanced Mobile Responsiveness for Buttons and Interactive Elements */
        @media (max-width: 768px) {
            .nav-button {
                padding: 12px 20px;
                font-size: 0.9rem;
                min-width: 100px;
                margin: 5px;
            }

            .nav-button:hover {
                transform: translateY(-2px) scale(1.02);
            }

            .apply-it-option {
                padding: 1.2rem 1.5rem;
                font-size: 1rem;
                margin: 0.8rem 0;
                border-radius: 18px;
            }

            .apply-it-option:hover {
                transform: translateY(-2px) scale(1.01);
            }

            .apply-it-feedback {
                padding: 2rem 1.5rem;
                margin-top: 1.5rem;
                border-radius: 15px;
            }

            .quiz-button {
                padding: 1rem 2rem;
                font-size: 1rem;
                min-width: 140px;
                margin: 0.5rem;
            }

            .quiz-button:hover {
                transform: translateY(-3px) scale(1.03);
            }

            .status-badge {
                padding: 8px 16px;
                font-size: 0.8rem;
            }

            .status-badge:hover {
                transform: translateY(-1px) scale(1.02);
            }

            .notification {
                max-width: calc(100vw - 40px) !important;
                min-width: 260px !important;
                right: 10px !important;
                top: 10px !important;
                padding: 12px 16px !important;
                font-size: 0.9rem !important;
            }

            .scroll-to-top {
                width: 50px;
                height: 50px;
                bottom: 20px;
                right: 20px;
                font-size: 1.2rem;
            }

            .scroll-to-top:hover {
                transform: translateY(-3px) scale(1.05);
            }
        }

        /* Touch-friendly enhancements for mobile */
        @media (max-width: 768px) and (hover: none) {
            .apply-it-option,
            .nav-button,
            .quiz-button,
            .status-badge,
            .module-card {
                transition: all 0.2s ease;
            }

            .apply-it-option:active {
                transform: scale(0.98);
                background: linear-gradient(145deg, 
                    rgba(52, 152, 219, 0.2) 0%, 
                    rgba(255, 255, 255, 0.95) 100%);
            }

            .nav-button:active,
            .quiz-button:active {
                transform: scale(0.96);
            }

            .module-card:active {
                transform: scale(0.98);
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.25rem;
            }

            .header {
                padding: 1.5rem 0.75rem;
            }

            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1rem;
            }

            .modules-grid {
                padding: 0.5rem;
                gap: 1rem;
            }
            
            .module-content {
                padding: 1.5rem 0.75rem;
                margin: 0.5rem 0;
            }

            .content-section {
                padding: 1rem;
            }

            .content-section h3 {
                font-size: 1.4rem;
            }
            
            .content-section h4 {
                font-size: 1.2rem;
            }

            .content-section p, .content-section li {
                font-size: 0.95rem;
                line-height: 1.6;
            }

            /* Apply It Small Mobile */
            .apply-it-section {
                padding: 1.5rem 1rem;
                margin: 1.5rem 0;
            }

            .apply-it-section::before {
                top: -10px;
                left: 10px;
                padding: 6px 12px;
                font-size: 0.75rem;
            }

            .apply-it-header {
                font-size: 1.1rem;
                margin-bottom: 1rem;
            }

            .apply-it-scenario {
                padding: 1.2rem;
                font-size: 0.9rem;
            }

            .apply-it-question {
                padding: 1.2rem;
                font-size: 0.95rem;
            }

            .apply-it-option {
                padding: 0.8rem 1.2rem;
                font-size: 0.9rem;
            }

            .apply-it-feedback {
                padding: 1.2rem;
                font-size: 0.9rem;
            }

            .apply-it-fill-blank {
                padding: 0.7rem 0.8rem;
                font-size: 0.9rem;
                margin: 0.3rem;
            }

            /* Info Boxes Small Mobile */
            .highlight-box, .info-box, .warning-box {
                padding: 1.2rem;
                margin: 1rem 0;
                font-size: 0.9rem;
            }

            /* Navigation Small Mobile */
            .nav-btn {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }

            /* Footer Small Mobile */
            .footer {
                padding: 1.5rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Large Mobile/Small Tablet Optimizations */
        @media (min-width: 481px) and (max-width: 768px) {
            .apply-it-options {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        }

        /* Touch-specific optimizations */
        @media (pointer: coarse) {
            .apply-it-option,
            .option,
            .quiz-button,
            .nav-btn {
                min-height: 44px; /* iOS accessibility guidelines */
                touch-action: manipulation; /* Prevent zoom on tap */
            }

            .apply-it-fill-blank,
            .text-input {
                min-height: 44px;
                font-size: 16px; /* Prevent zoom on iOS */
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .navigation, .footer, .scroll-to-top, .reading-progress {
                display: none;
            }
            
            .module-content {
                display: block !important;
                box-shadow: none;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }
            
            .modules-grid {
                display: none;
            }
        }
        
        /* Enhanced Interactive Quiz Styles */
        .quiz-section {
            margin-top: 3rem;
            padding: 2.5rem;
            background: linear-gradient(145deg, rgba(44, 62, 80, 0.95), rgba(52, 73, 94, 0.9));
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .quiz-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #9b59b6, #e74c3c, #f39c12, #2ecc71);
            background-size: 300% 100%;
            animation: gradientShift 8s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 0%; }
            50% { background-position: 100% 0%; }
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .quiz-header h4 {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #3498db, #9b59b6, #e74c3c);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 6s ease-in-out infinite;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .quiz-header p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1.5rem;
        }

        .quiz-progress {
            margin: 2rem 0;
            text-align: center;
            position: relative;
        }

        .quiz-progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 0.8rem;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .quiz-progress-bar::before {
            content: '';
            display: block;
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #3498db, #2ecc71, #f39c12);
            border-radius: 20px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.4);
        }

        .quiz-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .quiz-progress-text {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* Quiz Container Enhancements */
        .quiz-container {
            position: relative;
            min-height: 400px;
        }

        .quiz-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            min-height: 400px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .quiz-loading.show {
            opacity: 1;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Enhanced Question Transitions */
        .quiz-question {
            animation: questionSlideIn 0.6s ease-out;
        }

        @keyframes questionSlideIn {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Completion Celebration */
        .quiz-complete-celebration {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #3498db;
            animation: confetti-fall 3s linear infinite;
        }

        .confetti:nth-child(2n) { background: #2ecc71; animation-delay: 0.5s; }
        .confetti:nth-child(3n) { background: #e74c3c; animation-delay: 1s; }
        .confetti:nth-child(4n) { background: #f39c12; animation-delay: 1.5s; }
        .confetti:nth-child(5n) { background: #9b59b6; animation-delay: 2s; }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .quiz-question {
            background: linear-gradient(145deg, rgba(52, 73, 94, 0.8), rgba(44, 62, 80, 0.9));
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(8px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        .quiz-question::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: linear-gradient(145deg, transparent, rgba(255, 255, 255, 0.05));
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .quiz-question:hover::before {
            opacity: 1;
        }

        .quiz-question:hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: rgba(52, 152, 219, 0.3);
        }

        .quiz-question.answered {
            border-color: rgba(52, 152, 219, 0.4);
            background: linear-gradient(145deg, rgba(52, 152, 219, 0.08), rgba(52, 152, 219, 0.03));
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.2);
        }

        .quiz-question.correct {
            border-color: rgba(46, 204, 113, 0.6);
            background: linear-gradient(145deg, rgba(46, 204, 113, 0.12), rgba(46, 204, 113, 0.05));
            box-shadow: 0 0 25px rgba(46, 204, 113, 0.3);
            animation: correctPulse 0.6s ease-out;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .quiz-question.incorrect {
            border-color: rgba(231, 76, 60, 0.6);
            background: linear-gradient(145deg, rgba(231, 76, 60, 0.12), rgba(231, 76, 60, 0.05));
            box-shadow: 0 0 25px rgba(231, 76, 60, 0.3);
            animation: incorrectShake 0.6s ease-out;
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-4px); }
            75% { transform: translateX(4px); }
        }

        .question-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .question-number {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            margin-right: 1.5rem;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .quiz-question.correct .question-number {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
            animation: bounce 0.6s ease-out;
        }

        .quiz-question.incorrect .question-number {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        .question-chapter {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.4), rgba(155, 89, 182, 0.2));
            color: #ffffff;
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-left: auto;
            border: 1px solid rgba(155, 89, 182, 0.4);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(155, 89, 182, 0.3);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
        }

        .question-text {
            font-size: 1.2rem;
            line-height: 1.7;
            margin-bottom: 2rem;
            color: #ffffff;
            font-weight: 500;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .question-options.multiple-choice {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .option {
            background: linear-gradient(145deg, rgba(44, 62, 80, 0.7), rgba(52, 73, 94, 0.6));
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 1.5rem 2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(52, 152, 219, 0.15), transparent);
            transition: left 0.6s ease;
        }

        .option:hover::before {
            left: 100%;
        }

        .option::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 1.5rem;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
            transform: translateY(-50%);
        }

        .option:hover {
            border-color: rgba(52, 152, 219, 0.6);
            background: linear-gradient(145deg, rgba(52, 152, 219, 0.15), rgba(52, 152, 219, 0.08));
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(52, 152, 219, 0.15);
        }

        .option:hover::after {
            width: 8px;
            height: 8px;
        }

        .option.selected {
            border-color: #3498db;
            background: linear-gradient(145deg, rgba(52, 152, 219, 0.2), rgba(52, 152, 219, 0.1));
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.25);
        }

        .option.selected::after {
            width: 12px;
            height: 12px;
            background: #3498db;
        }

        .option.correct {
            border-color: #2ecc71;
            background: linear-gradient(145deg, rgba(46, 204, 113, 0.25), rgba(46, 204, 113, 0.1));
            color: #2ecc71;
            animation: correctOption 0.6s ease-out;
        }

        .option.correct::after {
            width: 16px;
            height: 16px;
            background: #2ecc71;
            animation: checkmark 0.6s ease-out;
        }

        @keyframes correctOption {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1.02); }
        }

        @keyframes checkmark {
            0% { transform: translateY(-50%) scale(0) rotate(0deg); }
            50% { transform: translateY(-50%) scale(1.2) rotate(180deg); }
            100% { transform: translateY(-50%) scale(1) rotate(360deg); }
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: linear-gradient(145deg, rgba(231, 76, 60, 0.25), rgba(231, 76, 60, 0.1));
            color: #e74c3c;
            animation: incorrectOption 0.6s ease-out;
        }

        .option.incorrect::after {
            width: 16px;
            height: 16px;
            background: #e74c3c;
            animation: crossmark 0.6s ease-out;
        }

        @keyframes incorrectOption {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }

        @keyframes crossmark {
            0% { transform: translateY(-50%) scale(0) rotate(0deg); }
            50% { transform: translateY(-50%) scale(1.2) rotate(180deg); }
            100% { transform: translateY(-50%) scale(1) rotate(360deg); }
        }

        .option-label {
            font-weight: 700;
            margin-right: 1rem;
            color: #ffffff;
            min-width: 30px;
            font-size: 1.1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            background: rgba(52, 152, 219, 0.8);
            padding: 0.3rem 0.6rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .option.correct .option-label {
            color: #2ecc71;
        }

        .option.incorrect .option-label {
            color: #e74c3c;
        }

        .option-text {
            flex: 1;
            font-weight: 600;
            font-size: 1.1rem;
            line-height: 1.5;
            color: #2c3e50;
            text-shadow: none;
        }

        .text-input {
            width: 100%;
            padding: 1.5rem;
            background: linear-gradient(145deg, rgba(44, 62, 80, 0.8), rgba(52, 73, 94, 0.7));
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            color: white;
            font-size: 1.1rem;
            transition: all 0.4s ease;
            backdrop-filter: blur(5px);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .text-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }

        .text-input:focus {
            outline: none;
            border-color: #3498db;
            background: linear-gradient(145deg, rgba(52, 152, 219, 0.15), rgba(52, 152, 219, 0.08));
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.3), inset 0 2px 4px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .text-input.correct {
            border-color: #2ecc71;
            background: linear-gradient(145deg, rgba(46, 204, 113, 0.15), rgba(46, 204, 113, 0.08));
            box-shadow: 0 0 20px rgba(46, 204, 113, 0.3);
        }

        .text-input.incorrect {
            border-color: #e74c3c;
            background: linear-gradient(145deg, rgba(231, 76, 60, 0.15), rgba(231, 76, 60, 0.08));
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.3);
            animation: inputShake 0.5s ease-out;
        }

        @keyframes inputShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .feedback {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 15px;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-15px) scale(0.95);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .feedback::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.8s ease;
        }

        .feedback.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .feedback.show::before {
            left: 100%;
        }

        .feedback.correct {
            background: linear-gradient(145deg, rgba(46, 204, 113, 0.15), rgba(46, 204, 113, 0.08));
            border: 2px solid rgba(46, 204, 113, 0.4);
            color: #2ecc71;
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.2);
        }

        .feedback.correct::after {
            content: '✅';
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 1.2rem;
            animation: successBounce 0.6s ease-out;
        }

        @keyframes successBounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) rotate(0deg); }
            40% { transform: translateY(-8px) rotate(15deg); }
            60% { transform: translateY(-4px) rotate(-10deg); }
        }

        .feedback.incorrect {
            background: linear-gradient(145deg, rgba(231, 76, 60, 0.15), rgba(231, 76, 60, 0.08));
            border: 2px solid rgba(231, 76, 60, 0.4);
            color: #e74c3c;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.2);
        }

        .feedback.incorrect::after {
            content: '❌';
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 1.2rem;
            animation: errorShake 0.6s ease-out;
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-3px) rotate(-5deg); }
            75% { transform: translateX(3px) rotate(5deg); }
        }

        .quiz-results {
            text-align: center;
            padding: 3rem;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 25px;
            margin-top: 3rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .quiz-results::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(52, 152, 219, 0.1) 0%, transparent 70%);
            animation: celebrate 4s ease-in-out infinite;
        }

        @keyframes celebrate {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        .results-header h4 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #3498db, #2ecc71, #f39c12);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 3s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        .score-display {
            font-size: 3rem;
            font-weight: 900;
            margin: 2rem 0;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .score-excellent {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: excellence 2s ease-in-out infinite;
        }

        .score-good {
            background: linear-gradient(135deg, #3498db, #2980b9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-needs-improvement {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes excellence {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .results-breakdown {
            margin: 2rem 0;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
        }

        .quiz-actions {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin-top: 2rem;
            position: relative;
            z-index: 1;
        }

        .quiz-button {
            padding: 1.2rem 2.5rem;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform-style: preserve-3d;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 160px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .quiz-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent
            );
            transition: left 0.8s ease;
            z-index: 2;
        }

        .quiz-button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, 
                rgba(255, 255, 255, 0.3) 0%, 
                rgba(255, 255, 255, 0.1) 50%,
                transparent 70%);
            border-radius: 50%;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translate(-50%, -50%);
            z-index: 1;
        }

        .quiz-button:hover::before {
            left: 100%;
        }

        .quiz-button:hover::after {
            width: 400px;
            height: 400px;
        }

        .quiz-button:hover {
            transform: translateY(-5px) scale(1.05) rotateX(5deg);
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.25),
                0 5px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .quiz-button:active {
            transform: translateY(-2px) scale(1.02);
            transition: all 0.1s ease;
        }

        .quiz-button.primary {
            background: linear-gradient(135deg, 
                #2ecc71 0%, 
                #27ae60 25%, 
                #16a085 50%,
                #1e8449 100%);
            color: white;
            box-shadow: 
                0 10px 30px rgba(46, 204, 113, 0.4),
                0 4px 15px rgba(46, 204, 113, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .quiz-button.primary::before {
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5), 
                transparent);
        }

        .quiz-button.primary:hover {
            transform: translateY(-6px) scale(1.08) rotateX(5deg);
            box-shadow: 
                0 25px 60px rgba(46, 204, 113, 0.5),
                0 10px 25px rgba(46, 204, 113, 0.3),
                0 0 40px rgba(46, 204, 113, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.4),
                inset 0 -2px 0 rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, 
                #27ae60 0%, 
                #2ecc71 25%, 
                #1e8449 50%,
                #16a085 100%);
            animation: primaryGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes primaryGlow {
            0% { 
                filter: brightness(1) hue-rotate(0deg);
            }
            100% { 
                filter: brightness(1.1) hue-rotate(5deg);
            }
        }

        .quiz-button.secondary {
            background: linear-gradient(135deg, 
                #3498db 0%, 
                #2980b9 25%, 
                #2471a3 50%,
                #1f4e79 100%);
            color: white;
            box-shadow: 
                0 10px 30px rgba(52, 152, 219, 0.4),
                0 4px 15px rgba(52, 152, 219, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .quiz-button.secondary::before {
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5), 
                transparent);
        }

        .quiz-button.secondary:hover {
            transform: translateY(-6px) scale(1.08) rotateX(5deg);
            box-shadow: 
                0 25px 60px rgba(52, 152, 219, 0.5),
                0 10px 25px rgba(52, 152, 219, 0.3),
                0 0 40px rgba(52, 152, 219, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.4),
                inset 0 -2px 0 rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, 
                #2980b9 0%, 
                #3498db 25%, 
                #1f4e79 50%,
                #2471a3 100%);
            animation: secondaryGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes secondaryGlow {
            0% { 
                filter: brightness(1) hue-rotate(0deg);
            }
            100% { 
                filter: brightness(1.1) hue-rotate(-5deg);
            }
        }

        .results-header h4 {
            font-size: 2rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #f39c12, #e67e22);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            margin: 1rem 0;
            padding: 2rem;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            border-radius: 20px;
            color: white;
            display: inline-block;
            min-width: 200px;
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.3);
        }

        .score-display.excellent {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .score-display.good {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .score-display.fair {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .score-display.poor {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .result-stat {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-stat h5 {
            margin-bottom: 0.5rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-stat .value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }

        .quiz-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .quiz-button {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quiz-button.primary {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.3);
        }

        .quiz-button.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .quiz-button:hover {
            transform: translateY(-3px);
        }

        .quiz-button.primary:hover {
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }

        /* Enhanced Mobile Responsiveness for Quiz */
        @media (max-width: 768px) {
            .quiz-section {
                padding: 2rem 1.5rem;
                margin-top: 2rem;
            }

            .quiz-header h4 {
                font-size: 1.8rem;
            }

            .quiz-question {
                padding: 2rem 1.5rem;
                margin-bottom: 1.5rem;
            }

            .question-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .question-number {
                width: 40px;
                height: 40px;
                margin-right: 0;
            }

            .question-chapter {
                align-self: flex-end;
                margin-left: 0;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .question-options.multiple-choice {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .option {
                padding: 1.2rem 1.5rem;
            }

            .option-label {
                min-width: 25px;
                font-size: 1rem;
            }

            .quiz-actions {
                flex-direction: column;
                gap: 1rem;
            }

            .quiz-button {
                width: 100%;
                padding: 1.2rem 2rem;
            }

            .score-display {
                font-size: 2.5rem;
            }

            .results-header h4 {
                font-size: 2rem;
            }

            .quiz-results {
                padding: 2rem 1.5rem;
            }

            .feedback {
                padding: 1.2rem;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            .quiz-section {
                padding: 1.5rem 1rem;
                border-radius: 20px;
            }

            .quiz-header h4 {
                font-size: 1.5rem;
            }

            .quiz-question {
                padding: 1.5rem 1rem;
                border-radius: 15px;
            }

            .question-number {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }

            .question-text {
                font-size: 1rem;
            }

            .option {
                padding: 1rem;
                border-radius: 12px;
            }

            .text-input {
                padding: 1.2rem;
                font-size: 1rem;
            }

            .score-display {
                font-size: 2rem;
            }

            .results-header h4 {
                font-size: 1.8rem;
            }

            .quiz-button {
                font-size: 1rem;
                padding: 1rem 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Texas Transportation Code</h1>
            <p>Complete Study Guide for Law Enforcement</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
                <div class="progress-text" id="progressText">Progress: 0 of 7 modules completed</div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <div class="nav-buttons">
                <button class="nav-btn" onclick="showModule(0)">Overview</button>
                <button class="nav-btn" onclick="showModule(1)">Module 1</button>
                <button class="nav-btn" onclick="showModule(2)">Module 2</button>
                <button class="nav-btn" onclick="showModule(3)">Module 3</button>
                <button class="nav-btn" onclick="showModule(4)">Module 4</button>
                <button class="nav-btn" onclick="showModule(5)">Module 5</button>
                <button class="nav-btn" onclick="showModule(6)">Module 6</button>
                <button class="nav-btn" onclick="showModule(7)">Module 7</button>
            </div>
        </div>

        <!-- Modules Overview Grid -->
        <div class="modules-grid" id="modulesGrid">
            <div class="module-card" onclick="showModule(1)">
                <div class="module-header">
                    <div class="module-number">1</div>
                    <div class="module-title">Module 1</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(2)">
                <div class="module-header">
                    <div class="module-number">2</div>
                    <div class="module-title">Module 2</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(3)">
                <div class="module-header">
                    <div class="module-number">3</div>
                    <div class="module-title">Module 3</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(4)">
                <div class="module-header">
                    <div class="module-number">4</div>
                    <div class="module-title">Module 4</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(5)">
                <div class="module-header">
                    <div class="module-number">5</div>
                    <div class="module-title">Module 5</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(6)">
                <div class="module-header">
                    <div class="module-number">6</div>
                    <div class="module-title">Module 6</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>

            <div class="module-card" onclick="showModule(7)">
                <div class="module-header">
                    <div class="module-number">7</div>
                    <div class="module-title">Module 7</div>
                </div>
                <div class="module-description">
                    Content will be added here. Click to expand when ready.
                </div>
                <div class="module-status">
                    <div class="status-badge not-started">Not Started</div>
                </div>
            </div>
        </div>

        <!-- Reading Progress Bar -->
        <div class="reading-progress" id="readingProgress"></div>

        <!-- Scroll to Top Button -->
        <button class="scroll-to-top" id="scrollToTop" onclick="scrollToTop()">↑</button>

        <!-- Module Content Sections -->
        <div class="module-content" id="module1">
            <!-- Module 1 Top Navigation -->
            <div class="module-navigation">
                <button class="nav-button overview" onclick="showModule(0)">
                    🏠 Overview
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 1</div>
                    <div class="progress-text">Texas Penal Code & Registration</div>
                </div>
                <button class="nav-button next" onclick="showModule(2)">
                    Next: Module 2 →
                </button>
            </div>

            <div class="content-section">
                <h3>MODULE 1 – TEXAS PENAL CODE – TRC CHAPTER 504</h3>
                
                <h4>SECTION 1.1 - TEXAS PENAL CODE</h4>
                <div class="info-box">
                    <strong>BPOC Objective 22.2</strong> - Define the following terms in the TC.
                </div>
                
                <h4>PC 1.07 – Definitions</h4>
                
                <p><strong>(8) Bodily Injury</strong> – physical pain, illness, or any impairment of physical condition.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This definition is used to enhance offenses in the TRC.<br><br>
                    <strong>Example:</strong> TRC 545.157 – If a vehicle fails to slow down or move over for a stationary emergency vehicle, the offense is a Class C Misdemeanor (fine only offense), however if the offense results in bodily injury, it becomes a Class B Misdemeanor (a higher fine and jail time).
                </div>
                
                <p><strong>(46) Serious Bodily Injury</strong> – bodily injury that creates a substantial risk of death or that causes death, serious permanent disfigurement, or protracted loss or impairment of the function of any bodily member or organ.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This definition is used to enhance offenses throughout the TRC.<br><br>
                    <strong>Example:</strong> TRC 550.021 – Failed to Stop and Render Aid following a crash is a Second Degree Felony if someone suffers serious bodily injury as a result of the crash. Otherwise, the penalties are less severe.
                </div>
                
                <p><strong>(26) Individual</strong> – means a human being who is alive, including an unborn child at every stage of gestation from fertilization until birth.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> The inclusion of an unborn child in this definition allows for criminal charges related to the death of an "individual" when an unborn baby is killed in a criminal event such as Murder, Intoxication Manslaughter, Manslaughter, Criminally Negligent Homicide, etc.<br><br>
                    <strong>Example:</strong> Jim is intoxicated when he runs a stop sign and T-bones another vehicle. A pregnant woman is driving the other vehicle. She survives, however the crash causes the death of her unborn baby. Jim can be prosecuted for Intoxication Manslaughter because the unborn child meets the definition of an "individual" and Jim's intoxication caused the death of that individual.
                </div>
                
                <p><strong>(40) Public Place</strong> – any place to which the public or a substantial group of the public has access and includes, but is not limited to, streets, highways, and the common areas of schools, hospitals, apartment houses, office buildings, transport facilities, and shops.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> Several frequently used offenses must occur in a "public place" before enforcement action can be taken – Driving While Intoxicated, DUI – Minor, Reckless Driving. Additionally, motor vehicle crashes are considered reportable crashes when they occur in a "public place" such as a parking lot.
                </div>
                
                <p><strong>(49) Death</strong> – includes, for an individual who is an unborn child, the failure to be born alive.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This definition allows for a person to be held accountable via conventional charges (Murder, Manslaughter, etc.) when their actions cause an unborn child to not be born alive.
                </div>
                
                <div class="info-box">
                    <strong>BPOC Objective 22.30</strong> - Illustrate a working knowledge of the laws, methods, and techniques relative to crash investigation to include when and where the TC applies in crash investigation.
                </div>
                
                <h4>PC 19.04 – Manslaughter</h4>
                <p>This offense is frequently used in fatal crash investigation. The actions of the person who caused the death must meet the culpable mental state of "recklessly" as defined in PC 6.03.</p>
                
                <p><strong>Recklessly</strong> - when a person is aware of but consciously disregards a substantial and unjustifiable risk that the circumstances exist or the result will occur. The risk must be of such a nature and degree that its disregard constitutes a gross deviation from the standard of care that an ordinary person would exercise under all the circumstances as viewed from the actor's standpoint.</p>
                
                <div class="apply-it-section" id="apply-it-1">
                    <div class="apply-it-header">
                        <span>🚗</span> Apply It: Manslaughter Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> Jim is traveling 60 MPH in a 60 MPH zone, but the roadway is wet and he encounters a low spot holding water. His vehicle hydroplanes, leaves the roadway, and rolls over several times. Jim's passenger is killed in the crash.
                    </div>
                    <div class="apply-it-question">
                        Has Jim committed the offense of Manslaughter?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(1, 'yes', false, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(1, 'no', true, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-1">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"No"</strong>. Although Jim's actions caused a crash that killed his passenger, they were not a "gross deviation" from ordinary standards of care and Jim was not aware that his driving behavior posed a substantial and unjustifiable risk.<br><br>
                        <em><strong>Key Point:</strong> Manslaughter requires "reckless" behavior - being aware of but consciously disregarding a substantial risk.</em>
                    </div>
                </div>
                
                <h4>PC 19.05 – Criminally Negligent Homicide</h4>
                <p>This offense is frequently used in fatal crash investigation. The actions of the person who caused the crash/death must meet the culpable mental state of "criminal negligence" as defined in PC 6.03.</p>
                
                <p><strong>Criminal Negligence</strong> - when a person ought to be aware of a substantial and unjustifiable risk that the circumstances exist or the result will occur. The risk must be of such a nature and degree that the failure to perceive it constitutes a gross deviation from the standard of care that an ordinary person would exercise under all the circumstances as viewed from the actor's standpoint.</p>
                
                <p><strong>Case Law</strong> – Queeman v. State, Texas Court of Criminal Appeals – good guidance regarding building a Criminally Negligent Homicide case based on Class C traffic violations.</p>
                
                <div class="apply-it-section" id="apply-it-2">
                    <div class="apply-it-header">
                        <span>⚖️</span> Apply It: Criminally Negligent Homicide Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> Jim is traveling 70 MPH in a 60 MPH zone. Jim is running late for an appointment and he is texting his client to reschedule at the time of the crash. It is raining and Jim's tires are extremely worn. The tread depth measures 1/32" after the crash. Jim encounters a low spot holding water. His vehicle hydroplanes, leaves the roadway, and rolls over several times. Jim's passenger is killed in the crash.
                    </div>
                    <div class="apply-it-question">
                        Has Jim committed the offense of Criminally Negligent Homicide?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(2, 'yes', true, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(2, 'no', false, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-2">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"Yes"</strong>. These circumstances would likely rise to the level of "criminal negligence". Jim is speeding while texting and driving in the rain on tires with extremely poor tread. Jim should have known that the combination of these elements posed a substantial and unjustifiable risk to his passenger.<br><br>
                        <em><strong>Key Point:</strong> Criminal negligence requires that a person "ought to be aware" of the substantial risk.</em>
                    </div>
                </div>
                
                <div class="info-box">
                    <strong>Manslaughter vs. Criminally Negligent Homicide</strong><br>
                    The difference is the culpable mental state.<br><br>
                    <strong>Manslaughter (Recklessly)</strong> – aware of the substantial and unjustifiable risk but consciously disregards the risk.<br><br>
                    <strong>CNH (with Criminal Negligence)</strong> – ought to be aware of the substantial and unjustifiable risk.<br><br>
                    <strong>Word Association:</strong><br>
                    • Manslaughter → Reckless → Death → 2nd Degree Felony<br>
                    • Criminally Negligent Homicide → With Criminal Negligence → Death → State Jail Felony
                </div>
                
                <h4>PC 49.07 – Intoxication Assault</h4>
                <p>Before filing this charge, ensure that the following elements are met:</p>
                <ol>
                    <li>The person was operating a motor vehicle in a public place or the person was operating an aircraft, watercraft, or amusement ride (or assembling an amusement ride);</li>
                    <li>The person was intoxicated;</li>
                    <li>The intoxication resulted in Serious Bodily Injury as defined in this section.</li>
                </ol>
                <p>This offense is a 3rd degree felony.</p>
                <p><strong>Word Association:</strong> Intoxication Assault → Serious Bodily Injury Caused by Intoxication → 3rd Degree Felony</p>
                
                <h4>PC 49.08 – Intoxication Manslaughter</h4>
                <p>Before filing this charge, ensure that the following elements are met:</p>
                <ol>
                    <li>The person was operating a motor vehicle in a public place or the person was operating an aircraft, watercraft, or amusement ride (or assembling an amusement ride);</li>
                    <li>The person was intoxicated;</li>
                    <li>The intoxication resulted in death of another person.</li>
                </ol>
                <p>This offense is a 2nd degree felony.</p>
                <p><strong>Word Association:</strong> Intoxication Manslaughter → Death Caused by Intoxication → 2nd Degree Felony</p>
                
                <h4>SECTION 1.2 – CHAPTER 472 - MISCELLANEOUS PROVISIONS</h4>
                <div class="info-box">
                    <strong>BPOC Objective 22.27</strong> - Given a situation involving warning signs and devices, determine if a violation of law exists.
                </div>
                
                <h4>472.021 – Tampering with Warning Devices</h4>
                <p>It is an offense to tamper with, damage, or remove a barricade, flare pot, sign, flasher signal, or other device warning of construction, repair, or detour on or adjacent to a highway.</p>
                
                <p><strong>Enforcement Notes:</strong></p>
                <ol>
                    <li>The device must warn of construction, repair, or detour; and</li>
                    <li>The device must have been placed by the state, a political subdivision, a contractor, or a public utility.</li>
                </ol>
                
                <p><strong>DPS Arrest Title:</strong> Tampering with Warning Device</p>
                <p>This offense is punishable by a fine between $25 and $1,000 and up to 2 years in county jail.</p>
                
                <h4>472.022 – Obeying Warning Signs and Barricades</h4>
                <p>It is an offense to disregard a warning sign or drive around a barricade.</p>
                
                <p>"Warning Sign" and "Barricade" are defined in (e)(1) and (e)(3) and these definitions must be understood for correct enforcement. Even a person (flagger) can be considered a warning sign.</p>
                
                <p><strong>"Barricade"</strong> means an obstruction: (A) placed on or across a road, street, or highway of this state by the department, a political subdivision of this state, or a contractor or subcontractor constructing or repairing the road, street, or highway under authorization of the department or a political subdivision of this state; and (B) placed to prevent the passage of motor vehicles over the road, street, or highway during construction, repair, or dangerous conditions.</p>
                
                <p><strong>"Warning sign"</strong> means a signal, marking, or device placed on a barricade or on a road, street, or highway during construction, repair, or dangerous conditions by the department, a political subdivision of this state, or a contractor or subcontractor to warn or regulate motor vehicular traffic. The term includes a flagger deployed on a road, street, or highway by the department, a political subdivision of this state, or a contractor or subcontractor to direct traffic around or on the road, street, or highway during construction, repair, or dangerous conditions.</p>
                
                <p>The fine for this offense can be doubled (to $400) if committed in a construction zone while workers are present.</p>
                
                <p>The offense is enhanced to a Class B Misdemeanor if the barricade has been placed due to water over the roadway.</p>
                
                <p><strong>DPS Arrest titles:</strong></p>
                <ul>
                    <li>Disregard Warning Signs/Barricades – Class C Misd.</li>
                    <li>Disregard Warning Signs/Barricade-Construction Zone W/Workers – Class C Misd. (double fine)</li>
                    <li>Disregard Warning Signs/Barricades Water Over Road – Class B Misd.</li>
                </ul>
                
                <p>(f) Deferred adjudication and defensive driving do not apply to an offense under this section.</p>
                
                <div class="apply-it-section" id="apply-it-3">
                    <div class="apply-it-header">
                        <span>🚧</span> Apply It: Construction Zone Speed Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You observe a construction zone with a sign indicating "SPEED LIMIT 40 MPH WHEN WORKERS PRESENT." A vehicle is traveling at 50 MPH through this zone.
                    </div>
                    <div class="apply-it-question">
                        Can a person be cited for Disregard Warning Sign if they travel more than 40 MPH in this construction zone?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(3, 'yes', true, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(3, 'no', false, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-question">
                        If workers are not present, what is the maximum fine? 
                        <input type="text" class="apply-it-fill-blank" id="fine-no-workers" placeholder="$___" onblur="checkFillBlank(this, '$200', 3, 'a')">
                    </div>
                    <div class="apply-it-question">
                        If workers are present, what is the maximum fine? 
                        <input type="text" class="apply-it-fill-blank" id="fine-with-workers" placeholder="$___" onblur="checkFillBlank(this, '$400', 3, 'b')">
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-3">
                        <strong>✅ Correct!</strong><br>
                        <strong>Yes</strong> - This sign is a warning sign as defined in 472.022(e)(3) and described in the Texas Manual on Uniform Traffic Control Devices (sign CW13-1P). Traveling above 40 MPH constitutes disregarding the warning sign.<br><br>
                        <strong>Maximum Fines:</strong><br>
                        • Without workers present: <strong>$200</strong><br>
                        • With workers present: <strong>$400</strong> (doubled fine)<br><br>
                        <em><strong>Important Note:</strong> A motorist who fails to travel the speed notated on this sign has not committed "Speeding Over Limit" because this is not a regulatory speed limit sign.</em>
                    </div>
                </div>
                
                <div class="apply-it-section" id="apply-it-enhanced">
                    <div class="apply-it-header">
                        <span>💡</span> Apply It: Registration Scenario (Interactive)
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> On June 1, 2025, an officer stops a vehicle with Texas license plates. The registration shows an expiration date of May 31, 2025. The driver says they just bought the vehicle yesterday and haven't had time to renew the registration yet.
                    </div>
                    <div class="apply-it-question">
                        Complete the analysis: The registration expired <input type="text" class="apply-it-fill-blank" placeholder="# days ago" onblur="checkFillBlank(this, '1 day', 'enhanced', 'days')" onkeypress="if(event.key==='Enter') checkFillBlank(this, '1 day', 'enhanced', 'days')"> ago. The grace period is <input type="text" class="apply-it-fill-blank" placeholder="# working days" onblur="checkFillBlank(this, '5 working days', 'enhanced', 'grace')" onkeypress="if(event.key==='Enter') checkFillBlank(this, '5 working days', 'enhanced', 'grace')">. Can the driver be cited? <input type="text" class="apply-it-fill-blank" placeholder="Yes/No" onblur="checkFillBlank(this, 'No', 'enhanced', 'cite')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'No', 'enhanced', 'cite')">
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-enhanced">
                        <strong>✅ Analysis Complete!</strong><br>
                        The registration expired <strong>1 day</strong> ago (June 1 - May 31 = 1 day). The grace period is <strong>5 working days</strong> per Section 502.407. Since only 1 day has passed and it's within the 5 working day grace period, the driver <strong>cannot be cited</strong> for expired registration.<br><br>
                        <em><strong>Key Learning:</strong> Always count working days (Mon-Fri) for the grace period, not calendar days.</em>
                    </div>
                </div>

                <div class="apply-it-section" id="apply-it-4">
                    <div class="apply-it-header">
                        <span>🚦</span> Apply It: Flagger Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> A construction worker with a "STOP/SLOW" paddle is directing traffic in a construction zone. A motorist fails to stop when the flagger displays the "STOP" side of the paddle.
                    </div>
                    <div class="apply-it-question">
                        Can a motorist be cited for Disregard Warning Sign if they fail to stop for this flagger?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(4, 'yes', true, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(4, 'no', false, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-4">
                        <strong>✅ Correct!</strong><br>
                        <strong>Yes</strong> - The motorist has committed the offense of Disregard Warning Sign because a flagger meets the definition of a warning sign in 472.022.<br><br>
                        <em><strong>Important:</strong> Do NOT use "Disregard Stop Sign" if a motorist fails to stop for the flagger. This sign is described as a "Stop/Slow Paddle" in the Texas Manual on Uniform Traffic Control Devices and carries a different requirement (stop and remain standing until the flagger permits traffic to proceed).</em>
                    </div>
                </div>

                <h4>SECTION 1.3 – CHAPTER 502 - REGISTRATION OF VEHICLES</h4>
                <div class="info-box">
                    <strong>BPOC Objective 22.25</strong> - Discuss the requirement for registration of vehicles.
                </div>

                <h4>502.001 – Definitions (emphasize the underlined words for study)</h4>
                <p><strong>(7) Commercial Motor Vehicle</strong> – This term is defined numerous times through the TRC, however for registration purposes in Chapter 502, a motor vehicle designed or used primarily to transport property.</p>
                <p><strong>(11) Department</strong> – for the registration chapter, "department" means the Texas Department of Motor Vehicles.</p>
                <p><strong>(15) Farm Semitrailer or Farm Trailer</strong> – designed and used primarily as a farm vehicle.</p>
                <p><strong>(16) Farm tractor</strong> – has the meaning assigned by 541.201 (a motor vehicle designed and used primarily as a farm implement to draw an implement of husbandry, including a plow or a mowing machine.)</p>
                <p><strong>(20) Implement of Husbandry</strong> – has the meaning assigned by 541.201 – (A) a vehicle, other than a passenger car or truck, that is designed and adapted for use as a farm implement, machinery, or tool for tilling the soil; (B) a towed vehicle that transports to the field and spreads fertilizer or agricultural chemicals; or (C) a motor vehicle designed and adapted to deliver feed to livestock.</p>
                <p><strong>(30) Operate Temporarily on the Highways</strong> – must be going to or coming from a farm and certain other places.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This definition is important to understand when considering farm trailer use (502.146). This definition is also utilized in the Texas DMV registration manual – farm tractors and implements of husbandry that are operated "temporarily on the highways" are not subject to registration.
                </div>
                <p><strong>(33) Power Sweeper</strong> – means an implement, with or without motive power, designed for the removal by a broom, vacuum, or regenerative air system of debris, dirt, gravel, litter, or sand from asphaltic concrete or cement concrete surfaces. The term includes a vehicle on which the implement is permanently mounted if the vehicle is used only as a power sweeper.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> TRC 502.143 states that a power sweeper may not be registered. A vehicle that meets this definition will be operated on highways with no license plate and no registration insignia.
                </div>
                <p><strong>(36) Public Property</strong> – property owned or leased by this state or a political subdivision of this state.</p>

                <h4>502.005 – Registration of Autocycle</h4>
                <p>Autocycles are defined identically in 501.008 and 502.005. This definition for "autocycle" is used throughout the TRC.</p>
                <ol>
                    <li>designed to have when propelled not more than three wheels on the ground;</li>
                    <li>equipped with seatbelts and a steering mechanism;</li>
                    <li>equipped with seating that does not require the operator to straddle or sit astride the seat; and</li>
                    <li>manufactured and certified to comply with federal safety requirements for a motorcycle.</li>
                </ol>
                <div class="info-box">
                    <strong>How to Treat an Autocycle:</strong><br>
                    • For driver license purposes, treat autocycles like cars (Reference 521.085).<br>
                    • For registration purposes, treat autocycles like motorcycles (only one plate is issued and the registration insignia is displayed on the plate).<br>
                    • For title purposes, treat autocycles like motorcycles (Reference 501.008).<br>
                    • For passenger restrictions, treat autocycles like motorcycles (Reference 545.416(f)).<br>
                    • For helmet purposes, treat autocycles like motorcycles unless they are fully or partially enclosed (Reference 661.0015).<br>
                    • For seatbelt purposes, treat autocycles like motorcycles (Reference 545.412 – autocycle is not included in the specific definition of "passenger vehicle" used for seatbelts and child safety seats, therefore seatbelts/child safety seats are not required to be used.)
                </div>

                <h4>502.040 – Registration Required; General Rule</h4>
                <p>This is the section under which the vast majority of vehicles are registered in Texas. Upon purchasing a vehicle or becoming a resident of Texas, a person has 30 Days to register a motor vehicle, trailer, or semi-trailer. Everything rolling down the road is required to be registered unless there is a specific exception granted in TRC Chapter 502 or the DMV Registration Manual.</p>
                <p><strong>Word Association:</strong> Registration Required → motor vehicle, trailer, or semitrailer → 30 Days</p>
                <div class="apply-it-section">
                    <div class="apply-it-header">Apply It: Registration Violations</div>
                    <div class="apply-it-scenario">
                        <p>Officer Johnson pulls over a vehicle for speeding and discovers the driver just moved to Texas from Oklahoma 45 days ago. The vehicle still has Oklahoma plates and registration.</p>
                    </div>
                    <div class="apply-it-question">
                        <p>What is the most appropriate charge for this violation?</p>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">Operate Unregistered Trailer or Semitrailer</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, true)">
                                <div class="option-text">Operate Unregistered/Improperly Registered Motor Vehicle</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">No violation - Oklahoma registration is still valid</div>
                            </div>
                        </div>
                    </div>
                    <div class="apply-it-feedback">
                        <p><strong>Correct!</strong> Under TRC 502.040, upon becoming a Texas resident, a person has 30 days to register their motor vehicle. Since 45 days have passed, this violates the registration requirement.</p>
                        <p><strong>Key Learning Points:</strong></p>
                        <ul>
                            <li>30-day registration requirement for new residents</li>
                            <li>Cross-reference: 502.471 (offense for violating Chapter 502)</li>
                            <li>Cross-reference: 502.472 (operating unregistered motor vehicle)</li>
                        </ul>
                    </div>
                </div>

                <p>There are numerous exceptions to the registration requirement in Texas. They will be discussed in more detail later in this course and can be found in TRC 502.140-502.146. A brief list of vehicles that cannot be registered in most circumstances or that do not require registration:</p>
                <ul>
                    <li>Off-Highway Vehicles (ATVs, Recreational Off-Highway Vehicles, Utility Vehicles, and Sand Rails)</li>
                    <li>Former Military Vehicles designated for off-highway use</li>
                    <li>Manufactured Housing</li>
                    <li>Power Sweepers</li>
                    <li>Motorized Mobility Devices (electric wheelchairs)</li>
                    <li>Electric Personal Assistive Mobility Devices (Segway-type vehicles)</li>
                    <li>Vehicles operated to cross a highway separating real property on either side under the control of the vehicle owner</li>
                    <li>Vehicles operated by non-residents while visiting Texas (must be registered in the owner's home state)</li>
                    <li>Certain Farm Vehicles, Drilling and Construction Equipment</li>
                </ul>

                <h4>502.046 – Evidence of Financial Responsibility</h4>
                <p>Evidence of financial responsibility (usually insurance) must be shown in order to register a motor vehicle. This is not required for trailers and semi-trailers.</p>

                <h4>502.059 – Issuance of Registration Insignia</h4>
                <p>Each vehicle registered is issued a registration insignia. The registration insignia validates the license plates for a specific registration period.</p>
                <p>This insignia must be displayed in the lower left corner of the windshield. If a vehicle does not have a windshield, an insignia will be attached to the license plate. Displaying a registration insignia in the wrong location is a violation.</p>
                <p>Motorcycles, trailers, and vehicles bearing a machinery license plate are required to display a registration insignia on the rear license plate.</p>
                <p><strong>DPS Arrest Title:</strong> Improperly Displayed Registration Insignia</p>
                <p>Additional details regarding insignia display can be found in Texas Administrative Code Title 43, Part 10, Rule 217.27.</p>

                <div class="apply-it-section" id="apply-it-registration-insignia">
                    <div class="apply-it-header">
                        <span>🚗</span> Apply It: Registration Insignia Placement
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You see this vehicle driving down the road. The registration insignia is current, but displayed on the right side of the windshield instead of the lower left corner where it should be.
                    </div>
                    <div class="apply-it-question">
                        Is this a violation?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer('registration-insignia', 'yes', true, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer('registration-insignia', 'no', false, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-question" style="margin-top: 1.5rem;">
                        If yes, what is the violation? 
                        <input type="text" class="apply-it-fill-blank" placeholder="Enter the violation name..." onblur="checkFillBlank(this, 'Improperly Displayed Registration Insignia', 'registration-insignia', 'violation')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Improperly Displayed Registration Insignia', 'registration-insignia', 'violation')" style="width: 100%; margin-top: 0.5rem;">
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-registration-insignia">
                        <strong>✅ Correct!</strong><br>
                        <strong>Yes</strong>, this is a violation. The violation is <strong>"Improperly Displayed Registration Insignia"</strong> per Section 502.059.<br><br>
                        <em><strong>Key Point:</strong> Registration insignia must be displayed in the lower left corner of the windshield. Any other location (including the right side) is a violation, even if the insignia is current and valid.</em><br><br>
                        <strong>Reference:</strong> TRC Section 502.059(c) - Display requirements for registration insignia.
                    </div>
                </div>

                <h4>502.094 – 72 or 144 Hour Permits</h4>
                <p>72 and 144 hour Permits are issued for temporary commercial motor vehicle, trailer, semitrailer, or motor bus operation. There are no specific rules for how to display a 72 or 144 hour permit in the TRC or Administrative Code.</p>
                <p>(a)(3) The vehicle must be covered by financial responsibility (insurance) prior to receiving a 72 or 144 Hour permit.</p>
                <p>(e) The vehicle must receive a state inspection prior to operating on a highway. Operating an uninspected vehicle under a 72 or 144 hour permit constitutes a violation (DPS Arrest Title Operate Vehicle Without Required Inspection).</p>
                <p>(f) If a vehicle has been apprehended for violating a registration law of this state, it is no longer eligible for a 72 or 144 hour permit. Reference Administrative Code Title 37, Part 1, Rule 4.33: For the purpose of enforcing all provisions of TRC Chapter 502, a vehicle is considered to be apprehended when a citation has been issued for a registration violation.</p>
                <p>(g) As soon as the permit expires, the vehicle is considered to be unregistered (i.e. there is no grace period).</p>
                <p>The registration receipt is required to be carried when operating under a permit in lieu of registration, per DMV Administrative Code Title 43, Part 10, Rule 217.40.</p>

                <h4>502.095 – One-Trip or 30 Day Trip Permits</h4>
                <p>These permits are issued to allow operation of motor vehicles that are otherwise unregistered. A vehicle operated beyond the scope of one of these permits is considered to be unregistered.</p>

                <p><strong>(c) One-Trip Permit</strong></p>
                <ul>
                    <li>Good for only one trip from point to point. DMV Administrative Code Rule 217.40 states that the trip must either begin or end in Texas.</li>
                    <li>May not be valid for more than 15 days.</li>
                    <li>Used to transport the vehicle only and may not be used to transport passengers or property.</li>
                    <li>Violation of these provisions means the vehicle is no longer covered by the permit and it should be considered to be unregistered.</li>
                    <li>Cost of the One-Trip Permit is $5.</li>
                    <li>A one trip permit does not require a vehicle inspection (reference 548.052).</li>
                </ul>

                <p><strong>(d) 30 Day Permit</strong></p>
                <ul>
                    <li>Can only be issued to vehicles with a gross weight or not more than 10,000 pounds unless the vehicle is operated unladen (vehicles with a gross weight of more than 10,000 pounds cannot be operated on a 30 Day Permit while carrying a load – they would need to obtain a 72 or 144-hour permit).</li>
                    <li>Violation of these provisions means the vehicle is no longer covered by the permit and it should be considered to be unregistered.</li>
                    <li>Vehicles operated under a 30 Day Permit are required to be inspected. Failure to be inspected constitutes an offense (Operate Vehicle Without Required Inspection).</li>
                    <li>Cost of the permit is $25.</li>
                </ul>

                <p>(e)(3) Proof of financial responsibility is required for One-Trip and 30-Day Permits.</p>
                <p>(f) The registration receipt shall be carried in the vehicle at all times during operation on a One-Trip or 30-Day permit (reference 502.474).</p>
                <p>Display – One-Trip and 30-Day permits are required to be displayed in the rear window of the vehicle so that the tag is clearly visible and legible, however if the vehicle does not have a rear window the permit must simply be carried somewhere in the vehicle.</p>
                <div class="apply-it-section">
                    <div class="apply-it-header">Apply It: Permit Requirements</div>
                    <div class="apply-it-scenario">
                        <p>Officer Martinez stops a vehicle with a 30-Day permit displayed in the side window. The driver cannot produce the registration receipt and claims it's in the glove compartment at home.</p>
                    </div>
                    <div class="apply-it-question">
                        <p>What violation(s) are present? (Select all that apply)</p>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="checkApplyItMultiple(this, true)">
                                <div class="option-text">Improperly Displayed One Trip or 30 Day Permit</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyItMultiple(this, true)">
                                <div class="option-text">Fail to Display Registration Receipt One Trip or 30 Day Permit</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyItMultiple(this, false)">
                                <div class="option-text">No violation - permit is visible</div>
                            </div>
                        </div>
                    </div>
                    <div class="apply-it-feedback">
                        <p><strong>Correct!</strong> Two violations are present:</p>
                        <ul>
                            <li><strong>Improper Display:</strong> 30-Day permits must be displayed in the rear window, not side window</li>
                            <li><strong>Missing Receipt:</strong> Registration receipt must be carried in the vehicle at all times</li>
                        </ul>
                        <p><strong>Key Reminders:</strong></p>
                        <ul>
                            <li>One-Trip Permit: Point A to Point B, vehicle only, no inspection, $5</li>
                            <li>30-Day Permit: No more than 10,000 lbs unless unladen, inspection required, $25</li>
                        </ul>
                    </div>
                </div>

                <h4>VEHICLES NOT ISSUED REGISTRATION</h4>
                <p>Although registration is generally required for vehicles to operate on Texas highways, the TRC provides a number of specific exceptions. The Texas Department of Motor Vehicles should not issue registration for the vehicles described in the following sections. Some of these vehicles may still be legally operated on the highway under permits or other circumstances, or they may be issued distinguishing license plates that identify the vehicle but don't constitute full registration.</p>

                <h4>502.140 – Certain Off-Highway Vehicles</h4>
                <p>Off-highway vehicle is defined in TRC 551A.001 – this term includes all-terrain vehicles, recreational off-highway vehicles, sand rails, and utility vehicles.</p>
                <p>An individual cannot register an off-highway vehicle for operation on a public highway.</p>
                <p>The state, county, or a municipality can register an off-highway vehicle for use on a public highway. The vehicle will be issued a normal license plate and registration insignia in these circumstances.</p>
                <p>Does this mean an individual is never allowed to operate an off-highway vehicle on public highways? No. Although an individual is not permitted to register an off-highway vehicle, there are certain circumstances where they would be permitted to operate the vehicle on public highways. These circumstances are described in TRC Chapter 551A and will be discussed in detail later. In these circumstances, the off-highway vehicle may have a distinguishing license plate identifying it as an off-highway vehicle, but this does not constitute "registration". The license plate is for identification purposes only.</p>

                <h4>502.142 – Manufactured Housing</h4>
                <p>Manufactured housing is not issued registration. If it is moving down the highway, it should be moving under a special permit, not 502.040 registration. The permit will not be displayed on the manufactured house. It will be carried by the operator.</p>

                <h4>502.143 – Other Vehicles</h4>
                <p>These vehicles may be encountered operating on public highways, however registration is not issued for them, therefore they are not required to display a license plate, permit, or registration insignia:</p>
                <ul>
                    <li>Power Sweepers</li>
                    <li>Motorized Mobility Devices (electric wheelchairs)</li>
                    <li>Electric Personal Assistive Mobility Devices (Segways)</li>
                    <li>Electric Bicycles</li>
                </ul>

                <h4>502.144 – Vehicles Operated on Public Highway Separating Real Property Under Vehicle Owner's Control</h4>
                <p>This section allows a property owner to cross the road in an unregistered vehicle if said person owns property on both sides of the road.</p>

                <div class="apply-it-section" id="apply-it-5">
                    <div class="apply-it-header">
                        <span>🏡</span> Apply It: Property Owner Crossing Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario 1:</strong> You stop a vehicle because it's not displaying license plates or registration. You talk to Joe and find out he's driving from his property on one side of the road to his property on the other side.
                    </div>
                    <div class="apply-it-question">
                        Is Joe committing a violation for operating an unregistered motor vehicle on a public highway?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(5, 'yes', false, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(5, 'no', true, event)" data-answer="no">No</div>
                    </div>
                    
                    <div class="apply-it-scenario" style="margin-top: 1.5rem;">
                        <strong>Scenario 2:</strong> You stop the same vehicle. Joe explains he's just crossing the road from his property to his favorite gas station.
                    </div>
                    <div class="apply-it-question">
                        Is Joe committing a violation for operating an unregistered motor vehicle on a public highway?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer('5b', 'yes', true, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer('5b', 'no', false, event)" data-answer="no">No</div>
                    </div>
                    
                    <div class="apply-it-feedback" id="feedback-apply-it-5">
                        <strong>✅ Scenario 1: No violation</strong><br>
                        Joe is exempt under Section 502.144 - vehicles operated on public highway separating real property under vehicle owner's control.<br><br>
                        <strong>✅ Scenario 2: Yes, violation</strong><br>
                        Going to a gas station is NOT covered by the exemption. The exemption only applies when crossing between properties owned/controlled by the same person.<br><br>
                        <em><strong>Key Point:</strong> The exemption is very narrow - only for crossing between owned/controlled properties.</em>
                    </div>
                </div>

                <h4>502.145 – Vehicles Operated by Certain Non-Residents</h4>
                <p>This section provides for reciprocity and allows nonresident visitors to Texas from other states to operate vehicles in Texas under their home state registration. Home state registration must be current and valid.</p>
                <p>Once a person becomes a resident of Texas reciprocity ends after 30 days and the person's vehicles are subject to Texas registration (502.040).</p>

                <h4>502.146 – Certain Farm Vehicles and Drilling and Construction Equipment</h4>
                <p>Vehicles described in this section may be issued distinguishing license plates to identify what they are, however this does not constitute full registration, therefore the vehicles will be limited to specific types of operation.</p>

                <p><strong>Farm Trailers</strong></p>
                <p>The license plate or registration requirements for farm trailers is dependent on the trailer's gross weight and how the trailer is being used.</p>
                <p>Farm trailers are not required to be registered when used "temporarily on the highway" (502.001(30)) to transport agricultural products or supplies to or from the farm or for the purposes of participating in equine activity as long as the trailer's gross weight is not more than 34,000 pounds.</p>
                <p>Farm trailers are not required to receive a state inspection regardless of weight.</p>
                <ul>
                    <li>Farm Trailers with a gross weight of 4,000 pounds or less – no license plate or registration required.</li>
                    <li>Farm Trailers with a gross weight of more than 4,000 pounds but not more than 34,000 pounds – a Farm Trailer license plate is required, but full registration is not required.</li>
                    <li>Trailers with a gross weight of more than 34,000 pounds – no longer eligible for Farm Trailer license plates and must have normal trailer registration.</li>
                </ul>
                <p>Source: Texas DMV Registration Manual</p>

                <div class="info-box">
                    <strong>Discussion Point:</strong> A trailer used for equine activity or attending livestock shows as defined in the Texas Civil Practice and Remedy Code (87.001) may be registered as a farm trailer. This definition is wide ranging and includes rodeo participation even when the participant receives compensation for participation.<br><br>
                    <strong>Texas DMV Manual Clarification</strong> – Trailers with living quarters still qualify for farm trailer license plates if the trailer is used within the normal parameters of a farm trailer (agricultural use or equine activity).
                </div>

                <p><strong>DPS Arrest Title:</strong> Farm Trailer License Violation</p>

                <div class="apply-it-section" id="apply-it-6">
                    <div class="apply-it-header">
                        <span>🚜</span> Apply It: Farm Trailer License Violation Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You stop a vehicle towing a trailer displaying a farm trailer license plate. Select each circumstance where you could take enforcement action for a Farm Trailer License Violation:
                    </div>
                    
                    <div class="apply-it-question">
                        Click on each scenario that would constitute a violation:
                    </div>
                    
                    <div style="display: grid; gap: 1rem; margin: 1rem 0;">
                        <div class="apply-it-option" onclick="selectMultipleChoice(6, 'A', false)" data-answer="A" style="justify-content: flex-start; min-width: 100%;">
                            <strong>A.</strong> The trailer is loaded with corn on the way to the processing plant
                        </div>
                        <div class="apply-it-option" onclick="selectMultipleChoice(6, 'B', false)" data-answer="B" style="justify-content: flex-start; min-width: 100%;">
                            <strong>B.</strong> The trailer is loaded with rodeo gear and the driver is a professional rodeo cowboy
                        </div>
                        <div class="apply-it-option" onclick="selectMultipleChoice(6, 'C', true)" data-answer="C" style="justify-content: flex-start; min-width: 100%;">
                            <strong>C.</strong> The trailer is loaded with furniture because the farmer is moving to a new house
                        </div>
                        <div class="apply-it-option" onclick="selectMultipleChoice(6, 'D', true)" data-answer="D" style="justify-content: flex-start; min-width: 100%;">
                            <strong>D.</strong> The trailer is loaded with yard equipment because the farmer mows yards as a side job
                        </div>
                        <div class="apply-it-option" onclick="selectMultipleChoice(6, 'E', false)" data-answer="E" style="justify-content: flex-start; min-width: 100%;">
                            <strong>E.</strong> The trailer is loaded with lumber for building a new barn on the farm
                        </div>
                    </div>
                    
                    <div class="apply-it-scenario" style="margin-top: 2rem;">
                        <strong>Additional Scenario:</strong> You stop a vehicle towing a small trailer with no license plates or registration. The driver tells you he is a farmer and he is hauling some farm equipment to the farm. The trailer has a gross weight of 3,800 pounds.
                    </div>
                    <div class="apply-it-question">
                        Is the driver committing a violation for the unregistered trailer with no license plate?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer('6b', 'yes', false, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer('6b', 'no', true, event)" data-answer="no">No</div>
                    </div>
                    
                    <div class="apply-it-feedback" id="feedback-apply-it-6">
                        <strong>✅ Correct Violations: C and D</strong><br>
                        <strong>A.</strong> ✅ <em>Legal</em> - Transporting agricultural products<br>
                        <strong>B.</strong> ✅ <em>Legal</em> - Rodeo activity is covered under equine activity<br>
                        <strong>C.</strong> ❌ <em>VIOLATION</em> - Moving furniture is not agricultural/equine activity<br>
                        <strong>D.</strong> ❌ <em>VIOLATION</em> - Side business (for hire) violates farm trailer restrictions<br>
                        <strong>E.</strong> ✅ <em>Legal</em> - Building materials for farm use<br><br>
                        <strong>Small Trailer Scenario: No violation</strong><br>
                        Under 4,000 pounds gross weight and used for farm purposes = no license plate required.<br><br>
                        <em><strong>Key Point:</strong> Farm trailers cannot be used "for hire" or non-agricultural purposes.</em>
                    </div>
                </div>

                <p><strong>Additional vehicles described in 502.146 (not subject to registration):</strong></p>
                <ul>
                    <li>(b)(2) and (b)(3) Water well and oil well drilling equipment - Not required to receive full registration. Only a "Machinery" distinguishing license plate is required.</li>
                    <li>(b)(4) Construction Machinery - Not required to receive full registration. Only a "Machinery" distinguishing license plate is required.</li>
                    <li>(c)(1) Farm Trailer owned by a cotton gin - Not required to receive registration if used exclusively to transport agricultural products without charge.</li>
                    <li>(c)(2) Fertilizer Trailer - Not required to be registered if used exclusively to transport fertilizer without charge.</li>
                    <li>(c)(3) Cottonseed Trailer - Not required to be registered if used exclusively to transport cottonseed without charge.</li>
                </ul>

                <p>(d) Farm trailers are exempt from state inspection requirements in Chapter 548.</p>
                <p>(e) Farm trailers used for hire are not covered by this section and would require normal registration. If any vehicle covered by this section is found to be operating outside the parameters described in this section, the vehicle is considered to be unregistered and enforcement action can be taken.</p>
                <p>(f) Enforcement: If any vehicle covered by this section is found to be operating outside the parameters described in this section, the vehicle is considered to be unregistered and enforcement action can be taken for Operate Unregistered Motor Vehicle, Trailer, or Semitrailer.</p>
                <p>(h) In order to obtain a farm trailer license plate, the owner must show proof of farm ownership by way of a distinguishing number issued by the comptroller.</p>

                <h4>502.407 – Operation of Vehicle with Expired License Plate</h4>
                <p>This offense does not take place until AFTER the 5th business day after the registration insignia expires. There is no reasonable suspicion or probable cause for a stop (even to write a warning) if it is not AFTER the 5th business day.</p>
                <p>This section ties the license plate and the registration insignia together. When the insignia is expired, the offense is for displaying a license plate that is no longer validated by a current insignia – i.e. the license plate is expired.</p>
                <p><strong>DPS Arrest Title:</strong> Operation of Vehicle with Expired License Plate</p>
                <p><strong>Word Association:</strong> Expired License Plate/Registration → After 5th Business Day</p>

                <div class="apply-it-section" id="apply-it-7">
                    <div class="apply-it-header">
                        <span>📅</span> Apply It: Expired Registration Timeline
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You see a vehicle bearing a registration insignia expiring 5/31/2021 (Monday, May 31, 2021).
                    </div>
                    <div class="apply-it-question">
                        What is the first day enforcement action can be taken?
                        <input type="text" class="apply-it-fill-blank" placeholder="Enter date..." onblur="checkDateAnswer(this, 'June 7, 2021', 7)">
                    </div>
                    <div class="apply-it-question">
                        Can you stop a vehicle before that date if you just issue a warning?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer('7b', 'yes', false, event)" data-answer="yes">Yes</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer('7b', 'no', true, event)" data-answer="no">No</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-7">
                        <strong>✅ Correct!</strong><br>
                        <strong>First enforcement day:</strong> June 7, 2021 (AFTER the 5th business day)<br>
                        <strong>Calculation:</strong><br>
                        • Expires: Monday, May 31, 2021<br>
                        • Business Day 1: Tuesday, June 1<br>
                        • Business Day 2: Wednesday, June 2<br>
                        • Business Day 3: Thursday, June 3<br>
                        • Business Day 4: Friday, June 4<br>
                        • Business Day 5: Monday, June 7 (Saturday/Sunday don't count)<br>
                        • First enforcement day: Tuesday, June 8<br><br>
                        <strong>Warning before enforcement date:</strong> <strong>NO</strong> - There is no reasonable suspicion or probable cause for a stop (even for a warning) until AFTER the 5th business day.<br><br>
                        <em><strong>Key Point:</strong> "AFTER the 5th business day" - weekends don't count as business days.</em>
                    </div>
                </div>

                <p><strong>Discussion Point:</strong> the language in this section refers to having a license plate for the preceding period. This implies that this offense can only be committed for one year after the expiration date, as most registration periods last for one year. Beyond that year, enforcement should be taken under 502.472 for operating an unregistered vehicle.</p>

                <h4>502.433 – Fee: Commercial Farm Motor Vehicles</h4>
                <p>Farm Truck plates can be issued for any vehicle that meets the definition of "commercial motor vehicle" in Chapter 502 (a vehicle designed or used primarily to transport property). The DMV Registration Manual states farm plates may not be issued to a passenger vehicle. The cost for farm truck registration is 50% of the regular registration fee.</p>

                <p>Farm Truck plates can be used for a variety of things that constitute necessities for the home/family, including:</p>
                <ol>
                    <li>to attend church or school;</li>
                    <li>to visit a doctor for medical treatment or supplies;</li>
                    <li>for other necessities of the home or family; or</li>
                    <li>for the purpose of participating in equine activities or attending livestock shows.</li>
                </ol>

                <p>The primary restriction is that Farm Truck license plates cannot be used for gainful employment outside of farming or ranching. Notice "Farm Truck" license plates are less restrictive than "Farm Trailer" license plates.</p>

                <h4>502.478 – CMV Use for Agricultural Purposes (Farm Truck Plate)</h4>
                <p>This is the violation/enforcement mechanism when a farm truck license plate is being used improperly (usually for gainful employment).</p>
                <p><strong>DPS Arrest Title:</strong> Farm Truck License Violation</p>
                <p><strong>Word Association:</strong> Farm Truck → No Gainful Employment Outside Farming/Ranching/Equine Activity</p>

                <div class="apply-it-section" id="apply-it-10">
                    <div class="apply-it-header">
                        <span>🚜</span> Apply It: Farm Truck License Violations
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You stop a vehicle displaying farm truck license plates. Select each circumstance where you could take enforcement action for a Farm Truck License Violation:
                    </div>
                    <div class="apply-it-question">
                        Which situations would result in a Farm Truck License Violation? (Select all that apply)
                    </div>
                    <div class="apply-it-options multi-select">
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'A', false)" data-answer="A">A. The truck is loaded with corn on the way to the processing plant</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'B', true)" data-answer="B">B. The truck is loaded with rodeo gear and the driver is a professional cowboy on his way to the rodeo</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'C', false)" data-answer="C">C. The truck is unloaded and the operator is on his way to church</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'D', false)" data-answer="D">D. The truck is loaded with furniture because the farmer is moving to a new home</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'E', true)" data-answer="E">E. The truck is loaded with yard equipment because the farmer mows yards as a side job</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(10, 'F', false)" data-answer="F">F. The truck is unloaded and the operator is taking his child to the doctor</div>
                    </div>
                    <div class="apply-it-submit">
                        <button onclick="checkMultiSelect(10, ['B', 'E'])">Submit Answer</button>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-10">
                        <strong>✅ Correct!</strong><br>
                        The violations are <strong>B and E</strong>.<br><br>
                        <strong>B:</strong> Being a professional cowboy constitutes gainful employment outside of farming/ranching.<br>
                        <strong>E:</strong> Mowing yards as a side job is gainful employment outside of farming/ranching.<br><br>
                        <em><strong>Key Point:</strong> Farm trucks cannot be used for gainful employment outside of farming, ranching, or equine activities.</em>
                    </div>
                </div>

                <h4>REGISTRATION OFFENSES AND PENALTIES</h4>
                <p>Chapter 502 described numerous registration requirements. Sections 502.471 – 502.480 describe the actual offenses and penalties for violating the provisions of Chapter 502.</p>

                <h4>502.471 – General Penalty</h4>
                <p>This is a general provision for violating some aspect of Chapter 502 for which there is not a more specific penalty – a misdemeanor offense punishable by a fine of not more than $200.</p>

                <h4>502.472 – Operation of Vehicle Under Improper Registration</h4>
                <p>This is a specific offense for operating an unregistered motor vehicle at a time and under circumstances that required the vehicle to be registered (described in 502.040).</p>
                <p>This section also creates an offense for a vehicle registered for a class other than that to which the vehicle belongs (different classes of vehicles carry different registration fees).</p>
                <p>Note: this section is specific to motor vehicles. Unregistered trailers and semi-trailers would fall under the general violation described in the previous section.</p>

                <h4>502.473 – Operation of Vehicle Without Registration Insignia</h4>
                <p>This is the offense for a vehicle that is currently registered but fails to display the registration insignia on the windshield or license plate as required (reference 502.059(c) – display requirements).</p>
                <div class="apply-it-section">
                    <div class="apply-it-header">Apply It: Registration Insignia Violations</div>
                    <div class="apply-it-scenario">
                        <p>Officer Davis notices a vehicle with current registration but no windshield sticker visible. The license plate appears to be current but is bent and partially unreadable.</p>
                    </div>
                    <div class="apply-it-question">
                        <p>What is the most appropriate charge?</p>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="checkApplyIt(this, true)">
                                <div class="option-text">Operate Vehicle Without Registration Insignia</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">Operate Unregistered Motor Vehicle</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">Improperly Placed/Illegible License Plate</div>
                            </div>
                        </div>
                    </div>
                    <div class="apply-it-feedback">
                        <p><strong>Correct!</strong> This is a violation of TRC 502.473 - Operation of Vehicle Without Registration Insignia.</p>
                        <p><strong>Key Distinction:</strong> The vehicle IS registered (current license plate) but fails to display the required registration insignia (windshield sticker) as required by 502.059(c).</p>
                        <p><strong>DPS Arrest Titles:</strong></p>
                        <ul>
                            <li>Operate Vehicle Without Registration Insignia</li>
                            <li>Operate Road Tractor, MC, Trailer, Semitrailer Without Registration Insignia</li>
                        </ul>
                    </div>
                </div>

                <h4>502.474 – Operation of One-Trip Permit Without Registration Receipt</h4>
                <p>The registration receipt must be carried in the vehicle and displayed upon request when the vehicle is operated on a one-trip permit.</p>
                <p>One-Trip Permit temporary tags must be properly displayed in the rear window of a vehicle if the vehicle has a rear window (reference 502.095(f)).</p>
                <p>Note: This section is specific to One-Trip Permits, however keep in mind 30-Day Permits have the same display and registration receipt requirements (reference DMV Administrative Code Title 43, Part 10, Rule 217.40).</p>

                <h4>502.475 – Wrong, Fictitious, Altered or Obscured Insignia</h4>
                <p>The offenses described in this section are specific to the registration insignia, not license plates (for similar offenses dealing with license plates, see 504.945).</p>
                <p>A person commits an offense if the person attaches to or displays on a motor vehicle a registration insignia that:</p>
                <ol>
                    <li>is assigned to a different motor vehicle;</li>
                    <li>is assigned to the vehicle under any other motor vehicle law other than by the department;</li>
                    <li>is assigned for a registration period other than the registration period in effect; or</li>
                    <li>is fictitious.</li>
                </ol>
                <p>This offense is a Class C Misdemeanor if the registration insignia is assigned to a different vehicle or assigned for a registration period other than the period in effect.</p>
                <p>This offense is a Class B Misdemeanor if the registration insignia is fictitious.</p>
                <p>This section also creates an offense that is a Class B Misdemeanor if the person knowingly made illegible the letters, numbers, and other identification marks on the registration insignia.</p>

                <div class="apply-it-section" id="apply-it-11">
                    <div class="apply-it-header">
                        <span>🎯</span> Apply It: Registration Insignia Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> It is September of 2019. You see this vehicle pass you with a current registration insignia and an expired registration insignia.
                    </div>
                    <div class="apply-it-question">
                        What enforcement action is appropriate?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(11, 'A', false, event)" data-answer="A">A. No enforcement because the vehicle is displaying a current insignia</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(11, 'B', false, event)" data-answer="B">B. Violation – Operate vehicle with Expired License Plates</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(11, 'C', true, event)" data-answer="C">C. Violation – Display Wrong Registration Insignia</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-11">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"C. Violation – Display Wrong Registration Insignia"</strong>.<br><br>
                        The vehicle is displaying both current and expired insignias. This violates 502.475 for displaying a registration insignia assigned for a different registration period.<br><br>
                        <em><strong>Key Point:</strong> Only the current registration insignia should be displayed.</em>
                    </div>
                </div>
                
                <div class="apply-it-section" id="apply-it-12">
                    <div class="apply-it-header">
                        <span>✏️</span> Apply It: Altered Insignia Classification
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> The operator of this vehicle has used a marker to change the expiration dates on the registration insignia.
                    </div>
                    <div class="apply-it-question">
                        What level of offense has been committed?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(12, 'A', false, event)" data-answer="A">A. Class B Misd. – Fictitious Registration Insignia</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(12, 'B', false, event)" data-answer="B">B. Class C Misd. – Knowingly Altered/Made Illegible Registration Insignia</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(12, 'C', true, event)" data-answer="C">C. Class B Misd. – Knowingly Altered/Made Illegible Registration Insignia</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-12">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"C. Class B Misdemeanor – Knowingly Altered/Made Illegible Registration Insignia"</strong>.<br><br>
                        Per 502.475, knowingly altering or making illegible the identification marks on registration insignia is a Class B Misdemeanor.<br><br>
                        <em><strong>Key Point:</strong> Knowingly altering registration insignia is a Class B Misdemeanor offense.</em>
                    </div>
                </div>

                <h4>502.4755 – Deceptively Similar Insignia</h4>
                <p>A deceptively similar insignia is one that a reasonable person would presume was issued by DMV but it was not.</p>
                <p>Possession of a deceptively similar registration insignia is a Class C Misdemeanor, however this is enhanced to a Class B Misdemeanor if the violator has previously been convicted of this offense.</p>
                <p>If the person manufactures or sells deceptively similar insignias, the offense is a 3rd Degree Felony.</p>
                <p>For a similar offense involving license plates, see 504.946 (Deceptively Similar License Plate).</p>
                <p>Note: If the insignia is meant to look like a normal registration insignia but bears false information, enforcement action for Fictitious Registration Insignia under 502.475 is a more appropriate charge (the Fictitious Registration charge is a Class B Misdemeanor).</p>

                <h4>502.491 – Transfer of Vehicle Registration</h4>
                <p>This section addresses what to do with a registration insignia when a vehicle is sold.</p>
                <p>(a) applies to a vehicle sold by a dealership. The dealership is required to remove the registration insignia and the old registration is considered to be expired at the time of the sale.</p>
                <p>(b) applies to a private sale where neither party holds a dealership distinguishing number. Registration period can continue with the vehicle if the new owner files appropriate paperwork to transfer title/registration.</p>

                <h4>502.492 – Temporary Transit Permit for a Vehicle Purchased</h4>
                <p>If a person purchases a vehicle and the previous owner removes the license plates and registration upon sale, the new owner can apply for a temporary transit permit that is valid for 5 days.</p>
                <p>The permit can be purchased online, only one permit may be issued, and the receipt must be carried in the vehicle.</p>
                <p>There are no display requirements for the permit.</p>
                <p><strong>Word Association:</strong> Temporary Transit Permit → Purchased Vehicle → 5 days → Available Online</p>

                <h4>SECTION 1.4 – CHAPTER 503 - DEALER'S AND MANUFACTURER'S VEHICLE LICENSE PLATES</h4>
                <div class="info-box">
                    This section continues <strong>BPOC Objective 22.25</strong> - Discuss the requirement for registration of vehicles.
                </div>

                <h4>503.061 – Dealer's License Plates</h4>
                <p>This section refers to a metal dealer license plate. Per DMV rule (215.138) only one plate is issued and display is required in the rear license plate area. The RTS database will return to the dealership, not the vehicle. The dealer may place this plate on a vehicle to be used for demonstrations or for personal use. There are a few restrictions:</p>

                <p><strong>Restrictions on metal dealer plates from 503.061:</strong></p>
                <ul>
                    <li>The vehicle must be of a type the dealer is licensed to sell.</li>
                </ul>
                <p><strong>Restrictions on metal dealer plates from 503.068:</strong></p>
                <ul>
                    <li>The vehicle cannot be used as a service vehicle (defined in below referenced admin code).</li>
                    <li>The vehicle cannot be a commercial vehicle carrying a load.</li>
                </ul>
                <p><strong>Restrictions on metal dealer plates from DMV Administrative Code rule 215.138:</strong></p>
                <ul>
                    <li>Shall be attached to the rear license plate holder of a vehicle</li>
                    <li>A copy of the receipt for the metal dealer's license plate issued by the department should be carried in the vehicle.</li>
                    <li>Displayed only on the type of vehicle for which the GDN is issued and for which a dealer is licensed to sell.</li>
                    <li>Vehicle must have a valid safety inspection.</li>
                </ul>
                <p>Reminder: Vehicles displaying metal dealer license plates may be used for personal use as long as the above requirements are met.</p>

                <div class="apply-it-section" id="apply-it-13">
                    <div class="apply-it-header">
                        <span>🚗</span> Apply It: Dealer License Plate Usage
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You stop a vehicle displaying a metal dealer license plate for speeding. The driver explains he is on a road trip for vacation. He owns a dealership and he pulled the vehicle off his lot and placed the dealer LP on it for his road trip.
                    </div>
                    <div class="apply-it-question">
                        Is he committing a violation for improperly using the dealer metal plate?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(13, 'yes', false, event)" data-answer="yes">YES</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(13, 'no', true, event)" data-answer="no">NO</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-13">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"NO"</strong>. Metal dealer license plates may be used for personal use as long as requirements are met (valid inspection, displayed on proper vehicle type, etc.).<br><br>
                        <em><strong>Key Point:</strong> Metal dealer plates allow personal use, unlike dealer temporary tags.</em>
                    </div>
                </div>
                
                <div class="apply-it-section" id="apply-it-14">
                    <div class="apply-it-header">
                        <span>🔍</span> Apply It: Inspection Requirement
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You run the same vehicle through a database and find that it has not undergone a Texas state inspection.
                    </div>
                    <div class="apply-it-question">
                        Is the driver committing a violation for Operate Vehicle Without Required Inspection?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(14, 'yes', true, event)" data-answer="yes">YES</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(14, 'no', false, event)" data-answer="no">NO</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-14">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"YES"</strong>. Vehicles displaying metal dealer license plates must have a valid safety inspection.<br><br>
                        <em><strong>Key Point:</strong> Metal dealer plates require valid inspection for operation.</em>
                    </div>
                </div>

                <h4>503.062 – Dealer's Temporary Tags</h4>
                <p>There are very limited uses for dealer temporary tags (dealer/converter temporary tags and authorized agent tags). They are much more restrictive than metal dealer license plates.</p>
                <p><strong>Dealer's temporary tags may ONLY be used for the following purposes:</strong></p>
                <ul>
                    <li>Vehicle demonstration to prospective buyer.</li>
                    <li>Transit dealer to dealer, to/from an auction, or to/from a repair facility.</li>
                    <li>Road test the vehicle.</li>
                    <li>Vehicle use by a charitable organization.</li>
                    <li>Loaner vehicle to customer while customer's vehicle is being repaired.</li>
                </ul>
                <p>A state inspection is not required for vehicles displaying dealer temporary tags.</p>
                <p>Dealer temporary tags used for purposes not listed above constitute a violation for Operate Vehicle Displaying Unauthorized/Improperly Used Temporary Tag.</p>
                <p>Reference 503.068(a) – Dealer temporary tags may not be used for personal use.</p>
                <p>Display – A dealer's temporary tag is required to be displayed in the license plate display area located at the rear of the vehicle, so that the entire temporary tag is visible and legible at all times, including when the vehicle is being operated. Reference DMV Administrative Code Title 43, Part 10, Rule 215.151(a)</p>

                <div class="apply-it-section" id="apply-it-15">
                    <div class="apply-it-header">
                        <span>🏷️</span> Apply It: Dealer Temporary Tag Scenarios
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Three scenarios to analyze:</strong>
                    </div>
                    
                    <div class="apply-it-subsection">
                        <div class="apply-it-question">
                            <strong>Scenario 1:</strong> You stop a vehicle displaying a dealer temporary tag for speeding. The driver explains that he is on a road trip for vacation. He owns a dealership and he pulled the vehicle off his lot and placed the dealer tag on it for his road trip. Is he committing a violation for an unauthorized/improperly used temporary tag?
                        </div>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'yes1', true, event)" data-answer="yes1">YES</div>
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'no1', false, event)" data-answer="no1">NO</div>
                        </div>
                        <div class="apply-it-feedback" id="feedback-apply-it-15">
                            <strong>✅ Correct!</strong><br>
                            The answer is <strong>"YES"</strong>. Dealer temporary tags cannot be used for personal use. They are limited to specific purposes like demonstrations, transit, road tests, charity use, or loaner vehicles.<br><br>
                        </div>
                    </div>
                    
                    <div class="apply-it-subsection">
                        <div class="apply-it-question">
                            <strong>Scenario 2:</strong> You run the vehicle through a database and find that it has not undergone a Texas state inspection. Is the driver committing a violation for Operate Vehicle Without Required Inspection?
                        </div>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'yes2', false, event)" data-answer="yes2">YES</div>
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'no2', true, event)" data-answer="no2">NO</div>
                        </div>
                        <div class="apply-it-feedback-sub" id="feedback-sub-15-2">
                            <strong>✅ Correct!</strong><br>
                            The answer is <strong>"NO"</strong>. A state inspection is not required for vehicles displaying dealer temporary tags.<br><br>
                        </div>
                    </div>
                    
                    <div class="apply-it-subsection">
                        <div class="apply-it-question">
                            <strong>Scenario 3:</strong> You stop a vehicle displaying a dealer temporary tag for speeding. The driver explains her vehicle is at the dealership for maintenance and the dealership loaned her this vehicle in the meantime. Is she committing a violation for an unauthorized/improperly used temporary tag?
                        </div>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'yes3', false, event)" data-answer="yes3">YES</div>
                            <div class="apply-it-option" onclick="selectApplyItAnswer(15, 'no3', true, event)" data-answer="no3">NO</div>
                        </div>
                        <div class="apply-it-feedback-sub" id="feedback-sub-15-3">
                            <strong>✅ Correct!</strong><br>
                            The answer is <strong>"NO"</strong>. Loaner vehicles to customers while their vehicle is being repaired is an authorized use of dealer temporary tags.<br><br>
                            <em><strong>Key Point:</strong> Dealer temporary tags have very limited authorized uses compared to metal dealer plates.</em>
                        </div>
                    </div>
                </div>

                <h4>503.0626 – Dealer's and Converter's Database</h4>
                <p>Dealer's and Converter's temporary tags are placed in a database. Law enforcement officers can run the tag number and receive a vehicle specific return.</p>

                <h4>503.063 – Buyer's Temporary Tag</h4>
                <p>Only one buyer's tag can be issued for a period of time no longer than 60 days. The operator of a vehicle that has been issued a second Buyer's Tag after the first expires is committing a violation. If normal registration is not received prior to Buyer's Tag expiration, other temporary registration must be obtained (30 day permit, one trip permit, etc.).</p>
                <p>The dealer is required to properly display the tag upon issuance.</p>
                <p>Display – Buyer's Temporary Tags are required to be displayed in the license plate display area located at the rear of the vehicle, so that the entire temporary tag is visible and legible at all times, including when the vehicle is being operated, per DMV Administrative Code Title 43, Part 10, Rule 215.151(a).</p>
                <p>A buyer's temp tag that is rolled up so that it is no longer visible and legible due to air movement while the vehicle is being operated is improperly displayed and a violation exists (Improperly Displayed Dealer/Buyer Temporary Tag). Flapping in the wind is not specifically prohibited as long as the tag is still visible and legible.</p>
                <p>Case Law – Pabst v. State, 466 SW 3d 902 – although the TRC requires the dealer to properly display the buyer's tag, the Court of Appeals states that this requirement also applies to the driver once the vehicle leaves the dealership.</p>
                <p><strong>Other requirements for Buyer's Temporary Tags, Per DMV Administrative Code Title 37, Part 10, Rule 215.155:</strong></p>
                <ul>
                    <li>May be displayed only on a vehicle that can be legally operated on the public streets and for which a sale has been consummated.</li>
                    <li>Valid state inspection is required (must be inspected within 180 days of tag issuance)</li>
                </ul>
                <p>Reference 503.069 – this is the general offense for improperly displayed temporary tags.</p>

                <h4>503.0631 – Buyer's Temporary Tag Database</h4>
                <p>Buyer's tags will return a vehicle and owner specific return from the RTS database.</p>
                <p><strong>Word Association:</strong> Buyer's Temporary Tag → Only One Issued → 60 days → State Inspection Required</p>

                <h4>503.068 – Limitation on Use of Dealer's License Plates and Tags</h4>
                <p>This section prescribes additional limitations on dealer license plates and temp tags.</p>
                <p>Dealer Temporary Tags – may not be operated for personal use.</p>
                <p>Metal Dealer License Plate – may not be used on a service or work vehicle and may not be used on a commercial vehicle that is carrying a load.</p>

                <h4>503.070 – Removal of Out-of-state License Plates</h4>
                <p>A dealer who purchases a vehicle that displays an out-of-state license plate must remove the plate within a reasonable time and may not operate the vehicle on a public street or highway in this state while the vehicle displays an out-of-state license plate.</p>

                <h4>503.094 – Criminal Penalty</h4>
                <p>This section describes the penalties for the offenses described in 503.067. The fine for a violation of Chapter 503 can range from $50 to $5,000 and it can be tripled if the violation was committed willfully or with conscious indifference to the law.</p>
                <ul>
                    <li>(a) Produce or reproduce a temporary tag or an item represented to be a temporary tag for the purpose of distributing the tag to someone other than a dealer or converter. State Jail Felony</li>
                    <li>(b) Operate a vehicle that displays an unauthorized temporary tag. Class C Misdemeanor</li>
                    <li>(c) A person other than a dealer or converter purchases a temporary tag. Class C Misdemeanor</li>
                    <li>(d) Sell or distribute a temporary tag or an item represented to be a temporary tag unless the person is a dealer issuing the tag in connection with the sale of a vehicle or a printer or distributor engaged in the business of selling temporary tags solely for uses authorized under this chapter. Class A Misdemeanor</li>
                </ul>

                <div class="apply-it-section" id="apply-it-16">
                    <div class="apply-it-header">
                        <span>🏷️</span> Apply It: Buyer's Tag Fraud Analysis
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You stop a vehicle displaying a buyer's tag. The tag number returns to the vehicle correctly in the RTS database. You find out the operator has owned the vehicle for several years and it can't pass inspection. He tells you he bought the tag on Facebook Marketplace for $50 from a guy who owns a car dealership.
                    </div>
                    <div class="apply-it-question">
                        What offense(s) have been committed by the vehicle operator? (Select all that apply)
                    </div>
                    <div class="apply-it-options multi-select">
                        <div class="apply-it-option" onclick="toggleMultiSelect(16, 'A', false)" data-answer="A">A. Unauthorized Production or Reproduction of Temporary Tag (SJF)</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(16, 'B', true)" data-answer="B">B. Operate Vehicle Displaying Unauthorized/Improperly Used Temporary Tag (MC)</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(16, 'C', true)" data-answer="C">C. Unauthorized Purchase of Temporary Tag (MC)</div>
                        <div class="apply-it-option" onclick="toggleMultiSelect(16, 'D', false)" data-answer="D">D. Unauthorized Sell/Distribution of Temporary Tags (MA)</div>
                    </div>
                    <div class="apply-it-submit">
                        <button onclick="checkMultiSelect(16, ['B', 'C'])">Submit Answer</button>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-16">
                        <strong>✅ Correct!</strong><br>
                        The violations are <strong>B and C</strong>.<br><br>
                        <strong>B:</strong> Operating a vehicle displaying an unauthorized temporary tag (Class C Misdemeanor) - the tag is being used improperly for an unqualified vehicle.<br>
                        <strong>C:</strong> Unauthorized purchase of temporary tag (Class C Misdemeanor) - only dealers/converters can issue tags, not sell them separately.<br><br>
                        <em><strong>Key Point:</strong> Buying temporary tags separately from vehicle sales is illegal and results in multiple violations.</em>
                    </div>
                </div>

                <h4>SECTION 1.5 – CHAPTER 504 - LICENSE PLATES</h4>
                <div class="info-box">
                    This section continues <strong>BPOC Objective 22.25</strong> - Discuss the requirement for registration of vehicles.
                </div>

                <h4>504.502 – Certain Exhibition Vehicles</h4>
                <h4>504.941 – Antique Vehicles; Offense</h4>
                <p><strong>Qualifications/Limitations:</strong></p>
                <ul>
                    <li>Vehicle at least 25 years old if a passenger car, truck, motorcycle or bus.</li>
                    <li>Vehicle is a collector's item.</li>
                    <li>Vehicle is used exclusively for exhibitions, club activities, parades, and other functions of public interest and is not used for regular transportation.</li>
                    <li>Vehicle does not carry advertising.</li>
                </ul>
                <p>License Plates Must Read: Antique Auto, Antique Truck, Antique Motorcycle, Antique Bus, or Military Vehicle (older issued plates may also read "Antique Vehicle").</p>
                <p>(h) Only one license plate is required to be displayed (on the rear of the vehicle).</p>
                <p>Reference 601.052 – These vehicles are exempt from insurance requirements.</p>
                <p>Reference 504.941 – it is an offense to use the vehicle beyond the limited scope described in this section. There is a defense to prosecution if the vehicle is being driven to/from a location for maintenance purposes.</p>
                <p><strong>DPS Arrest Title</strong> – Antique License Plate Violation</p>
                <p>Reference 548.052 – these vehicles do not require an annual inspection.</p>
                <p>Clarification: The limitations described in this section apply only to a vehicle bearing "Antique" or "Military Vehicle" license plates. These limitations do not apply to vehicles bearing "Classic", "Custom Vehicle", or "Street Rod" license plates as described in 504.501.</p>

                <div class="apply-it-section" id="apply-it-17">
                    <div class="apply-it-header">
                        <span>🏛️</span> Apply It: Antique License Plate Usage
                    </div>
                    <div class="apply-it-scenario">
                        <strong>Scenario:</strong> You stop a vehicle displaying an antique license plate. The driver explains he is running to the grocery store for milk.
                    </div>
                    <div class="apply-it-question">
                        Is he committing a violation?
                    </div>
                    <div class="apply-it-options">
                        <div class="apply-it-option" onclick="selectApplyItAnswer(17, 'yes', true, event)" data-answer="yes">YES</div>
                        <div class="apply-it-option" onclick="selectApplyItAnswer(17, 'no', false, event)" data-answer="no">NO</div>
                    </div>
                    <div class="apply-it-feedback" id="feedback-apply-it-17">
                        <strong>✅ Correct!</strong><br>
                        The answer is <strong>"YES"</strong>. This is a violation of <strong>Antique License Plate Violation</strong>.<br><br>
                        Antique vehicles must be used exclusively for exhibitions, club activities, parades, and other functions of public interest - not for regular transportation like grocery shopping.<br><br>
                        <em><strong>Key Point:</strong> Antique plates have strict usage limitations and cannot be used for daily errands.</em>
                    </div>
                </div>

                <h4>504.901 – Transfer and Removal of License Plates</h4>
                <p>Upon sale or transfer of a motor vehicle, dealerships are required to remove old license plates when selling a vehicle.</p>
                <p>For private sales, the previous owner may but is not required to remove the license plates.</p>

                <h4>504.943 – Operation of Vehicle Without License Plate</h4>
                <p>This section requires license plates to be displayed in a manner that "complies with department rules regarding the placement of license plates." This means the license plate must be displayed in accordance with DMV administrative rules in DMV Administrative Code, Title 43, Part 10, Rule 217.27(b).</p>
                <p><strong>A vehicle issued two license plates must display the plates:</strong></p>
                <ul>
                    <li>In a manner that is clearly visible, readable, and legible</li>
                    <li>One at the exterior front and one at the exterior rear</li>
                    <li>In an upright horizontal position</li>
                    <li>Not less than 12" from the ground measuring from the bottom of the plates</li>
                </ul>
                <p><strong>A vehicle issued one license plate (road tractor, MC, trailer, semitrailer) must display the plate:</strong></p>
                <ul>
                    <li>As close as practical to the exterior rear of the vehicle</li>
                    <li>Not less than 12" from the ground from the bottom of the plate</li>
                </ul>
                <p>Note: There is no requirement for the plate to be displayed in an upright horizontal position for these vehicles. The plate is also not required to be "at" the exterior rear. Just "as close as practical" to the exterior rear. A trailer or motorcycle with the license plate displayed vertically would not be in violation of this section as long as the plate is not less than 12" from the ground.</p>
                <div class="warning-box">
                    <strong>DPS Arrest Titles:</strong><br>
                    • Improperly Placed/Illegible/Unreadable License Plate<br>
                    • Operate Motor Vehicle without License Plates or with One Plate
                </div>

                <div class="apply-it-section">
                    <div class="apply-it-header">
                        <span>🚗</span> Apply It: License Plate Placement Analysis
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <h4>Scenario 1: Highway Vehicle Analysis</h4>
                            <p>You see this vehicle pass you on the highway. Is the operator committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement1', 'no', 'Correct! Without being able to see the actual license plate placement, we cannot determine if there\'s a violation.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement1', 'no', 'Correct! Without being able to see the actual license plate placement, we cannot determine if there\'s a violation.')">NO</button>
                            </div>
                            <div id="licensePlacement1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement2-container" style="display: none;">
                            <h4>Scenario 2: Dirty License Plate</h4>
                            <p>You see this vehicle pass you on the highway with a dirty license plate. Is the operator committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement2', 'depends', 'Correct! It depends on whether the dirt makes the plate illegible. If the letters/numbers are obscured, it\'s a violation under 504.945.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement2', 'depends', 'Correct! It depends on whether the dirt makes the plate illegible. If the letters/numbers are obscured, it\'s a violation under 504.945.')">NO</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement2', 'depends', 'Correct! It depends on whether the dirt makes the plate illegible. If the letters/numbers are obscured, it\'s a violation under 504.945.')">DEPENDS</button>
                            </div>
                            <div id="licensePlacement2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement3-container" style="display: none;">
                            <h4>Scenario 3: License Plate on Dashboard</h4>
                            <p>You see this vehicle pass you on the highway with the license plate on the dash. Is the operator committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement3', 'yes', 'Correct! License plates must be securely fastened to the vehicle at designated locations, not placed on the dashboard.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement3', 'yes', 'Correct! License plates must be securely fastened to the vehicle at designated locations, not placed on the dashboard.')">NO</button>
                            </div>
                            <div id="licensePlacement3-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement4-container" style="display: none;">
                            <h4>Scenario 4: Missing Front Plate</h4>
                            <p>You see this vehicle pass you on the highway. It displays a Texas registration sticker and a Texas license plate on the rear, but no license plate on the front. Is the operator committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement4', 'yes', 'Correct! Texas requires license plates on both front and rear of passenger vehicles (with some exceptions).')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement4', 'yes', 'Correct! Texas requires license plates on both front and rear of passenger vehicles (with some exceptions).')">NO</button>
                            </div>
                            <div id="licensePlacement4-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement5-container" style="display: none;">
                            <h4>Scenario 5: Vertical Trailer Plate</h4>
                            <p>This trailer passes you with a license plate mounted vertically. Is the operator committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement5', 'no', 'Correct! Trailers and motorcycles are not required to display plates in upright horizontal position as long as they are at least 12 inches from ground.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement5', 'no', 'Correct! Trailers and motorcycles are not required to display plates in upright horizontal position as long as they are at least 12 inches from ground.')">NO</button>
                            </div>
                            <div id="licensePlacement5-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement6-container" style="display: none;">
                            <h4>Scenario 6: Height Requirement</h4>
                            <p>The bottom of this boat trailer's license plate is 11" from the roadway surface. Is this a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement6', 'yes', 'Correct! License plates must be not less than 12 inches from the ground. 11 inches violates this requirement.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement6', 'yes', 'Correct! License plates must be not less than 12 inches from the ground. 11 inches violates this requirement.')">NO</button>
                            </div>
                            <div id="licensePlacement6-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement7-container" style="display: none;">
                            <h4>Scenario 7: Fender Placement</h4>
                            <p>This trailer's license plate is displayed on the fender rather than on the rear of the vehicle. Is this a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement7', 'depends', 'Correct! For trailers, the plate must be as close as practical to the exterior rear. If the fender placement is not as close as practical to the rear, it is a violation.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswerProgressive(this, 'licensePlacement7', 'depends', 'Correct! For trailers, the plate must be as close as practical to the exterior rear. If the fender placement is not as close as practical to the rear, it is a violation.')">NO</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'licensePlacement7', 'depends', 'Correct! For trailers, the plate must be as close as practical to the exterior rear. If the fender placement is not as close as practical to the rear, it is a violation.')">DEPENDS</button>
                            </div>
                            <div id="licensePlacement7-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="licensePlacement-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Analysis Complete!</h4>
                                <p>You've successfully analyzed all license plate placement scenarios. Remember the key requirements:</p>
                                <ul>
                                    <li>🎯 <strong>Passenger vehicles:</strong> Front and rear plates required</li>
                                    <li>📏 <strong>Height:</strong> Not less than 12" from ground</li>
                                    <li>📍 <strong>Position:</strong> Securely fastened at designated locations</li>
                                    <li>🚛 <strong>Trailers:</strong> As close as practical to exterior rear</li>
                                    <li>👁️ <strong>Visibility:</strong> Must be clearly visible and legible</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>504.944 – Operation of Vehicle with Wrong License Plate</h4>
                <p>It is a violation if the vehicle has a license plate or a registration insignia attached that is issued for a different vehicle.</p>

                <h4>504.945 – Wrong, Fictitious, Altered, or Obscured License Plate</h4>
                <p>Several arrest titles are derived from 504.945.</p>

                <p><strong>Display Wrong License Plate</strong></p>
                <p>The arrest title of Display Wrong License Plate would apply to violations of 504.945(a)(1), (a)(2), and (a)(3).</p>
                <ul>
                    <li>(a)(1) – a vehicle displays a license plate issued for a different motor vehicle.</li>
                    <li>(a)(2) – a vehicle displays a license plate that is issued for the vehicle under any other law other than by the department (Texas DMV).</li>
                    <li>(a)(3) – a vehicle displays a license plate assigned for a registration period other than the registration period in effect (i.e. the vehicle has been issued new license plates for a new registration period but the owner failed to change the license plates out).</li>
                </ul>

                <p><strong>Display Fictitious License Plate</strong></p>
                <p>The arrest title of Display Fictitious License Plate would apply to violations of 504.945(a)(4). This offense is a Class B Misdemeanor.</p>

                <p><strong>Obscured License Plate</strong></p>
                <p>The arrest title of Obscured License Plate would apply to violations of 504.945(a)(5).</p>
                <p>(a)(5) – a vehicle displays a license plate that has a blurring or reflective matter that significantly impairs the readability of the name of the state in which the vehicle is registered or the letters or numbers of the license plate number at any time.</p>
                <p>Note: This arrest title should not be used for a license plate that is unreadable due to dirt or mutilation. A better fit for that situation is Improperly Placed/Illegible/Unreadable License Plate under 504.943.</p>

                <p><strong>Unauthorized Illumination Device/Sticker or Emblem on License Plate</strong></p>
                <p>The arrest title of Unauthorized Illumination Device/Sticker or Emblem on License Plate would apply to violations of 504.945(a)(6).</p>
                <p>(a)(6) – a vehicle displays a license plate that has an attached illuminated device or sticker, decal, emblem, or other insignia that is not authorized by law and that interferes with the readability of the letters or numbers of the license plate number or the name of the state in which the vehicle is registered.</p>
                <p>Note: The illuminated device, sticker, decal, emblem, or other insignia is not a violation unless it interferes with the readability of the license plate number or state name.</p>

                <p><strong>Display Unauthorized Coating or Covering on License Plate</strong></p>
                <p>The arrest title of Display Unauthorized Coating or Covering on License Plate would apply to violations of 504.945(a)(7).</p>
                <p>(a)(7) – a vehicle displays a license plate that has a coating, covering, protective substance, or other material that:</p>
                <ul>
                    <li>(A) distorts angular visibility or detectability;</li>
                    <li>(B) alters or obscures one-half or more of the name of the state in which the vehicle is registered; or</li>
                    <li>(C) alters, covers, or obscures the letters or numbers of the license plate number or the color of the plate.</li>
                </ul>
                <p>Numerous courts have held that this section can be applied to a license plate bracket as long as the bracket obscures the license plate in the manner described (Martinez v. State, 500 SW 3d 456; Czerwinski v. State, Texas Court of Appeals, 13th Dist., 2018).</p>
                <p>This section would also apply to clear or tinted license plate covers. A change in the language of this section during the 88th Legislative Session (HB 2195) makes it an offense to "alter, cover, or obscure" the letters or numbers of a license plate. A third or subsequent conviction for violating (a)(7)(C) is a Class B Misdemeanor (altering, covering, or obscuring the letters/numbers or color of the license plate).</p>

                <div class="apply-it-section">
                    <div class="apply-it-header">
                        <span>🔧</span> Apply It: License Plate Bracket Analysis
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <h4>Scenario 1: First License Plate Bracket</h4>
                            <p>Is this license plate bracket a violation of the law?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket1', 'depends', 'Correct! It depends on whether the bracket distorts angular visibility, alters/obscures half or more of the state name, or alters/covers/obscures the letters/numbers or color of the plate.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket1', 'depends', 'Correct! It depends on whether the bracket distorts angular visibility, alters/obscures half or more of the state name, or alters/covers/obscures the letters/numbers or color of the plate.')">NO</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket1', 'depends', 'Correct! It depends on whether the bracket distorts angular visibility, alters/obscures half or more of the state name, or alters/covers/obscures the letters/numbers or color of the plate.')">DEPENDS</button>
                            </div>
                            <div id="plateBracket1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="plateBracket2-container" style="display: none;">
                            <h4>Scenario 2: Second License Plate Bracket</h4>
                            <p>Is this license plate bracket a violation of the law?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket2', 'depends', 'Correct! Again, it depends on the specific impact of the bracket. Courts have held that 504.945(a)(7) can apply to license plate brackets if they obscure the plate in the manner described in the statute.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket2', 'depends', 'Correct! Again, it depends on the specific impact of the bracket. Courts have held that 504.945(a)(7) can apply to license plate brackets if they obscure the plate in the manner described in the statute.')">NO</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'plateBracket2', 'depends', 'Correct! Again, it depends on the specific impact of the bracket. Courts have held that 504.945(a)(7) can apply to license plate brackets if they obscure the plate in the manner described in the statute.')">DEPENDS</button>
                            </div>
                            <div id="plateBracket2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="plateBracket-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Analysis Complete!</h4>
                                <p>You've successfully analyzed license plate bracket scenarios. Remember the key violations under 504.945(a)(7):</p>
                                <ul>
                                    <li>👁️ <strong>Angular visibility:</strong> Distorts angular visibility or detectability</li>
                                    <li>🗺️ <strong>State name:</strong> Alters or obscures half or more of the state name</li>
                                    <li>🔤 <strong>Letters/numbers:</strong> Alters, covers, or obscures letters/numbers</li>
                                    <li>🎨 <strong>Color:</strong> Alters, covers, or obscures the color of the plate</li>
                                    <li>⚖️ <strong>Court precedent:</strong> Brackets can violate the law if they meet these criteria</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <p><strong>Enhancement</strong> – Any of the above discussed violations of 504.945 can be enhanced to a Class B Misdemeanor if it is shown on the trial of the offense that the person knowingly altered or made illegible the letters, numbers, and other identification marks on their license plate.</p>

                <p><strong>Exceptions for Obscured/Obstructed/Illegible License Plates:</strong></p>
                <p>There are numerous exceptions for items that may obstruct the license plate but do not constitute an offense under 504.945. These exceptions are described in 504.945(c).</p>
                <p><strong>There is no violation if license plate is obstructed by:</strong></p>
                <ol>
                    <li>a trailer hitch installed on a vehicle in a normal or customary manner.</li>
                    <li>a tollway transponder attached to the vehicle in the manner required by the issuing authority.</li>
                    <li>a wheelchair lift or wheelchair carrier attached to the vehicle in a normal or customary manner.</li>
                    <li>a trailer being towed by a vehicle.</li>
                    <li>a bicycle or motorcycle rack that is attached to a vehicle in a normal or customary manner.</li>
                </ol>

                <h4>504.946 – Deceptively Similar License Plate</h4>
                <p>A deceptively similar license plate is a license plate that was not issued by DMV but a reasonable person would presume it was issued by DMV. These license plates typically bear the correct state and license plate number assigned to that vehicle.</p>
                <p>If the vehicle is displaying a license plate that is fraudulent and the registration return comes back with no return or registered to a different vehicle, enforcement is better taken for displaying a fictitious license plate under 504.945 (Class B Misdemeanor).</p>
                <p>Displaying a Deceptively Similar License Plate is a Class C Misdemeanor.</p>
                <p>Displaying a Deceptively Similar License Plate with previous convictions is a Class B Misdemeanor.</p>
                <p>Manufacturing or Selling a Deceptively Similar License Plate is a 3rd Degree Felony.</p>
                <p>Due to the large number of personalized and specialty license plates, it can be difficult for officers to determine whether or not a license plate was issued by DMV or not. The registration return for the vehicle should show the type of license plates issued for a vehicle.</p>

                <div class="apply-it-section">
                    <div class="apply-it-header">
                        <span>🕵️</span> Apply It: Deceptively Similar License Plate Analysis
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <h4>Scenario 1: European Style Front Plate</h4>
                            <p>You stop this vehicle. It is displaying a normal license plate on the rear, but a European style license plate on the front:</p>
                            <p><strong>Rear License Plate:</strong> DMV issued<br>
                            <strong>Front License Plate:</strong> Not issued by DMV</p>
                            <p>Vehicle Registration Return: [Normal registration information]</p>
                            <p>Is the operator of this vehicle committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'deceptivePlate1', 'depends', 'Correct! If the European style plate is deceptively similar (looks like it could be DMV issued), it could be a violation under 504.946. If it is clearly not DMV issued, it may violate other provisions requiring proper license plates.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'deceptivePlate1', 'depends', 'Correct! If the European style plate is deceptively similar (looks like it could be DMV issued), it could be a violation under 504.946. If it is clearly not DMV issued, it may violate other provisions requiring proper license plates.')">NO</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'deceptivePlate1', 'depends', 'Correct! If the European style plate is deceptively similar (looks like it could be DMV issued), it could be a violation under 504.946. If it is clearly not DMV issued, it may violate other provisions requiring proper license plates.')">DEPENDS</button>
                            </div>
                            <div id="deceptivePlate1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="deceptivePlate2-container" style="display: none;">
                            <h4>Scenario 2: Unknown License Plate</h4>
                            <p>You stop this vehicle. You have never seen this license plate before.</p>
                            <p>Vehicle Registration Return: [Shows this specific plate type and number are properly registered to this vehicle]</p>
                            <p>Is the operator of this vehicle committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'deceptivePlate2', 'no', 'Correct! If the registration return shows this plate type and number are properly registered to this vehicle, then it is a legitimate DMV-issued plate, even if you have not seen this specialty/personalized plate design before.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'deceptivePlate2', 'no', 'Correct! If the registration return shows this plate type and number are properly registered to this vehicle, then it is a legitimate DMV-issued plate, even if you have not seen this specialty/personalized plate design before.')">NO</button>
                            </div>
                            <div id="deceptivePlate2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="deceptivePlate-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Analysis Complete!</h4>
                                <p>You've successfully analyzed deceptively similar license plate scenarios. Remember:</p>
                                <ul>
                                    <li>🔍 <strong>Deceptively Similar:</strong> Not issued by DMV but appears to be DMV issued</li>
                                    <li>📋 <strong>Registration Check:</strong> Registration return shows plate type issued</li>
                                    <li>⚖️ <strong>Penalties:</strong> Class C (first), Class B (repeat), 3rd Degree Felony (manufacturing/selling)</li>
                                    <li>🚫 <strong>Fictitious:</strong> If no return or wrong vehicle, charge fictitious plate (Class B)</li>
                                    <li>🎨 <strong>Specialty Plates:</strong> Many legitimate designs exist - check registration return</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>504.9465 – License Plate Flipper</h4>
                <p>Note this violation must be committed with "criminal negligence". This culpable mental state is defined in Penal Code 6.03.</p>
                <p>Some vehicles were manufactured with a license plate that flips down to access the gas tank – this is not a violation.</p>
                <p>Enforcement action for purchasing or possessing a license plate flipper should only be taken when the person is acting with criminal negligence to switch between plates or to hide the license plate.</p>
                <p>Purchasing or possessing a license plate flipper is a Class B Misdemeanor.</p>
                <p>Selling or distributing a license plate flipper is a Class A Misdemeanor.</p>

                <div class="quiz-section">
                    <div class="quiz-header">
                        <h4>📝 MODULE 1 INTERACTIVE REVIEW QUIZ</h4>
                        <p>Test your knowledge with this interactive quiz. Select your answers and get instant feedback!</p>
                        <div class="quiz-progress">
                            <div class="quiz-progress-bar" id="quizProgressBar"></div>
                            <span class="quiz-progress-text" id="quizProgressText">0 of 15 questions answered</span>
                        </div>
                    </div>

                    <div class="quiz-container" id="quizContainer">
                        <!-- Questions will be inserted here by JavaScript -->
                    </div>

                    <div class="quiz-results" id="quizResults" style="display: none;">
                        <div class="results-header">
                            <h4>🎉 Quiz Complete!</h4>
                            <div class="score-display" id="scoreDisplay"></div>
                        </div>
                        <div class="results-breakdown" id="resultsBreakdown"></div>
                        <div class="quiz-actions">
                            <button onclick="restartQuiz()" class="quiz-button secondary">🔄 Retake Quiz</button>
                            <button onclick="markModuleComplete(1)" class="quiz-button primary">✅ Complete Module 1</button>
                        </div>
                    </div>
                </div>

                <!-- Module 1 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button overview" onclick="showModule(0)">
                        🏠 Overview
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 1 Complete!</div>
                        <div class="progress-text">Ready for Module 2</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(2)">
                        Next: Module 2 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module2">
            <!-- Module 2 Top Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(1)">
                    ← Previous: Module 1
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 2</div>
                    <div class="progress-text">Driver's Licenses & CDL</div>
                </div>
                <button class="nav-button next" onclick="showModule(3)">
                    Next: Module 3 →
                </button>
            </div>

            <div class="content-section">
                <h3>MODULE 2 – TRC CHAPTERS 521 - 522</h3>
                
                <h4>SECTION 2.1 – CHAPTER 521 - DRIVER'S LICENSES AND CERTIFICATES</h4>
                <div class="info-box">
                    <strong>BPOC Objective 22.7</strong> - Identify who may and who may not be licensed to drive in the state of Texas, and the types and classes of licenses that exist under Texas statutes and understand the restrictions thereon.
                </div>

                <h4>521.001 – Definitions</h4>
                <p><strong>(3) Driver License</strong> – an authorization issued by the department for the operation of a motor vehicle.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> A driver license is more than just a physical piece of plastic. When Chapter 521 refers to a "driver license" it is referring to a person's authorization to drive, not just to the physical card.
                </div>

                <p><strong>(4) Gross Combination Weight Rating</strong> – uses Chapter 522.003 definition – the value specified by the manufacturer as the loaded weight of a combination or articulated vehicle or, if the manufacturer has not specified a value, the sum of the gross vehicle weight rating of the power unit and the total weight of the towed unit or units and any load on a towed unit.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This is the number used to determine the class of license required to operate a combination of vehicles.
                </div>

                <p><strong>(5) Gross Vehicle Weight Rating</strong> – uses Chapter 522.003 definition – the value specified by the manufacturer as the loaded weight of a single vehicle.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> This is the number used to determine the class of license required to operate a motor vehicle.
                </div>

                <p><strong>(6) License</strong> – an authorization to operate a motor vehicle that is issued under or granted by the laws of this state. The term includes a driver's license, the privilege of a person to operate a motor vehicle regardless of whether the person holds a driver's license, and a nonresident's operating privilege.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> Again, "license" is not just a piece of plastic. It is the privilege to drive, even if someone does not have a license issued to them.
                </div>

                <p><strong>(7) Non-resident</strong> – a person who is not a resident of this state.</p>
                <p><strong>(b)</strong> A word or phrase that is not defined in this chapter but is defined in subtitle C has the meaning in this chapter that is assigned by that subtitle. This allows us to pull definitions from Subtitle C and use them for application of this chapter – this includes Chapter 541 (an entire chapter of nothing but definitions in Subtitle C).</p>

                <h4>521.021 – License Required</h4>
                <p>A person, other than a person exempted, may not operate a motor vehicle on a highway in Texas unless they hold a driver's license.</p>
                <p>The language in this section refers to a "person exempted". The list of exempted people can be found in 521.027.</p>

                <div class="info-box">
                    <p><strong>Motor Vehicle</strong> – a self-propelled vehicle or a vehicle that is propelled by electric power from overhead trolley wires. The term does not include an electric bicycle or an electric personal assistive mobility device (Segway). (Reference 541.201)</p>
                    <p><strong>Highway</strong> – the width between the boundary lines of a publicly maintained way any part of which is open to the public for vehicular travel. (Reference 541.302)</p>
                    <p><strong>Word Association:</strong> Motor Vehicle on a highway → License Required</p>
                </div>

                <h4>521.027 – Persons Exempt from License Requirement</h4>
                <p>These people are exempt from the license requirement in 521.021:</p>
                <ol>
                    <li><strong>Military personnel</strong> operating military vehicles in the scope of their military service.</li>
                    <li><strong>A person operating a road machine, farm tractor, or implement of husbandry</strong> that is not a commercial motor vehicle.</li>
                </ol>

                <div class="info-box">
                    <p><strong>Road Machinery</strong> – a self-propelled vehicle that was originally and permanently designed as machinery, is not designed or used primarily to transport persons or property, and is only incidentally operated on a highway. (Reference 547.001(5-a))</p>
                    <p><strong>Farm Tractor</strong> – a motor vehicle designed and used primarily as a farm implement to draw an implement of husbandry, including a plow or a mowing machine. (Reference 541.201)</p>
                    <p><strong>Implement of Husbandry</strong> – (A) a vehicle, other than a passenger car or truck, that is designed and adapted for use as a farm implement, machinery, or tool for tilling the soil; (B) a towed vehicle that transports to the field and spreads fertilizer or agricultural chemicals; or (C) a motor vehicle designed and adapted to deliver feed to livestock. (Reference 541.201)</p>
                </div>

                <ol start="3">
                    <li><strong>Non-resident active military personnel</strong> licensed in another state or Canada. Note: they must have a license in their home state.</li>
                    <li><strong>A spouse or dependent</strong> of #3 above who is licensed in their home state.</li>
                </ol>

                <div class="apply-it-section" id="apply-it-18">
                    <div class="apply-it-header">
                        <span>🛴</span> Apply It: Segway License Requirement
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>You observe the operator of this Segway disregard a stop sign so you conduct a traffic stop. You find that the operator does not have a driver's license. Is the operator committing a violation for operating a motor vehicle on a highway without a driver's license?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'segway1', 'no', 'Correct! A Segway is an electric personal assistive mobility device and is NOT considered a motor vehicle under 541.201.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'segway1', 'no', 'Correct! A Segway is an electric personal assistive mobility device and is NOT considered a motor vehicle under 541.201.')">NO</button>
                            </div>
                            <div id="segway1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="segway2-container" style="display: none;">
                            <p>Why or why not?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Enter your explanation..." onblur="checkFillBlank(this, 'Segway is not a motor vehicle', 'segway', 'explanation')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Segway is not a motor vehicle', 'segway', 'explanation')">
                            
                            <div class="scenario-question" id="segway-complete" style="display: none;">
                                <div class="completion-message">
                                    <h4>✅ Analysis Complete!</h4>
                                    <p>Remember: Electric personal assistive mobility devices (Segways) are specifically excluded from the definition of "motor vehicle" in 541.201, so no driver's license is required.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="apply-it-section" id="apply-it-19">
                    <div class="apply-it-header">
                        <span>🚜</span> Apply It: Unlicensed Farm Equipment Operator
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>You are working a crash where this combine collided with another vehicle as it was being operated on the highway. During your investigation, you determine the combine is being operated by an unlicensed 15 year-old. Is the operator of the combine committing a violation for operating a motor vehicle on the highway with no driver's license?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'combine1', 'no', 'Correct! A combine is an implement of husbandry and the operator is exempt from license requirements under 521.027(2).')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'combine1', 'no', 'Correct! A combine is an implement of husbandry and the operator is exempt from license requirements under 521.027(2).')">NO</button>
                            </div>
                            <div id="combine1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="combine-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Analysis Complete!</h4>
                                <p>Farm equipment operators are exempt from license requirements when operating implements of husbandry, regardless of age (though other safety considerations may apply).</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.025 – License to be Carried and Exhibited on Demand; Criminal Penalty</h4>
                <p>A person is required to hold the correct class of license for the vehicle being operated and is required to display the license upon the demand of a magistrate, court officer, or peace officer. Failure to display the license as required is the offense of <strong>Fail to Display Driver License</strong>. Having the wrong class of license for the vehicle is the offense of <strong>Improper Driver License for Type of Vehicle</strong>.</p>

                <div class="apply-it-section">
                    <div class="apply-it-header">Apply It: Driver License Enforcement</div>
                    <div class="apply-it-scenario">
                        <p>Officer Thompson is considering conducting a traffic stop solely to check if a driver has a valid license, without any other traffic violation or reasonable suspicion.</p>
                    </div>
                    <div class="apply-it-question">
                        <p>What is the correct enforcement approach according to Department policy?</p>
                        <div class="apply-it-options">
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">Proceed with the stop - TRC 521.025(b) authorizes it</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, true)">
                                <div class="option-text">Do not make the stop - only authorized at approved checkpoints</div>
                            </div>
                            <div class="apply-it-option" onclick="checkApplyIt(this, false)">
                                <div class="option-text">Make the stop but only ask for license, don't detain</div>
                            </div>
                        </div>
                    </div>
                    <div class="apply-it-feedback">
                        <p><strong>Correct!</strong> Department policy prohibits suspicionless stops to check for driver's licenses except in approved checkpoint situations.</p>
                        <p><strong>Important Legal Context:</strong></p>
                        <ul>
                            <li>While TRC 521.025(b) technically allows such stops, they must comply with 4th Amendment requirements</li>
                            <li>Case Law (State v. Luxon): Suspicionless stops require sanctioned checkpoint situations</li>
                            <li>Department policy restricts such stops to approved checkpoints only</li>
                            <li>Reference: Chapter 4 of the THP manual for checkpoint procedures</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box">
                    <strong>Case Law – State v. Luxon</strong> – a suspicionless stop as described in this section is still subject to 4th Amendment analysis and is only permissible when carried out in a very specific manner (sanctioned checkpoint situations that are compliant with Supreme Court reasonableness tests).
                </div>

                <p><strong>Enhancements for subsequent convictions committed within one year:</strong></p>
                <ul>
                    <li>2nd offense increases the fine</li>
                    <li>3rd or subsequent offense is a Class B Misdemeanor</li>
                    <li>Enhancement for having the wrong class of license or failing to display a license while operating without financial responsibility and causing a crash resulting in serious bodily injury or death is a Class A misdemeanor</li>
                </ul>

                <h4>521.026 – Dismissal of Expired Driver License Charge</h4>
                <p>A judge MAY dismiss an expired license charge if the license is renewed within 20 working days/before the first court appearance.</p>
                <p>There is no statutory requirement to dismiss – this is at the judge's discretion.</p>

                <h4>521.028 – Effect of Military Service on License Requirement</h4>
                <p>If military personnel licensed in Texas are absent from this state when their license expires, the license is considered to remain valid until they return to this state.</p>

                <h4>521.029 – Operation of Motor Vehicle by New State Residents</h4>
                <p>New residents have <strong>90 days</strong> to obtain a Texas license as long as they are 16 years of age or older and have in the person's possession a driver's license issued by their previous state of residence.</p>
                <p><strong>Word Association:</strong> New Resident → Driver License → 16 yrs of age or older and 90 days</p>

                <div class="apply-it-section" id="apply-it-20">
                    <div class="apply-it-header">
                        <span>🏠</span> Apply It: New Resident License Requirements
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>You conduct a traffic stop. The driver is not able to produce a driver's license, however he explains he just moved to Texas a week ago and he will be getting a Texas driver's license in the next few weeks. Is the driver committing a violation for operating a motor vehicle with no driver's license?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'newresident1', 'yes', 'Correct! The driver must have their out-of-state license in possession to qualify for the 90-day grace period. Without any license, they are in violation.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'newresident1', 'yes', 'Correct! The driver must have their out-of-state license in possession to qualify for the 90-day grace period. Without any license, they are in violation.')">NO</button>
                            </div>
                            <div id="newresident1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="newresident-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Analysis Complete!</h4>
                                <p>New residents get 90 days to obtain a Texas license, but they must have their valid out-of-state license in possession during this period.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.042 – Collision and Conviction Reports; Individual Records</h4>
                <p>This section establishes Texas driving history for crashes and traffic offenses. This allows for accountability when the department is considering renewal of a license.</p>
                <p><strong>(c)</strong> Police, fire or EMS involved in on duty crashes will not have the crash reported on their Texas driving history if they did not cause the crash or if the crash did not cause more than $1000 in damage.</p>

                <h4>521.054 – Notice of Change of Address or Name</h4>
                <p>A person who moves to a new address or changes their name must notify the Department to update their license within <strong>30 days</strong>.</p>
                <p>A person who had an alternate address on their license for security purposes because they were a state or federal judge (521.121(c)) must report their correct address within 30 days if they cease to be a judge.</p>
                <p><strong>Word Association:</strong> New Name or Address → Driver License → 30 days</p>

                <h4>521.060 – Emergency Contact & Medical Information Database</h4>
                <p>The Department keeps emergency contact on record for emergency situations and also maintains information reported on the driver license application regarding conditions that could impair communication with law enforcement.</p>
                <p>This information is confidential and may only be disclosed to peace officers for the purposes on making death notification or determining if someone has medical conditions that could impair communication.</p>
                <p>The department is required to allow this information to be changed and updated via its website.</p>

                <h4>Classification of Driver's Licenses</h4>
                <div class="info-box">
                    <p><strong>Important:</strong> The weight used to determine class of license is the Gross Vehicle Weight Rating or Gross Combination Weight Rating. Do not base class of license determination on registered weight or gross weight (actual weight).</p>
                    <p>The Gross Vehicle Weight Rating is set by the manufacturer and can be found on the vehicle's VIN sticker.</p>
                </div>

                <div class="highlight-box">
                    <strong>Enforcement Application:</strong> Many larger vehicles require a Commercial Driver's License to operate, however there are numerous exemptions from the Commercial Driver's License requirement. These exemptions can be found in TRC 522.004 and include recreational vehicles, vehicles operated for personal use (not in commerce), emergency vehicles, and certain covered farm vehicles. While the operator of a one of these vehicles is exempt from CDL requirements, if the vehicle is large enough an elevated class of license is required.
                </div>

                <h4>521.081 – Class A License</h4>
                <p><strong>Class A is required to drive:</strong></p>
                <ul>
                    <li>A combination of vehicles with a GCWR of 26,001 pounds or more provided the GVWR of the vehicle(s) in tow is in excess of 10,000 pounds.</li>
                </ul>
                <p><strong>Word Association:</strong> Class A License → Combination over 26,000 AND Towed Unit over 10,000</p>

                <h4>521.082 – Class B License</h4>
                <p><strong>Class B is required to drive:</strong></p>
                <ul>
                    <li>Single vehicle with a GVWR of 26,001 pounds or more.</li>
                    <li>Vehicle with a GVWR of 26,001 pounds or more that is towing a vehicle with a GVWR that does not exceed 10,000 pounds or a farm trailer with a GVWR that does not exceed 20,000 pounds.</li>
                    <li>A bus with a seating capacity of 24 passengers or more including the driver.</li>
                </ul>

                <h4>521.083 – Class C License</h4>
                <p><strong>Class C authorizes an individual to drive:</strong></p>
                <ul>
                    <li>Single vehicle or combination of vehicles that are not included in Class A or B.</li>
                    <li>Vehicle with a GVWR of less than 26,001 pounds towing a trailer with a GVWR that does not exceed 10,000 pounds.</li>
                    <li>Vehicle with a GVWR of less than 26,001 pounds towing a farm trailer with a GVWR that does not exceed 20,000 pounds.</li>
                    <li>Vehicle designed to transport 23 or fewer passengers including the driver</li>
                </ul>

                <h4>521.084 – Class M License</h4>
                <p><strong>Class M is required to drive a motorcycle.</strong></p>

                <div class="info-box">
                    <h4>Class of Driver's License Rules to Live By</h4>
                    <p><strong>If you are looking at a Single Unit (not in combination):</strong></p>
                    <ul>
                        <li>Class A is NEVER required.</li>
                        <li>GVWR 26,001 lbs. or more – Class B</li>
                        <li>Bus with seating capacity of 24 or more – Class B</li>
                        <li>Everything else – Class C</li>
                    </ul>
                    
                    <p><strong>If you are looking at a Combination Unit:</strong></p>
                    <ul>
                        <li>Start with the trailer.
                            <ul>
                                <li>Trailer GVWR 10,000 lbs. or less – pretend the trailer does not exist. Treat like the power unit is operating alone.</li>
                                <li>Farm Trailer GVWR 20,000 lbs. or less – pretend the trailer does not exist. Treat like the power unit is operating alone.</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <p><strong>To require a Class A License, all three must be present:</strong></p>
                    <ul>
                        <li>MUST be a combination.</li>
                        <li>Trailer's GVWR must be more than 10,000 lbs. (20,000 if it is a farm trailer).</li>
                        <li>The combination weight rating must be more than 26,000 lbs.</li>
                    </ul>
                </div>

                <div class="apply-it-section" id="apply-it-21">
                    <div class="apply-it-header">
                        <span>🚛</span> Apply It: License Class Determination
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <h4>Scenario 1: Light Combination</h4>
                            <p>Power Unit GVWR: 10,000 lbs | Trailer GVWR: 17,000 lbs | GCWR: 27,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class C', 'license1', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class C', 'license1', 'class')">
                        </div>

                        <div class="scenario-question" id="license2-container" style="display: none;">
                            <h4>Scenario 2: Heavy Power Unit</h4>
                            <p>Power Unit GVWR: 18,000 lbs | Trailer GVWR: 9,000 lbs | GCWR: 27,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class C', 'license2', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class C', 'license2', 'class')">
                        </div>

                        <div class="scenario-question" id="license3-container" style="display: none;">
                            <h4>Scenario 3: Class A Combination</h4>
                            <p>Power Unit GVWR: 16,000 lbs | Trailer GVWR: 11,000 lbs | GCWR: 27,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A', 'license3', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A', 'license3', 'class')">
                        </div>

                        <div class="scenario-question" id="license4-container" style="display: none;">
                            <h4>Scenario 4: Class B Single Unit</h4>
                            <p>Power Unit GVWR: 28,000 lbs | Trailer GVWR: 10,000 lbs | GCWR: 38,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class B', 'license4', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class B', 'license4', 'class')">
                        </div>

                        <div class="scenario-question" id="license5-container" style="display: none;">
                            <h4>Scenario 5: Class A Heavy Combination</h4>
                            <p>Power Unit GVWR: 20,000 lbs | Trailer GVWR: 10,001 lbs | GCWR: 30,001 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A', 'license5', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A', 'license5', 'class')">
                        </div>

                        <div class="scenario-question" id="license6-container" style="display: none;">
                            <h4>Scenario 6: Farm Trailer Exception</h4>
                            <p>Power Unit GVWR: 25,000 lbs | Farm Trailer GVWR: 21,000 lbs | GCWR: 46,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A', 'license6', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A', 'license6', 'class')">
                        </div>

                        <div class="scenario-question" id="license7-container" style="display: none;">
                            <h4>Scenario 7: Farm Trailer Under Limit</h4>
                            <p>Power Unit GVWR: 25,000 lbs | Farm Trailer GVWR: 20,000 lbs | GCWR: 45,000 lbs</p>
                            <p>What class of license is required to operate this vehicle?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class C', 'license7', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class C', 'license7', 'class')">
                        </div>

                        <div class="scenario-question" id="license-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ License Classification Complete!</h4>
                                <p>Remember the key rules:</p>
                                <ul>
                                    <li>🚛 <strong>Class A:</strong> Combination >26K AND trailer >10K (20K for farm)</li>
                                    <li>🚌 <strong>Class B:</strong> Single unit >26K OR bus ≥24 passengers</li>
                                    <li>🚗 <strong>Class C:</strong> Everything else</li>
                                    <li>🏍️ <strong>Class M:</strong> Motorcycles (separate requirement)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.085 – Type of Vehicle Authorized</h4>
                <p>If a person holds an elevated class of license, they can also drive the vehicles described for the lesser classes of licenses EXCEPT motorcycles. You will always have to have a class M license for most motorcycles.</p>
                <p><strong>(b)</strong> An autocycle can be operated without a Class M License.</p>
                <p>The specific type of motorcycle defined in 521.001(a)(6-a) can also be operated without a class M license:</p>

                <div class="info-box">
                    <strong>Motorcycle Exception:</strong> An enclosed three-wheeled passenger vehicle with a steering wheel, seat belts, a windshield and one or more windshield wipers, and a certified vehicle structure. For a more detailed definition, see 521.001(a)(6-a).
                </div>

                <!-- Additional Chapter 521 Content -->
                <h4>521.101 – Personal Identification Certificate</h4>
                <p>Personal Identification Certificate is a Texas ID card. It looks similar to a driver's license, however it is distinguishable from a license.</p>
                
                <div class="info-box">
                    <p><strong>Visual Differences:</strong></p>
                    <p>🆔 <strong>Texas Driver License</strong> vs 🆔 <strong>Texas Personal Identification Certificate</strong></p>
                    <p>If the person is under 21, the ID card will clearly indicate this status on the face of the card.</p>
                </div>

                <p><strong>(f-2)</strong> Gives non-citizens an avenue to get an ID card as long as they are legally in the US at the time of application.</p>

                <h4>521.144 – Application by New State Resident</h4>
                <p>New residents must show that they've already registered their vehicles in Texas prior to obtaining a Texas license or sign an affidavit that they do not own a motor vehicle that is required to be registered.</p>
                <div class="highlight-box">
                    <strong>Remember:</strong> A new state resident has 30 days to register vehicles and 90 days to obtain a Texas license.
                </div>

                <h4>521.183 - Surrender of DL or Personal ID Certificate</h4>
                <p>If a person holding an ID card requests a driver's license, they must surrender their ID card to the Department.</p>
                <p>If a person holding a driver's license requests an ID card, they must surrender their DL to the Department.</p>
                <div class="info-box">
                    <strong>Important Note:</strong> This is Department procedural guidance when issuing cards. It is NOT a violation of Texas law to possess both at the same time (i.e. an officer notices both in a person's wallet while on a traffic stop).
                </div>

                <h4>521.201 – License Ineligibility in General</h4>
                <p>This section essentially provides a list of qualifications for obtaining a Texas license and things that will disqualify a person from getting a license.</p>
                <p>The department may not issue any license to a person who:</p>
                <ol>
                    <li>is under 15 years of age</li>
                    <li>is under 18 years of age unless the person complies with the requirements imposed by Section 521.204 (driver's education, currently school enrollment, parental consent)</li>
                    <li>is shown to be addicted to the use of alcohol, a controlled substance, or another drug that renders a person incapable of driving</li>
                    <li>holds a driver's license that is revoked, canceled, or under suspension</li>
                    <li>has been determined by a judgment of a court to be totally incapacitated or incapacitated to act as the operator of a motor vehicle</li>
                    <li>the department determines to be afflicted with a mental or physical disability or disease that prevents the person from exercising reasonable and ordinary control over a motor vehicle</li>
                    <li>has been reported by a court under Section 521.3452 for failure to appear (offenses committed by a minor)</li>
                    <li>has been reported by a court for failure to appear or default in payment of a fine for a misdemeanor that is not covered under Subdivision (7)</li>
                </ol>

                <div class="info-box">
                    <strong>Word Association:</strong> Minimum Age → Texas Driver License → 15 YOA
                </div>

                <h4>521.222 – Learner License</h4>
                <p>A learner license is also often called an "Instruction Permit".</p>
                <p><strong>(a)(1)</strong> Only issued to a person who is 15, 16, or 17 years of age.</p>
                <p><strong>(a)(2)-(4)</strong> To obtain a learner license, the person must:</p>
                <ul>
                    <li>Complete the classroom portion of driver's education</li>
                    <li>Be enrolled in school or already graduated</li>
                    <li>Have passed a written exam</li>
                </ul>
                <p><strong>(d)</strong> This section establishes the requirement for a licensed operator at least 21 years of age to be in the front seat monitoring the learner license holder's driving. This person must have at least 1 year of driving experience.</p>
                <p><strong>(g)</strong> The licensed operator in the front seat must be awake and alert. Under (g) this person commits a violation if they sleep, are intoxicated, or are otherwise engaged in activities that prevent proper supervision.</p>

                <h4>521.223 – Hardship License</h4>
                <p>This section establishes the requirements to obtain a Hardship License.</p>
                <p>To qualify for a hardship license, the department must find that one of these three conditions exists:</p>
                <ol>
                    <li>the failure to issue the license will result in an unusual economic hardship for the family;</li>
                    <li>the license is necessary because of the illness of a member of the applicant's family; or</li>
                    <li>the license is necessary because the applicant is enrolled in a vocational education program and requires a driver's license to participate in the program.</li>
                </ol>
                <p>Applicants must be at least 15 years old, must passed driver's education, and must pass examinations described in 521.161. This is the earliest age a person may obtain a Texas driver's license.</p>

                <h4>521.224 – Restricted Class M License</h4>
                <p>This license is only issued to a person 15, 16, or 17 years of age.</p>
                <p>It allows the operation of a motorcycle with a displacement of 250 CCs or less.</p>
                <p>The person must have passed the motorcycle safety course and received parental consent.</p>

                <!-- Occupational License Section -->
                <h4>Occupational License</h4>
                <p>An occupational license can be issued to a person after their normal driver's license has been suspended or revoked. The person must meet specific requirements and the occupational license will generally be heavily restricted to driving activities necessary for home or work.</p>

                <h4>521.241 – Definitions</h4>
                <p><strong>(1) Essential need</strong> – a need of a person for the operation of a motor vehicle:</p>
                <ul>
                    <li>A. in the performance of an occupation or trade or for transportation to and from the place at which the person practices the person's occupation or trade;</li>
                    <li>B. in the pursuit of an occupation or trade;</li>
                    <li>C. for transportation to and from an educational facility in which the person is enrolled; or</li>
                    <li>D. in the performance of essential household duties.</li>
                </ul>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> Before getting an occupational license, a person must convince a judge that they have an "essential need" to drive.
                </div>

                <p><strong>(2) Ignition interlock device</strong> – a device that uses a deep-lung breath analysis mechanism to make impractical the operation of a motor vehicle if ethyl alcohol is detected in the breath of the operator of the vehicle.</p>
                <div class="highlight-box">
                    <strong>Why is this Important?</strong> Many occupational licenses are restricted to operating only a vehicle with an ignition interlock device installed.
                </div>

                <h4>521.2421 – Petition</h4>
                <p>The petition starts the occupational license process and sets forth the person's essential need to drive.</p>
                <p><strong>Where is the petition filed?</strong></p>
                <ul>
                    <li>If the license is suspended due to DWI or certain other offenses described in Subchapters O or P, the petition must be filed with the court in which the person was convicted.</li>
                    <li>Otherwise, the petition can be filed with a court where the driver lives or where the offense that caused the suspension occurred.</li>
                </ul>
                <p>Once a petition is filed, the judge reviews the petition and decides whether or not the person has an essential need to drive. If the judge finds there is an essential need, he or she issues a court order granting the occupational license.</p>

                <h4>521.248 – Order Requirements</h4>
                <p>The court order granting an occupational license sets forth restrictions on the person's driving. Restrictions can consist of:</p>
                <ol>
                    <li>Time of day or days of the week a person may drive</li>
                    <li>The reasons for which a person may drive</li>
                    <li>Areas or routes permitted</li>
                    <li>Ignition interlock device requirement, if applicable</li>
                    <li>Periodic drug or alcohol testing, if applicable</li>
                </ol>
                <p>If an ignition interlock device is required, the person should not be subject to other time of day or location of travel restrictions.</p>
                <p><strong>(d)</strong> The order serves as the occupational license for 45 days once it is granted (521.249). After 45 days, the driver should have completed the rest of the process to obtain the actual occupational license.</p>

                <div class="info-box">
                    <p><strong>Reference 521.250</strong> – the driver must carry a certified copy of this court order while using the occupational license.</p>
                    <p><strong>Reference 521.253</strong> – it is a Class B Misdemeanor to violate one of the restrictions listed on the court order.</p>
                </div>

                <h4>521.249 – Notice to Department; Issuance of Occupational License</h4>
                <p>DPS gets a copy of the court order granting an occupational license from the court.</p>
                <p>Before actually obtaining an occupational license, the person must show proof of Chapter 601 compliance (proof of financial responsibility, form SR-22). Once the applicant has provided proof of financial responsibility, the Department issues an occupational license.</p>

                <div class="info-box">
                    <h5>📋 Occupational License Summary</h5>
                    <p>There are multiple steps to obtaining an Occupational License. They are summarized below:</p>
                    <ol>
                        <li><strong>Petition</strong> – the driver sets forth an essential need to drive.</li>
                        <li><strong>Hearing</strong> – the judge decides if an essential need exists.</li>
                        <li><strong>Court Order</strong> – the judge grants occupational license and sets forth restrictions.</li>
                        <li><strong>601 compliance</strong> – the driver provides proof to DPS that they have insurance (SR-22).</li>
                        <li><strong>Occupational License</strong> – The department issues an occupational license.</li>
                    </ol>
                </div>

                <h4>521.250 – Court Order in Operator's Possession</h4>
                <p>A person driving on an Occupational License must have a "certified copy" of the court order in hand and shall show it to a peace officer on request. This is the only way law enforcement can see the specific restrictions applied to that driver.</p>
                <p>Failure to have the court order in hand while driving is a Class B Misdemeanor (521.253).</p>

                <h4>521.253 – Criminal Penalty</h4>
                <p>It is an offense to drive on an Occupational License without the certified court order.</p>
                <p>It is an offense to violate a specific restriction applied to the Occupational License in the court order.</p>
                <p>Either offense is a Class B Misdemeanor and the Occupational License is revoked upon conviction.</p>

                <div class="info-box">
                    <strong>DPS Arrest Titles related to occupational licenses:</strong>
                    <ul>
                        <li>Violate Driver License Restriction on Occupational License</li>
                        <li>Fail to Display Court Order – Occupational License</li>
                    </ul>
                </div>

                <div class="apply-it-section" id="apply-it-31">
                    <div class="apply-it-header">
                        <span>⚖️</span> Apply It: Occupational License Scenarios
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p><strong>Scenario 1:</strong> Driver's Texas license is suspended. Provides certified court order (23 days old), hasn't completed occupational license process yet.</p>
                            <p>Is the driver committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ1', 'no', 'Correct! The court order serves as the occupational license for 45 days. At 23 days, it is still valid.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ1', 'no', 'Correct! The court order serves as the occupational license for 45 days. At 23 days, it is still valid.')">NO</button>
                            </div>
                            <div id="occ1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="occ2-container" style="display: none;">
                            <p><strong>Scenario 2:</strong> Same situation, but court order was issued four months ago.</p>
                            <p>Is the driver committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ2', 'yes', 'Correct! After 45 days, the driver must have the actual occupational license, not just the court order.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ2', 'yes', 'Correct! After 45 days, the driver must have the actual occupational license, not just the court order.')">NO</button>
                            </div>
                            <div id="occ2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="occ3-container" style="display: none;">
                            <p><strong>Scenario 3:</strong> Has occupational license but cannot find certified court order (thinks it's in another vehicle).</p>
                            <p>Is the driver committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ3', 'yes', 'Correct! 521.253 - Class B Misdemeanor to drive on occupational license without the certified court order.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ3', 'yes', 'Correct! 521.253 - Class B Misdemeanor to drive on occupational license without the certified court order.')">NO</button>
                            </div>
                            <div id="occ3-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="occ4-container" style="display: none;">
                            <p><strong>Scenario 4:</strong> Has occupational license and court order. Court order requires ignition interlock device, but vehicle has none.</p>
                            <p>Is the driver committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ4', 'yes', 'Correct! 521.253 - Class B Misdemeanor to violate restrictions on occupational license.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ4', 'yes', 'Correct! 521.253 - Class B Misdemeanor to violate restrictions on occupational license.')">NO</button>
                            </div>
                            <div id="occ4-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="occ5-container" style="display: none;">
                            <p><strong>Scenario 5:</strong> Court order allows driving 6 AM to 5 PM. Traffic stop at 8:30 PM.</p>
                            <p>Is the driver committing a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ5', 'yes', 'Correct! 521.253 - Class B Misdemeanor to violate time restrictions on occupational license.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'occ5', 'yes', 'Correct! 521.253 - Class B Misdemeanor to violate time restrictions on occupational license.')">NO</button>
                            </div>
                            <div id="occ5-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="occ-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Occupational License Complete!</h4>
                                <p>Key points:</p>
                                <ul>
                                    <li>📅 Court order valid for 45 days</li>
                                    <li>📄 Must carry certified court order</li>
                                    <li>⚠️ Violations = Class B Misdemeanor</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.271 – License Expiration</h4>
                <p>This section sets forth the basic license expiration periods:</p>
                <ul>
                    <li><strong>Normal Driver's License</strong> – on the person's birthday after 8 years</li>
                    <li><strong>Provisional License</strong> – 18th birthday of the license holder</li>
                    <li><strong>Learner License</strong> – 18th birthday of the license holder</li>
                    <li><strong>Occupational License</strong> – 1 year after court order granting the license is issued</li>
                    <li><strong>Person who resides in a Correctional Facility</strong> – on the person's birthday after one year</li>
                    <li><strong>Non-Citizen</strong> – on the person's birthday after 6 years or when lawful presence in the US ends, whichever is first</li>
                </ul>

                <h4>521.2711 – License Expiration: Person at Least 85 Years of Age</h4>
                <p>If the license holder is 85 years of age or older, the license expires on the license holder's second birthday after the date of the license application.</p>

                <h4>521.292 – Department's Determination for License Suspension</h4>
                <p>This is a list of circumstances in which DPS will automatically suspend a person's driver license. A license will be suspended if the person:</p>
                <ol>
                    <li>has operated a motor vehicle on a highway while the person's license was suspended, canceled, disqualified, or revoked;</li>
                    <li>is a habitually reckless or negligent operator of a motor vehicle;</li>
                    <li>is a habitual violator of the traffic laws;</li>
                </ol>
                <div class="highlight-box">
                    <strong>Habitual Violator:</strong> 4 or more convictions in 12 months OR 7 or more convictions in 24 months (excluding weight, width, length, load, permit, or seatbelt violations).
                </div>
                <ol start="4">
                    <li>has permitted the unlawful or fraudulent use of the person's license;</li>
                    <li>has committed an offense in another state or Canadian province that, if committed in this state, would be grounds for suspension;</li>
                    <li>has been convicted of two or more separate offenses of a violation of a restriction imposed on the use of the license;</li>
                    <li>has been responsible as a driver for any collision resulting in serious personal injury or serious property damage;</li>
                    <li>is under 18 years of age and has been convicted of two or more moving violations committed within a 12-month period; or</li>
                    <li>has committed an offense under Section 545.421.</li>
                </ol>

                <div class="info-box">
                    <p><strong>Reference 521.293</strong> – the period of this automatic suspension will be 90 days.</p>
                    <p><strong>Word Association:</strong> Habitual Violator → 4 in 12 months, 7 in 24 months → Automatic Suspension</p>
                </div>

                <h4>521.350 – Suspension for Racing on Public Highway or Street</h4>
                <p>A person's Texas driver's license will be automatically suspended for one year and they will have to perform at least 10 hours of community service upon conviction for Racing (545.420).</p>

                <div class="info-box">
                    <strong>Word Association:</strong> Racing → one year suspension
                </div>

                <h4>521.451 – General Violation</h4>
                <p>This section describes numerous driver license/ID card violations, all of which are Class A Misdemeanors.</p>
                <p>These violations can be committed with a Texas Driver's License OR an Identification Certificate (ID card):</p>
                <ol>
                    <li>display, cause or permit to be displayed, or have in the person's possession a fictitious or altered DL or ID card;</li>
                    <li>lend the person's DL or ID card to another person;</li>
                    <li>display or represent as the person's own a DL or ID card not issued to the person;</li>
                    <li>possess more than one currently valid DL or more than one currently valid ID card; or</li>
                    <li>in an application for a DL or ID card, provide a false name, false address, counterfeit document, or knowingly make a false statement.</li>
                </ol>

                <div class="info-box">
                    <strong>(c)</strong> – if a person commits a violation of this section that is also a violation of Texas Alcoholic Beverage Code 106.07, they should be prosecuted under the Alcoholic Beverage Code. This means if a person presents a fraudulent DL or ID to represent they are 21 YOA or older to a person selling or serving alcohol, they should be charged for that offense rather than an offense under this section of the TRC. An offense under TABC 106.07 is a Class C Misdemeanor.
                </div>

                <h4>521.453 – Fictitious License or Certificate</h4>
                <p>It is an offense for a person under 21 years-of-age to possess a document that is deceptively similar to a driver's license or ID card with the intent of misrepresenting their age unless the card states "NOT A GOVERNMENT DOCUMENT" clearly and indelibly on both the front and back.</p>
                <p>This applies to Texas and out of state licenses and ID cards. The document is considered to be deceptively similar if a reasonable person would assume it was a legitimate license or ID card.</p>
                <p>A peace officer may confiscate this document.</p>
                <p>This offense is a Class C Misdemeanor.</p>

                <div class="apply-it-section" id="apply-it-32">
                    <div class="apply-it-header">
                        <span>🆔</span> Apply It: Fraudulent ID Analysis
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>19-year-old driver has legitimate Texas DL but also found with fake Hawaii DL he uses to buy beer. Which charge applies?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'fake1', 'option-d', 'Correct! Under 21 + misrepresenting age for alcohol = 521.453 Class C Misdemeanor.')">a) No violation - didn\'t present to officer</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'fake1', 'option-d', 'Correct! Under 21 + misrepresenting age for alcohol = 521.453 Class C Misdemeanor.')">b) No violation - not fraudulent Texas license</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'fake1', 'option-d', 'Correct! Under 21 + misrepresenting age for alcohol = 521.453 Class C Misdemeanor.')">c) 521.451 Class A misdemeanor</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'fake1', 'option-d', 'Correct! Under 21 + misrepresenting age for alcohol = 521.453 Class C Misdemeanor.')">d) 521.453 Class C misdemeanor</button>
                            </div>
                            <div id="fake1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="fake-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Fraudulent ID Analysis Complete!</h4>
                                <p>Remember:</p>
                                <ul>
                                    <li>🔞 Under 21 + age misrepresentation = 521.453 (Class C)</li>
                                    <li>⚖️ Other fraudulent purposes = 521.451 (Class A)</li>
                                    <li>🍺 Alcohol sales = TABC 106.07 (Class C)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.457 – Driving While License Invalid</h4>
                <p>This offense is generally a Class C Misdemeanor, but can be enhanced all the way to a Class A Misdemeanor in certain circumstances.</p>
                <p>"Suspended", "Denied", "Revoked" and "Cancelled" licenses are all invalid.</p>

                <div class="info-box">
                    <strong>Discussion Point:</strong> This offense is specific to a license that is canceled, suspended, denied, or revoked under the laws of "this state". A person with an out of state license that is suspended should not be prosecuted under this section. If their out of state license is suspended, consider them to be unlicensed and they should be prosecuted for No Driver License under 521.021.
                </div>

                <p><strong>Enhancement Levels:</strong></p>
                <ul>
                    <li><strong>Class C Misdemeanor DWLI</strong> – first offense</li>
                    <li><strong>Class B Misdemeanor DWLI</strong> – previous DWLI conviction OR no insurance OR previous alcohol-related suspension</li>
                    <li><strong>Class A Misdemeanor DWLI</strong> – invalid license + no insurance + crash causing SBI/death</li>
                </ul>

                <div class="apply-it-section" id="apply-it-33">
                    <div class="apply-it-header">
                        <span>⚖️</span> Apply It: DWLI Classification
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p><strong>Scenario 1:</strong> Suspended license, multiple previous suspensions, no previous DWLI convictions.</p>
                            <p>What level of offense?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class C|C', 'dwli1', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class C|C', 'dwli1', 'class')">
                        </div>

                        <div class="scenario-question" id="dwli2-container" style="display: none;">
                            <p><strong>Scenario 2:</strong> Suspended license, previous DWI suspension, no previous DWLI convictions.</p>
                            <p>What level of offense?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class B|B', 'dwli2', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class B|B', 'dwli2', 'class')">
                        </div>

                        <div class="scenario-question" id="dwli3-container" style="display: none;">
                            <p><strong>Scenario 3:</strong> Suspended license, no insurance, no previous DWLI or alcohol suspensions.</p>
                            <p>What level of offense?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class B|B', 'dwli3', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class B|B', 'dwli3', 'class')">
                        </div>

                        <div class="scenario-question" id="dwli4-container" style="display: none;">
                            <p><strong>Scenario 4:</strong> Revoked license, no insurance, caused crash with fatality.</p>
                            <p>What level of offense?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A|A', 'dwli4', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A|A', 'dwli4', 'class')">
                        </div>

                        <div class="scenario-question" id="dwli-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ DWLI Classification Complete!</h4>
                                <p>Enhancement Rules:</p>
                                <ul>
                                    <li>🔵 <strong>Class C:</strong> First offense</li>
                                    <li>🟡 <strong>Class B:</strong> Previous DWLI OR no insurance OR alcohol suspension</li>
                                    <li>🔴 <strong>Class A:</strong> Invalid + no insurance + SBI/death crash</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>521.458 – Permitting Unauthorized Person to Drive</h4>
                <p><strong>(a)</strong> Parents may not permit or cause their minor child (under 18 YOA) to drive without a license or otherwise in violation of Chapter 521.</p>
                <p><strong>(b)</strong> It is a violation for anyone to allow a person to drive their vehicle knowing the person is unlicensed or otherwise in violation of Chapter 521.</p>

                <h4>521.460 – Motor Vehicle Rentals</h4>
                <p>Car rental companies cannot rent a vehicle to an unlicensed person.</p>
                <p>They must also maintain specific detailed records about rented vehicles and drivers. They are required to show the records to a peace officer upon request.</p>

                <h4>521.461 – General Criminal Penalty</h4>
                <p>Unless otherwise specified or enhanced, an offense under Chapter 521 is a misdemeanor with a fine not to exceed $200.</p>

                <!-- Chapter 522 Content Begins -->
                <h4>SECTION 2.2 – CHAPTER 522 - COMMERCIAL DRIVER'S LICENSES</h4>
                <div class="info-box">
                    <strong>BPOC Objective 22.8</strong> - Understand the commercial driver licensing requirements in Texas and identify violations related to commercial driver licensing.
                </div>

                <h4>522.001 – Purpose and Construction</h4>
                <p>This chapter implements the Commercial Motor Vehicle Safety Act of 1986 and adopts the licensing standards contained in 49 C.F.R. Part 383 to ensure that drivers of commercial motor vehicles are qualified and competent.</p>

                <h4>522.003 – Definitions</h4>
                <p><strong>Commercial Driver's License (CDL)</strong> – a license issued to an individual that authorizes the individual to operate a class of commercial motor vehicles.</p>
                
                <p><strong>Commercial Motor Vehicle</strong> – a motor vehicle or combination of motor vehicles used to transport passengers or property if the vehicle:</p>
                <ol>
                    <li>Has a gross combination weight rating of 26,001 or more pounds, if the gross vehicle weight rating of the vehicle or vehicles being towed is in excess of 10,000 pounds;</li>
                    <li>Has a gross vehicle weight rating of 26,001 or more pounds;</li>
                    <li>Is designed to transport 16 or more passengers, including the driver; or</li>
                    <li>Is of any size and is used in the transportation of hazardous materials requiring placarding.</li>
                </ol>

                <div class="highlight-box">
                    <strong>Key Point:</strong> Commercial Motor Vehicle definition is based on weight ratings (GVWR/GCWR), passenger capacity, or hazardous materials transport - not what the vehicle actually weighs or how it's being used.
                </div>

                <h4>522.004 – Exemptions</h4>
                <p>The following vehicles are exempt from CDL requirements:</p>
                <ol>
                    <li><strong>Emergency vehicles</strong> operated by emergency personnel during an emergency</li>
                    <li><strong>Military vehicles</strong> operated by military personnel</li>
                    <li><strong>Recreational vehicles</strong> operated for personal use (RVs, motorhomes)</li>
                    <li><strong>Farm vehicles</strong> operated for personal use within 150 miles of the farm</li>
                    <li><strong>Firefighting equipment</strong> operated by volunteer firefighters</li>
                    <li><strong>Vehicles removing snow or ice</strong> from highways</li>
                </ol>

                <div class="apply-it-section" id="apply-it-24">
                    <div class="apply-it-header">
                        <span>🚛</span> Apply It: CDL Requirements Scenario
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>A driver is operating a delivery truck with a GVWR of 28,000 lbs for a commercial delivery company. The driver has a regular Class C license. Is this a violation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cdl1', 'yes', 'Correct! This vehicle meets the definition of a commercial motor vehicle (GVWR >26,000 lbs) and requires a CDL.')">YES - CDL Required</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cdl1', 'yes', 'Correct! This vehicle meets the definition of a commercial motor vehicle (GVWR >26,000 lbs) and requires a CDL.')">NO - Class C is Sufficient</button>
                            </div>
                            <div id="cdl1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cdl2-container" style="display: none;">
                            <p>What if the same vehicle was being used to move personal belongings during a family relocation?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cdl2', 'no', 'Correct! Personal use vehicles are exempt from CDL requirements under 522.004(3), even if they meet the weight criteria.')">YES - CDL Still Required</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cdl2', 'no', 'Correct! Personal use vehicles are exempt from CDL requirements under 522.004(3), even if they meet the weight criteria.')">NO - Personal Use Exempt</button>
                            </div>
                            <div id="cdl2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cdl-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ CDL Analysis Complete!</h4>
                                <p>Key takeaway: CDL requirements depend on both vehicle specifications AND use. Commercial use requires CDL, personal use may be exempt.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>522.011 – CDL Required</h4>
                <p>A person may not operate a commercial motor vehicle unless the person has been issued a commercial driver's license with applicable endorsements for the type of vehicle being operated.</p>

                <h4>522.012 – CDL Endorsements</h4>
                <p>Different types of endorsements are required for specific vehicles or cargo:</p>
                <ul>
                    <li><strong>H Endorsement</strong> - Hazardous Materials</li>
                    <li><strong>N Endorsement</strong> - Tank Vehicles</li>
                    <li><strong>P Endorsement</strong> - Passenger Vehicles</li>
                    <li><strong>S Endorsement</strong> - School Bus</li>
                    <li><strong>T Endorsement</strong> - Double/Triple Trailers</li>
                    <li><strong>X Endorsement</strong> - Combination of H and N</li>
                </ul>

                <div class="apply-it-section" id="apply-it-25">
                    <div class="apply-it-header">
                        <span>🚌</span> Apply It: School Bus Endorsement
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>You stop a school bus driver who has a valid CDL but no S endorsement. The bus is designed to carry 30 passengers and is transporting students. What violation has occurred?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Enter the violation..." onblur="checkFillBlank(this, 'Operating without required endorsement|No S endorsement|Missing school bus endorsement', 'schoolbus', 'violation')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Operating without required endorsement|No S endorsement|Missing school bus endorsement', 'schoolbus', 'violation')">
                        </div>

                        <div class="scenario-question" id="schoolbus-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ Endorsement Violation Identified!</h4>
                                <p>Remember: Even with a valid CDL, specific endorsements are required for certain vehicle types and cargo. School buses always require an S endorsement.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>522.013 – CDL Restrictions</h4>
                <p>CDL restrictions limit the type of commercial vehicles that may be operated:</p>
                <ul>
                    <li><strong>E Restriction</strong> - Manual transmission prohibited</li>
                    <li><strong>L Restriction</strong> - No air brake equipped vehicles</li>
                    <li><strong>M Restriction</strong> - No Class A passenger vehicles</li>
                    <li><strong>N Restriction</strong> - No Class A or B passenger vehicles</li>
                    <li><strong>O Restriction</strong> - No tractor-trailer CMV</li>
                </ul>

                <h4>522.021 – Disqualification from Driving a CMV</h4>
                <p>CDL holders face disqualification for certain violations. Major disqualifying offenses include:</p>
                <ul>
                    <li>Driving under the influence while operating any motor vehicle</li>
                    <li>Leaving the scene of an accident</li>
                    <li>Using a motor vehicle to commit a felony</li>
                    <li>Driving a CMV with a suspended, revoked, or cancelled license</li>
                    <li>Refusing to submit to alcohol testing</li>
                </ul>

                <div class="info-box">
                    <strong>Important Note:</strong> CDL disqualifications apply even if the violation occurred in a personal vehicle, not just when operating a CMV.
                </div>

                <h4>522.022 – Alcohol and Controlled Substance Testing</h4>
                <p>CDL holders are subject to more stringent alcohol limits:</p>
                <ul>
                    <li><strong>0.04 BAC</strong> - Disqualification limit for CDL holders (vs. 0.08 for regular drivers)</li>
                    <li><strong>0.02 BAC</strong> - 24-hour out-of-service order</li>
                    <li>Random testing programs required for commercial drivers</li>
                </ul>

                <div class="apply-it-section" id="apply-it-26">
                    <div class="apply-it-header">
                        <span>🍺</span> Apply It: CDL Alcohol Limits
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p>You stop a CDL holder operating their personal car (not a CMV) after observing erratic driving. A breath test shows 0.06 BAC. What are the consequences?</p>
                            <div class="apply-it-multi-select">
                                <p>Select all that apply:</p>
                                <label class="apply-it-checkbox">
                                    <input type="checkbox" data-value="dwi"> DWI charge (0.06 > 0.08 limit)
                                </label>
                                <label class="apply-it-checkbox">
                                    <input type="checkbox" data-value="cdl-disqualified"> CDL disqualification
                                </label>
                                <label class="apply-it-checkbox">
                                    <input type="checkbox" data-value="no-violation"> No violation (under 0.08)
                                </label>
                                <label class="apply-it-checkbox">
                                    <input type="checkbox" data-value="personal-only"> Only affects personal driving
                                </label>
                                <button class="choice-btn" onclick="checkMultiSelect('alcohol-cdl', ['no-violation'], 'At 0.06 BAC in a personal vehicle, no violation occurs since it\'s under the 0.08 limit. However, ANY DWI conviction would affect CDL privileges.')">Check Answers</button>
                            </div>
                            <div id="alcohol-cdl-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="alcohol-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ CDL Alcohol Rules Complete!</h4>
                                <p>Key points:</p>
                                <ul>
                                    <li>0.04 BAC limit applies only when operating CMVs</li>
                                    <li>0.08 BAC limit applies when operating personal vehicles</li>
                                    <li>ANY DWI conviction affects CDL privileges regardless of vehicle type</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>522.081 – Commercial Driver's License Classes</h4>
                <p><strong>Class A CDL</strong> - Combination vehicles with GCWR ≥26,001 lbs and towed vehicle >10,000 lbs</p>
                <p><strong>Class B CDL</strong> - Large trucks with GVWR ≥26,001 lbs or buses designed for ≥16 passengers</p>
                <p><strong>Class C CDL</strong> - Vehicles requiring hazmat endorsement or designed for 16+ passengers but not meeting Class A or B criteria</p>

                <div class="apply-it-section" id="apply-it-27">
                    <div class="apply-it-header">
                        <span>🚚</span> Apply It: CDL Class Determination
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p><strong>Scenario 1:</strong> Truck tractor (GVWR: 18,000 lbs) pulling a semi-trailer (GVWR: 34,000 lbs)</p>
                            <p>GCWR: 52,000 lbs | Towed unit: 34,000 lbs</p>
                            <p>Required CDL Class:</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A|A', 'cdlclass1', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A|A', 'cdlclass1', 'class')">
                        </div>

                        <div class="scenario-question" id="cdlclass2-container" style="display: none;">
                            <p><strong>Scenario 2:</strong> Single unit delivery truck (GVWR: 33,000 lbs)</p>
                            <p>Required CDL Class:</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class B|B', 'cdlclass2', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class B|B', 'cdlclass2', 'class')">
                        </div>

                        <div class="scenario-question" id="cdlclass3-container" style="display: none;">
                            <p><strong>Scenario 3:</strong> 20-passenger church bus (GVWR: 14,000 lbs)</p>
                            <p>Required CDL Class:</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class C|C', 'cdlclass3', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class C|C', 'cdlclass3', 'class')">
                        </div>

                        <div class="scenario-question" id="cdlclass-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ CDL Classification Complete!</h4>
                                <p>Remember CDL Class Rules:</p>
                                <ul>
                                    <li>🚛 <strong>Class A CDL:</strong> Combinations ≥26K AND towed >10K</li>
                                    <li>🚚 <strong>Class B CDL:</strong> Single unit ≥26K OR bus ≥16 passengers</li>
                                    <li>🚐 <strong>Class C CDL:</strong> Hazmat or 16+ passengers not in A/B</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Module 2 Interactive Review Quiz -->
                <div class="quiz-section">
                    <div class="quiz-header">
                        <h4>📝 MODULE 2 INTERACTIVE REVIEW QUIZ</h4>
                        <p class="quiz-subtitle">Test your knowledge of Chapters 521 & 522</p>
                    </div>

                    <div class="quiz-questions" id="quiz2Questions" style="display: block;">
                        <!-- Questions will be inserted here by JavaScript -->
                    </div>

                    <div class="quiz-results" id="quiz2Results" style="display: none;">
                        <div class="results-header">
                            <h4>🎉 Quiz Complete!</h4>
                            <div class="score-display" id="score2Display"></div>
                        </div>
                        <div class="results-breakdown" id="results2Breakdown"></div>
d                        <div class="quiz-actions">
                            <button onclick="restartQuiz(2)" class="quiz-button secondary">🔄 Retake Quiz</button>
                            <button onclick="markModuleComplete(2)" class="quiz-button primary">✅ Complete Module 2</button>
                        </div>
                    </div>
                </div>
                <h4>522.011 – License or Permit Required; Offense</h4>
                <p>This is the general law requiring the operator of a commercial motor vehicle to hold a valid CDL.</p>
                <p>It is a violation to operate a commercial motor vehicle without a commercial driver's license or with a CDL that is not for the correct class of vehicle being operated. It is also a violation to operate a commercial motor vehicle while the person's CDL is disqualified or subject to an out-of-service order.</p>
                <p>A person holding a commercial learner's permit must have a licensed operator observing their driving and providing instruction while operating a commercial motor vehicle.</p>
                <p>This offense carries a fine not to exceed $500. The fine increases to $1000 for a subsequent conviction within one year.</p>

                <div class="info-box">
                    <strong>DPS Arrest Titles:</strong>
                    <ul>
                        <li>License or Permit Required – No Valid CDL</li>
                        <li>License or Permit Required – CDL Disqualified or Out of Service</li>
                    </ul>
                </div>

                <div class="apply-it-section" id="apply-it-34">
                    <div class="apply-it-header">
                        <span>🚛</span> Apply It: CDL Exemption Scenarios
                    </div>
                    <div class="apply-it-content">
                        <div class="scenario-question">
                            <p><strong>Scenario 1:</strong> Truck (GVWR: 14,000 lbs) + travel trailer (GVWR: 20,000 lbs) = GCWR: 34,000 lbs</p>
                            <p>Does this combination meet the weight requirements of a commercial motor vehicle?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv1', 'yes', 'Correct! GCWR >26,000 AND trailer >10,000 meets CMV definition.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv1', 'yes', 'Correct! GCWR >26,000 AND trailer >10,000 meets CMV definition.')">NO</button>
                            </div>
                            <div id="cmv1-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv2-container" style="display: none;">
                            <p>Is the driver required to hold a commercial driver license?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv2', 'no', 'Correct! This appears to be a recreational vehicle (travel trailer), so it\'s exempt from CDL requirements under 522.004(4).')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv2', 'no', 'Correct! This appears to be a recreational vehicle (travel trailer), so it\'s exempt from CDL requirements under 522.004(4).')">NO</button>
                            </div>
                            <div id="cmv2-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv3-container" style="display: none;">
                            <p>If not CDL, what class of license is required?</p>
                            <input type="text" class="apply-it-fill-blank" placeholder="Class ?" onblur="checkFillBlank(this, 'Class A|A', 'cmv3', 'class')" onkeypress="if(event.key==='Enter') checkFillBlank(this, 'Class A|A', 'cmv3', 'class')">
                        </div>

                        <div class="scenario-question" id="cmv4-container" style="display: none;">
                            <p><strong>Scenario 2:</strong> Fire truck (GVWR: 60,000 lbs). Driver has Non-CDL Class B license.</p>
                            <p>Does this vehicle meet CMV weight requirements?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv4', 'yes', 'Correct! GVWR >26,000 meets CMV definition.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv4', 'yes', 'Correct! GVWR >26,000 meets CMV definition.')">NO</button>
                            </div>
                            <div id="cmv4-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv5-container" style="display: none;">
                            <p>Did the operator violate CDL requirements?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv5', 'no', 'Correct! Fire trucks are exempt from CDL requirements under 522.004(2).')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv5', 'no', 'Correct! Fire trucks are exempt from CDL requirements under 522.004(2).')">NO</button>
                            </div>
                            <div id="cmv5-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv6-container" style="display: none;">
                            <p><strong>Scenario 3:</strong> Farm truck (GVWR: 45,000 lbs) + trailer (GVWR: 40,000 lbs) hauling watermelons from Brownsville to Dallas (550 miles).</p>
                            <p>Does this meet CMV requirements?</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv6', 'yes', 'Correct! GCWR >26,000 AND trailer >10,000 meets CMV definition.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv6', 'yes', 'Correct! GCWR >26,000 AND trailer >10,000 meets CMV definition.')">NO</button>
                            </div>
                            <div id="cmv6-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv7-container" style="display: none;">
                            <p>Is CDL required? (550 miles from farm)</p>
                            <div class="answer-choices">
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv7', 'yes', 'Correct! Over 150 miles from farm, so covered farm vehicle exemption doesn\'t apply for vehicles >26,000 lbs.')">YES</button>
                                <button class="choice-btn" onclick="selectApplyItAnswer(this, 'cmv7', 'yes', 'Correct! Over 150 miles from farm, so covered farm vehicle exemption doesn\'t apply for vehicles >26,000 lbs.')">NO</button>
                            </div>
                            <div id="cmv7-feedback" class="feedback"></div>
                        </div>

                        <div class="scenario-question" id="cmv-complete" style="display: none;">
                            <div class="completion-message">
                                <h4>✅ CDL Exemption Analysis Complete!</h4>
                                <p>Key exemptions from CDL requirements:</p>
                                <ul>
                                    <li>🔥 Emergency/Fire vehicles</li>
                                    <li>🏕️ Recreational vehicles (personal use)</li>
                                    <li>🚜 Covered farm vehicles (with distance limits)</li>
                                    <li>🎖️ Military vehicles (military personnel)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <h4>522.042 – Endorsements; Offense</h4>
                <p>If officers encounter one of the described commercial motor vehicles, they should be aware that it is a violation to operate the vehicle without the proper endorsement:</p>
                <ul>
                    <li><strong>HAZMAT</strong> – H endorsement</li>
                    <li><strong>Double or Triple Trailer</strong> – T endorsement</li>
                    <li><strong>Passengers</strong> – P endorsement</li>
                    <li><strong>Tank Vehicle</strong> – N endorsement</li>
                    <li><strong>HAZMAT and Tank Combined</strong> – X endorsement</li>
                    <li><strong>School Bus</strong> – S endorsement</li>
                </ul>

                <h4>522.101 – Driving While Having Alcohol in System Prohibited</h4>
                <p>A person may not drive a commercial motor vehicle with any measurable or detectable amount of alcohol in the person's system. If a CDL holder is driving a non-commercial motor vehicle, this section does not apply.</p>
                <p>If a driver violates this section, they shall be placed out of service for 24 hours. Any peace officer can do this, not just federally certified officers. Peace officers place the driver out of service by filling out the MCS-10 form.</p>

                <div class="info-box">
                    <strong>Word Association:</strong> Commercial Motor Vehicle → Any Detectable Alcohol → 24 Hours Out of Service
                </div>

                <div class="info-box">
                    <strong>Note:</strong> Be aware, there are additional steps to this process that are not part of BPOC learning objectives. An officer requesting a specimen from a CMV driver must read the DIC-55 Statutory Warnings to the driver. If the driver refuses to provide a specimen or gives a specimen with an alcohol level is .04 or more, their CDL should be confiscated and they should be served with the DIC-57 form giving notice of CDL disqualification. The officer then fills out form DIC-54 giving notice to the Department.
                </div>

                <!-- MODULE 2 COMPREHENSIVE REVIEW QUESTIONS -->
                <div class="quiz-section">
                    <div class="quiz-header">
                        <h4>📚 MODULE 2 COMPREHENSIVE REVIEW QUESTIONS</h4>
                        <p class="quiz-subtitle">Test your knowledge of Chapters 521 & 522 - Answer each question and identify the TRC section</p>
                    </div>

                    <div class="review-questions">
                        <div class="question-group">
                            <div class="question-item">
                                <h5>Question 1</h5>
                                <p>Which of the following is NOT exempt from the driver license requirement?</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q1', 'b', 'Correct! Moped operators are NOT exempt from license requirements. Reference: 521.027')">a) Operator of a farm tractor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q1', 'b', 'Correct! Moped operators are NOT exempt from license requirements. Reference: 521.027')">b) Operator of a moped</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q1', 'b', 'Correct! Moped operators are NOT exempt from license requirements. Reference: 521.027')">c) Operator of a road machine</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q1', 'b', 'Correct! Moped operators are NOT exempt from license requirements. Reference: 521.027')">d) Operator of military vehicle in military service</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q1-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 2</h5>
                                <p>Unless specifically excepted, a person must hold a driver license to operate a motor vehicle in any public place in the state of Texas.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q2', 'false', 'Correct! The requirement is for highways, not all public places. Reference: 521.021')">True</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q2', 'false', 'Correct! The requirement is for highways, not all public places. Reference: 521.021')">False</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q2-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 3</h5>
                                <p>When a person moves to Texas from a different state, how many days do they have to obtain a Texas driver's license?</p>
                                <input type="text" class="fill-blank-answer" placeholder="Enter number of days" onblur="checkReviewFillBlank(this, '90|90 days|ninety|ninety days', 'q3')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '90|90 days|ninety|ninety days', 'q3')">
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q3-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 4</h5>
                                <p>When a person moves to a new residence in Texas, how many days do they have to update the address information on their driver's license?</p>
                                <input type="text" class="fill-blank-answer" placeholder="Enter number of days" onblur="checkReviewFillBlank(this, '30|30 days|thirty|thirty days', 'q4')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '30|30 days|thirty|thirty days', 'q4')">
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q4-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 5</h5>
                                <p>What is the minimum age to obtain a Texas driver's license?</p>
                                <input type="text" class="fill-blank-answer" placeholder="Enter age" onblur="checkReviewFillBlank(this, '15|fifteen', 'q5')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '15|fifteen', 'q5')">
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q5-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 6</h5>
                                <p>What class of license is required to operate the following vehicle: A pickup with a GVWR of 14,000 pounds towing a travel trailer with a GVWR of 15,000 pounds.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q6', 'c', 'Correct! GCWR >26,000 AND trailer >10,000 requires Class A Non-CDL. Reference: 521.081')">a) Class C Non-CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q6', 'c', 'Correct! GCWR >26,000 AND trailer >10,000 requires Class A Non-CDL. Reference: 521.081')">b) Class B Non-CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q6', 'c', 'Correct! GCWR >26,000 AND trailer >10,000 requires Class A Non-CDL. Reference: 521.081')">c) Class A Non-CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q6', 'c', 'Correct! GCWR >26,000 AND trailer >10,000 requires Class A Non-CDL. Reference: 521.081')">d) Class A CDL</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q6-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 7</h5>
                                <p>What class of license is required to operate the following vehicle: A truck tractor in commerce with a GVWR of 54,000 pounds towing a trailer with a GVWR of 10,000 pounds.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q7', 'b', 'Correct! Single unit >26,000 requires Class B CDL when in commerce. Reference: 522.041')">a) Class A CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q7', 'b', 'Correct! Single unit >26,000 requires Class B CDL when in commerce. Reference: 522.041')">b) Class B CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q7', 'b', 'Correct! Single unit >26,000 requires Class B CDL when in commerce. Reference: 522.041')">c) Class C CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q7', 'b', 'Correct! Single unit >26,000 requires Class B CDL when in commerce. Reference: 522.041')">d) Class A Non-CDL</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="522.___" class="section-input"></p>
                                </div>
                                <div id="q7-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 8</h5>
                                <p>What class of license is required to operate the following vehicle: A bus transporting passengers for hire with a passenger capacity of 26 people, including the driver.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q8', 'b', 'Correct! Bus with 24+ passengers requires Class B CDL. Reference: 522.041')">a) Class A CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q8', 'b', 'Correct! Bus with 24+ passengers requires Class B CDL. Reference: 522.041')">b) Class B CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q8', 'b', 'Correct! Bus with 24+ passengers requires Class B CDL. Reference: 522.041')">c) Class C CDL</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q8', 'b', 'Correct! Bus with 24+ passengers requires Class B CDL. Reference: 522.041')">d) Class B Non-CDL</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="522.___" class="section-input"></p>
                                </div>
                                <div id="q8-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 9</h5>
                                <p>There are two circumstances where a person holding an occupational license can be charged with a Class B Misdemeanor. List each below:</p>
                                <div class="dual-fill-blank">
                                    <input type="text" class="fill-blank-answer" placeholder="First circumstance" onblur="checkReviewFillBlank(this, 'driving without court order|no court order|fail to display court order', 'q9a')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, 'driving without court order|no court order|fail to display court order', 'q9a')">
                                    <input type="text" class="fill-blank-answer" placeholder="Second circumstance" onblur="checkReviewFillBlank(this, 'violating restrictions|restriction violation|violate restrictions', 'q9b')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, 'violating restrictions|restriction violation|violate restrictions', 'q9b')">
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q9a-feedback" class="feedback"></div>
                                <div id="q9b-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 10</h5>
                                <p>A habitual violator is defined as receiving _____ or more convictions in _____ consecutive months, or _____ more convictions in _____ months.</p>
                                <div class="quad-fill-blank">
                                    <input type="text" class="fill-blank-answer" placeholder="First number" onblur="checkReviewFillBlank(this, '4|four', 'q10a')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '4|four', 'q10a')">
                                    <input type="text" class="fill-blank-answer" placeholder="First months" onblur="checkReviewFillBlank(this, '12|twelve', 'q10b')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '12|twelve', 'q10b')">
                                    <input type="text" class="fill-blank-answer" placeholder="Second number" onblur="checkReviewFillBlank(this, '7|seven', 'q10c')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '7|seven', 'q10c')">
                                    <input type="text" class="fill-blank-answer" placeholder="Second months" onblur="checkReviewFillBlank(this, '24|twenty-four', 'q10d')" onkeypress="if(event.key==='Enter') checkReviewFillBlank(this, '24|twenty-four', 'q10d')">
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q10a-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 11</h5>
                                <p>What happens if a person meets the definition of a habitual violator?</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q11', 'c', 'Correct! Habitual violators face automatic license suspension. Reference: 521.292')">a) They are issued a letter of reprimand</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q11', 'c', 'Correct! Habitual violators face automatic license suspension. Reference: 521.292')">b) They must pay an annual surcharge</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q11', 'c', 'Correct! Habitual violators face automatic license suspension. Reference: 521.292')">c) Their driver license is suspended</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q11', 'c', 'Correct! Habitual violators face automatic license suspension. Reference: 521.292')">d) Their vehicle is impounded</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q11-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 12</h5>
                                <p>A person with a suspended driver license causes a traffic crash which results in serious bodily injury to another. At the time of the crash, the person does not have insurance on their vehicle. The person may be charged with DWLI as a:</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q12', 'c', 'Correct! Invalid license + no insurance + SBI = Class A Misdemeanor DWLI. Reference: 521.457')">a) Class C Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q12', 'c', 'Correct! Invalid license + no insurance + SBI = Class A Misdemeanor DWLI. Reference: 521.457')">b) Class B Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q12', 'c', 'Correct! Invalid license + no insurance + SBI = Class A Misdemeanor DWLI. Reference: 521.457')">c) Class A Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q12', 'c', 'Correct! Invalid license + no insurance + SBI = Class A Misdemeanor DWLI. Reference: 521.457')">d) State Jail Felony</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q12-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 13</h5>
                                <p>A person driving with a suspended driver's license who does not have insurance or any other type of financial responsibility for their vehicle commits a:</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q13', 'b', 'Correct! Suspended license + no insurance = Class B Misdemeanor DWLI. Reference: 521.457')">a) Class C Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q13', 'b', 'Correct! Suspended license + no insurance = Class B Misdemeanor DWLI. Reference: 521.457')">b) Class B Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q13', 'b', 'Correct! Suspended license + no insurance = Class B Misdemeanor DWLI. Reference: 521.457')">c) Class A Misdemeanor</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q13', 'b', 'Correct! Suspended license + no insurance = Class B Misdemeanor DWLI. Reference: 521.457')">d) State Jail Felony</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="521.___" class="section-input"></p>
                                </div>
                                <div id="q13-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 14</h5>
                                <p>A CDL holder operating their personal vehicle may be placed out of service if they have detectable alcohol in their system while driving.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q14', 'false', 'Correct! 522.101 only applies to commercial motor vehicles, not personal vehicles. Reference: 522.101')">True</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q14', 'false', 'Correct! 522.101 only applies to commercial motor vehicles, not personal vehicles. Reference: 522.101')">False</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="522.___" class="section-input"></p>
                                </div>
                                <div id="q14-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 15</h5>
                                <p>A person operating a commercial motor vehicle with detectable alcohol in their system shall be placed out of service for 48 hours.</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q15', 'false', 'Correct! The out-of-service period is 24 hours, not 48. Reference: 522.101')">True</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q15', 'false', 'Correct! The out-of-service period is 24 hours, not 48. Reference: 522.101')">False</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="522.___" class="section-input"></p>
                                </div>
                                <div id="q15-feedback" class="feedback"></div>
                            </div>

                            <div class="question-item">
                                <h5>Question 16</h5>
                                <p>Which of the following is NOT exempt from the requirement to hold a commercial driver's license?</p>
                                <div class="answer-choices">
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q16', 'e', 'Correct! All listed options are exempt from CDL requirements under 522.004. Reference: 522.004')">a) A person operating a covered farm vehicle</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q16', 'e', 'Correct! All listed options are exempt from CDL requirements under 522.004. Reference: 522.004')">b) A person operating a large RV (GVWR 30,000 lbs)</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q16', 'e', 'Correct! All listed options are exempt from CDL requirements under 522.004. Reference: 522.004')">c) A firefighter operating a fire engine (GVWR 60,000 lbs)</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q16', 'e', 'Correct! All listed options are exempt from CDL requirements under 522.004. Reference: 522.004')">d) A person operating an 18-wheeler intrastate and not for compensation</button>
                                    <button class="choice-btn" onclick="selectReviewAnswer(this, 'q16', 'e', 'Correct! All listed options are exempt from CDL requirements under 522.004. Reference: 522.004')">e) All of the above are exempt from CDL requirements</button>
                                </div>
                                <div class="question-reference">
                                    <p><strong>TRC Section:</strong> <input type="text" placeholder="522.___" class="section-input"></p>
                                </div>
                                <div id="q16-feedback" class="feedback"></div>
                            </div>
                        </div>

                        <div class="review-results" id="reviewResults" style="display: none;">
                            <div class="results-header">
                                <h4>📊 Review Questions Complete!</h4>
                                <div class="score-display" id="reviewScoreDisplay"></div>
                            </div>
                            <div class="results-actions">
                                <button onclick="resetReviewQuestions()" class="quiz-button secondary">🔄 Reset Questions</button>
                                <button onclick="showAllAnswers()" class="quiz-button info">👁️ Show All Answers</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Module 2 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(1)">
                        ← Previous: Module 1
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 2 Complete!</div>
                        <div class="progress-text">Ready for Module 3</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(3)">
                        Next: Module 3 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module3">
            <!-- Module 3 Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(2)">
                    ← Previous: Module 2
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 3</div>
                    <div class="progress-text">Coming Soon</div>
                </div>
                <button class="nav-button next" onclick="showModule(4)">
                    Next: Module 4 →
                </button>
            </div>

            <div class="content-section">
                <h3>Module 3 Content</h3>
                <p>Module 3 content will be inserted here when you provide it.</p>

                <!-- Module 3 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(2)">
                        ← Previous: Module 2
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 3</div>
                        <div class="progress-text">Ready for Module 4</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(4)">
                        Next: Module 4 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module4">
            <!-- Module 4 Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(3)">
                    ← Previous: Module 3
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 4</div>
                    <div class="progress-text">Coming Soon</div>
                </div>
                <button class="nav-button next" onclick="showModule(5)">
                    Next: Module 5 →
                </button>
            </div>

            <div class="content-section">
                <h3>Module 4 Content</h3>
                <p>Module 4 content will be inserted here when you provide it.</p>

                <!-- Module 4 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(3)">
                        ← Previous: Module 3
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 4</div>
                        <div class="progress-text">Ready for Module 5</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(5)">
                        Next: Module 5 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module5">
            <!-- Module 5 Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(4)">
                    ← Previous: Module 4
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 5</div>
                    <div class="progress-text">Coming Soon</div>
                </div>
                <button class="nav-button next" onclick="showModule(6)">
                    Next: Module 6 →
                </button>
            </div>

            <div class="content-section">
                <h3>Module 5 Content</h3>
                <p>Module 5 content will be inserted here when you provide it.</p>

                <!-- Module 5 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(4)">
                        ← Previous: Module 4
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 5</div>
                        <div class="progress-text">Ready for Module 6</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(6)">
                        Next: Module 6 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module6">
            <!-- Module 6 Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(5)">
                    ← Previous: Module 5
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 6</div>
                    <div class="progress-text">Coming Soon</div>
                </div>
                <button class="nav-button next" onclick="showModule(7)">
                    Next: Module 7 →
                </button>
            </div>

            <div class="content-section">
                <h3>Module 6 Content</h3>
                <p>Module 6 content will be inserted here when you provide it.</p>

                <!-- Module 6 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(5)">
                        ← Previous: Module 5
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Module 6</div>
                        <div class="progress-text">Ready for Module 7</div>
                    </div>
                    <button class="nav-button next" onclick="showModule(7)">
                        Next: Module 7 →
                    </button>
                </div>
            </div>
        </div>

        <div class="module-content" id="module7">
            <!-- Module 7 Navigation -->
            <div class="module-navigation">
                <button class="nav-button prev" onclick="showModule(6)">
                    ← Previous: Module 6
                </button>
                <div class="module-progress-info">
                    <div class="current-module">Module 7</div>
                    <div class="progress-text">Final Module</div>
                </div>
                <button class="nav-button overview" onclick="showModule(0)">
                    🏠 Back to Overview
                </button>
            </div>

            <div class="content-section">
                <h3>Module 7 Content</h3>
                <p>Module 7 content will be inserted here when you provide it.</p>

                <!-- Module 7 Bottom Navigation -->
                <div class="module-navigation">
                    <button class="nav-button prev" onclick="showModule(6)">
                        ← Previous: Module 6
                    </button>
                    <div class="module-progress-info">
                        <div class="current-module">Course Complete!</div>
                        <div class="progress-text">🎉 Congratulations!</div>
                    </div>
                    <button class="nav-button overview" onclick="showModule(0)">
                        🏠 Back to Overview
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>&copy; 2025 Texas Transportation Code Study Guide. All rights reserved.</p>
        </div>
    </div>

    <style>
        @keyframes incorrectOption {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }
    </style>
    <script>
        // Debug: Ensure JavaScript is loading
        console.log('JavaScript loading started...');
        
        let currentModule = 0;
        let completedModules = new Set();
        let studyTime = {};
        let startTime = Date.now();

        console.log('Variables initialized...');

        // Enhanced module display with animations
        function showModule(moduleNum) {
            // Track study time for previous module
            if (currentModule > 0) {
                const timeSpent = Date.now() - startTime;
                if (!studyTime[currentModule]) studyTime[currentModule] = 0;
                studyTime[currentModule] += timeSpent;
            }
            
            startTime = Date.now();

            // Hide all module content with fade effect
            const allContent = document.querySelectorAll('.module-content');
            allContent.forEach(content => {
                content.classList.remove('active');
                content.style.opacity = '0';
            });

            // Hide modules grid when showing content
            const modulesGrid = document.getElementById('modulesGrid');
            
            if (moduleNum === 0) {
                // Show overview (modules grid)
                modulesGrid.style.display = 'grid';
                currentModule = 0;
                updateModuleProgress();
            } else {
                // Show specific module content
                modulesGrid.style.display = 'none';
                const moduleContent = document.getElementById(`module${moduleNum}`);
                if (moduleContent) {
                    setTimeout(() => {
                        moduleContent.classList.add('active');
                        moduleContent.style.opacity = '1';
                    }, 200);
                }
                currentModule = moduleNum;
                
                // Mark as in progress if not completed
                if (!completedModules.has(moduleNum)) {
                    markModuleInProgress(moduleNum);
                }
            }

            // Update navigation buttons
            updateNavButtons();
            
            // Scroll to top smoothly
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Update reading progress
            updateReadingProgress();
        }

        function updateNavButtons() {
            const navButtons = document.querySelectorAll('.nav-btn');
            navButtons.forEach((btn, index) => {
                btn.classList.remove('active');
                if (index === currentModule) {
                    btn.classList.add('active');
                }
            });
        }

        function markModuleInProgress(moduleNum) {
            const moduleCards = document.querySelectorAll('.module-card');
            if (moduleCards[moduleNum - 1]) {
                const statusBadge = moduleCards[moduleNum - 1].querySelector('.status-badge');
                if (!statusBadge.classList.contains('completed')) {
                    statusBadge.textContent = 'In Progress';
                    statusBadge.className = 'status-badge in-progress';
                }
            }
        }

        function markModuleComplete(moduleNum) {
            completedModules.add(moduleNum);
            updateProgress();
            
            // Update module card status with animation
            const moduleCards = document.querySelectorAll('.module-card');
            if (moduleCards[moduleNum - 1]) {
                const card = moduleCards[moduleNum - 1];
                card.classList.add('completed');
                
                const statusBadge = card.querySelector('.status-badge');
                statusBadge.textContent = 'Completed';
                statusBadge.className = 'status-badge completed';
                
                // Add completion animation
                card.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    card.style.transform = '';
                }, 300);
            }
            
            // Show completion notification
            showNotification(`Module ${moduleNum} completed! 🎉`, 'success');
        }

        function updateProgress() {
            const total = 7;
            const completed = completedModules.size;
            const percentage = (completed / total) * 100;
            
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            progressBar.style.width = percentage + '%';
            progressText.textContent = `Progress: ${completed} of ${total} modules completed (${Math.round(percentage)}%)`;
            
            // Update overall module progress
            updateModuleProgress();
        }

        function updateModuleProgress() {
            const moduleCards = document.querySelectorAll('.module-card');
            moduleCards.forEach((card, index) => {
                const moduleNum = index + 1;
                const title = card.querySelector('.module-title');
                const description = card.querySelector('.module-description');
                
                // Update module titles and descriptions based on content
                const moduleTitles = [
                    'Texas Penal Code & Registration',
                    'Traffic Rules & Regulations',
                    'Vehicle Equipment & Safety',
                    'Commercial Vehicle Operations',
                    'Traffic Control Devices',
                    'Enforcement Procedures',
                    'Crash Investigation & Reporting'
                ];
                
                const moduleDescriptions = [
                    'Learn about Texas Penal Code definitions, vehicle registration requirements, and warning device regulations.',
                    'Master traffic rules, right-of-way laws, speed regulations, and driving restrictions.',
                    'Understand vehicle equipment standards, inspection requirements, and safety protocols.',
                    'Study commercial motor vehicle regulations, licensing, and operational requirements.',
                    'Explore traffic signs, signals, markings, and their legal implications.',
                    'Learn enforcement procedures, citation processes, and legal authorities.',
                    'Master crash investigation techniques, reporting requirements, and documentation.'
                ];
                
                // Update the module card with proper title and description
                if (title && moduleTitles[moduleNum - 1]) {
                    title.textContent = moduleTitles[moduleNum - 1];
                }
                if (description && moduleDescriptions[moduleNum - 1]) {
                    description.textContent = moduleDescriptions[moduleNum - 1];
                }
            });
        }

        // Reading progress tracking
        function updateReadingProgress() {
            const readingProgress = document.getElementById('readingProgress');
            if (currentModule === 0) {
                readingProgress.style.width = '0%';
                return;
            }
        
            const activeContent = document.querySelector('.module-content.active');
            if (!activeContent) return;
        
            const scrollTop = window.pageYOffset;
            const docHeight = activeContent.offsetHeight;
            const winHeight = window.innerHeight;
            const scrollPercent = scrollTop / (docHeight - winHeight);
            const scrollPercentRounded = Math.round(scrollPercent * 100);
        
            if (scrollPercentRounded <= 100) {
                readingProgress.style.width = scrollPercentRounded + '%';
            }
        }
        
        window.addEventListener('scroll', updateReadingProgress);

        // Scroll to top functionality
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Show/hide scroll to top button
        window.addEventListener('scroll', () => {
            const scrollToTopBtn = document.getElementById('scrollToTop');
            if (window.pageYOffset > 300) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        });

        // Enhanced notification system
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notif => notif.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icons = {
                'success': '🎉',
                'error': '❌',
                'warning': '⚠️',
                'info': '💡'
            };
            
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${icons[type] || icons.info}</span>
                    <span class="notification-message">${message}</span>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">×</button>
            `;
            
            // Add enhanced styles
            Object.assign(notification.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                zIndex: '10000',
                padding: '15px 20px',
                borderRadius: '15px',
                color: 'white',
                fontWeight: '600',
                fontSize: '0.95rem',
                boxShadow: '0 10px 30px rgba(0, 0, 0, 0.2), 0 4px 15px rgba(0, 0, 0, 0.1)',
                backdropFilter: 'blur(15px)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'space-between',
                gap: '15px',
                maxWidth: '400px',
                minWidth: '280px',
                transform: 'translateX(120%) scale(0.8)',
                transition: 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
                border: '1px solid rgba(255, 255, 255, 0.2)'
            });
            
            // Set background based on type
            const backgrounds = {
                'success': 'linear-gradient(135deg, #2ecc71, #27ae60)',
                'error': 'linear-gradient(135deg, #e74c3c, #c0392b)', 
                'warning': 'linear-gradient(135deg, #f39c12, #e67e22)',
                'info': 'linear-gradient(135deg, #3498db, #2980b9)'
            };
            
            notification.style.background = backgrounds[type] || backgrounds.info;
            
            // Style notification content
            const content = notification.querySelector('.notification-content');
            Object.assign(content.style, {
                display: 'flex',
                alignItems: 'center',
                gap: '10px',
                flex: '1'
            });
            
            // Style close button
            const closeBtn = notification.querySelector('.notification-close');
            Object.assign(closeBtn.style, {
                background: 'rgba(255, 255, 255, 0.2)',
                border: 'none',
                borderRadius: '50%',
                width: '25px',
                height: '25px',
                color: 'white',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '16px',
                fontWeight: 'bold',
                transition: 'all 0.3s ease'
            });
            
            closeBtn.onmouseover = () => {
                closeBtn.style.background = 'rgba(255, 255, 255, 0.3)';
                closeBtn.style.transform = 'scale(1.1)';
            };
            
            closeBtn.onmouseout = () => {
                closeBtn.style.background = 'rgba(255, 255, 255, 0.2)';
                closeBtn.style.transform = 'scale(1)';
            };
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0) scale(1)';
            }, 100);
            
            // Auto remove after delay
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.style.transform = 'translateX(120%) scale(0.8)';
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 400);
                }
            }, type === 'success' ? 3000 : 5000);
        }

        // Auto-save progress to localStorage
        function saveProgress() {
            const progressData = {
                completedModules: Array.from(completedModules),
                studyTime: studyTime,
                lastAccessed: Date.now()
            };
            localStorage.setItem('txTransportationCodeProgress', JSON.stringify(progressData));
        }

        // Load progress from localStorage
        function loadProgress() {
            const saved = localStorage.getItem('txTransportationCodeProgress');
            if (saved) {
                const progressData = JSON.parse(saved);
                completedModules = new Set(progressData.completedModules || []);
                studyTime = progressData.studyTime || {};
                updateProgress();
            }
        }

        // Auto-complete modules based on scroll behavior
        function trackModuleCompletion() {
            if (currentModule === 0) return;

            const activeContent = document.querySelector('.module-content.active');
            if (!activeContent) return;

            const scrollTop = window.pageYOffset;
            const docHeight = activeContent.offsetHeight;
            const winHeight = window.innerHeight;
            const scrollPercent = scrollTop / (docHeight - winHeight);

            // Mark as complete if user scrolled through 90% of content and spent at least 2 minutes
            const timeSpent = (studyTime[currentModule] || 0) + (Date.now() - startTime);
            if (scrollPercent >= 0.9 && timeSpent >= 120000 && !completedModules.has(currentModule)) {
                markModuleComplete(currentModule);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) return; // Don't interfere with browser shortcuts
            
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    if (currentModule > 0) showModule(Math.max(0, currentModule - 1));
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    if (currentModule < 7) showModule(Math.min(7, currentModule + 1));
                    break;
                case 'Home':
                    e.preventDefault();
                    showModule(0);
                    break;
                case 'Escape':
                    e.preventDefault();
                    showModule(0);
                    break;
            }
        });

        // Interactive Quiz System
        const quizData = [
            {
                id: 1,
                chapter: "Chapter 472",
                question: "A person who drives around a barricade that has been placed because water is over the roadway commits a Class B Misdemeanor.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 0,
                explanation: "TRUE - Section 472.022. This is a Class B Misdemeanor offense when someone drives around a barricade placed due to water over the roadway.",
                section: "472.022"
            },
            {
                id: 2,
                chapter: "Chapter 502",
                question: "How many days does a new state resident have to register their vehicles in Texas?",
                type: "text",
                correct: "30",
                alternateAnswers: ["30 days", "thirty", "thirty days"],
                explanation: "30 DAYS - Section 502.040. New residents must register their vehicles within 30 days of establishing residency in Texas.",
                section: "502.040"
            },
            {
                id: 3,
                chapter: "Chapter 502",
                question: "DMV may register an off-highway vehicle owned by the state, a county, or a municipality, however a private individual is not permitted to register an off-highway vehicle.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 502.143. Private individuals may also register off-highway vehicles under certain circumstances.",
                section: "502.143"
            },
            {
                id: 4,
                chapter: "Chapter 502",
                question: "A farm trailer with a gross weight of less than 4,000 pounds is not required to display a license plate.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 0,
                explanation: "TRUE - Section 502.146. Farm trailers under 4,000 pounds gross weight are exempt from license plate requirements.",
                section: "502.146"
            },
            {
                id: 5,
                chapter: "Chapter 502",
                question: "A professional rodeo cowboy operating a pick-up and trailer bearing farm license plates on his way to the rodeo commits a violation because he is engaged in gainful employment.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - The activity must be farming-related. Going to a rodeo as a professional cowboy is not considered farming activity.",
                section: "502.163"
            },
            {
                id: 6,
                chapter: "Chapter 502",
                question: "An expired registration certificate does not become a violation of the law until after how long?",
                type: "text",
                correct: "5 working days",
                alternateAnswers: ["5 days", "five working days", "five days", "5 business days", "five business days"],
                explanation: "5 WORKING DAYS - Section 502.407. There is a 5 working day grace period before an expired registration becomes a violation.",
                section: "502.407"
            },
            {
                id: 7,
                chapter: "Chapter 503",
                question: "Where is a metal dealer license plate required to be displayed?",
                type: "text",
                correct: "rear of vehicle",
                alternateAnswers: ["rear", "back of vehicle", "back", "on the rear", "at the rear"],
                explanation: "REAR OF VEHICLE - Section 503.061. Metal dealer plates must be displayed on the rear of the vehicle.",
                section: "503.061"
            },
            {
                id: 8,
                chapter: "Chapter 503",
                question: "A dealer temporary tag may be used when a vehicle is being road tested by a prospective buyer.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 0,
                explanation: "TRUE - Section 503.062. Dealer temporary tags are authorized for road testing by prospective buyers.",
                section: "503.062"
            },
            {
                id: 9,
                chapter: "Chapter 503",
                question: "A dealer temporary tag may be used when a dealer is loaning a vehicle to a person while the person's own vehicle is being repaired.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 503.062. Dealer temporary tags cannot be used for loaner vehicles during repairs.",
                section: "503.062"
            },
            {
                id: 10,
                chapter: "Chapter 503",
                question: "A buyer's temporary tag is valid for a maximum of how many days?",
                type: "text",
                correct: "60",
                alternateAnswers: ["60 days", "sixty", "sixty days"],
                explanation: "60 DAYS - Section 503.063. Buyer's temporary tags are valid for a maximum of 60 days.",
                section: "503.063"
            },
            {
                id: 11,
                chapter: "Chapter 503",
                question: "A dealership may issue a second buyer's temporary tag for a vehicle if the first tag expires before regular license plates are issued for a vehicle.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 503.063. Only one buyer's temporary tag may be issued per vehicle purchase.",
                section: "503.063"
            },
            {
                id: 12,
                chapter: "Chapter 504",
                question: "Texas license plates may be displayed in the front windshield as long as they are visible and readable from the front of the vehicle.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 504.943. License plates must be mounted on the vehicle exterior, not in the windshield.",
                section: "504.943"
            },
            {
                id: 13,
                chapter: "Chapter 504",
                question: "A trailer may display its license plate vertically as long as it is visible from the rear of the vehicle.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 504.943. License plates must be displayed horizontally, not vertically.",
                section: "504.943"
            },
            {
                id: 14,
                chapter: "Chapter 504",
                question: "A person may buy license plates from a non-DMV vendor as long as the license plates display the correct state name and license plate number.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 504.944. License plates must be obtained only from authorized DMV sources.",
                section: "504.944"
            },
            {
                id: 15,
                chapter: "Chapter 504",
                question: "A person may display a deceptively similar license plate on the front of their vehicle as long as the DMV issued plate is properly displayed on the rear.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 504.945. Deceptively similar license plates are prohibited regardless of proper rear plate display.",
                section: "504.945"
            },
            // Module 2 Quiz Questions (Chapters 521-522)
            {
                id: 16,
                chapter: "Chapter 521",
                question: "A driver license is defined as an authorization issued by the department for the operation of a motor vehicle.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 0,
                explanation: "TRUE - Section 521.001(3). A driver license is specifically defined as an authorization to operate a motor vehicle.",
                section: "521.001"
            },
            {
                id: 17,
                chapter: "Chapter 521",
                question: "A Segway (electric personal assistive mobility device) operator is required to have a driver's license.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Segways are specifically excluded from the definition of motor vehicle in 541.201, so no driver's license is required.",
                section: "521.021"
            },
            {
                id: 18,
                chapter: "Chapter 521",
                question: "Which of the following persons are exempt from driver license requirements?",
                type: "multiple-choice",
                options: ["Military personnel operating military vehicles", "Farmers operating implements of husbandry", "Non-resident military personnel licensed in another state", "All of the above"],
                correct: 3,
                explanation: "ALL OF THE ABOVE - Section 521.027 lists all these exemptions from license requirements.",
                section: "521.027"
            },
            {
                id: 19,
                chapter: "Chapter 521",
                question: "What is the maximum GCWR for a Class C license when operating a combination of vehicles?",
                type: "text",
                correct: "26,000",
                alternateAnswers: ["26000", "26,000 lbs", "26000 lbs", "twenty-six thousand"],
                explanation: "26,000 LBS - Class C licenses are limited to combinations under 26,001 lbs GCWR.",
                section: "521.083"
            },
            {
                id: 20,
                chapter: "Chapter 521",
                question: "A Class A license holder can operate motorcycles without a Class M license.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 521.085. Motorcycles always require a Class M license regardless of other license classes held.",
                section: "521.085"
            },
            {
                id: 21,
                chapter: "Chapter 522",
                question: "What is the minimum GVWR that requires a CDL for a single unit vehicle?",
                type: "text",
                correct: "26,001",
                alternateAnswers: ["26001", "26,001 lbs", "26001 lbs", "twenty-six thousand one"],
                explanation: "26,001 LBS - Section 522.003. Commercial motor vehicles with GVWR of 26,001 lbs or more require a CDL.",
                section: "522.003"
            },
            {
                id: 22,
                chapter: "Chapter 522",
                question: "A recreational vehicle (RV) operated for personal use requires a CDL if it weighs over 26,000 lbs.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 1,
                explanation: "FALSE - Section 522.004. Recreational vehicles operated for personal use are exempt from CDL requirements.",
                section: "522.004"
            },
            {
                id: 23,
                chapter: "Chapter 522",
                question: "What endorsement is required to operate a school bus?",
                type: "text",
                correct: "S",
                alternateAnswers: ["S endorsement", "School bus endorsement"],
                explanation: "S ENDORSEMENT - Section 522.012. School buses require an S endorsement on the CDL.",
                section: "522.012"
            },
            {
                id: 24,
                chapter: "Chapter 522",
                question: "The alcohol limit for CDL holders operating a commercial motor vehicle is:",
                type: "multiple-choice",
                options: ["0.02 BAC", "0.04 BAC", "0.06 BAC", "0.08 BAC"],
                correct: 1,
                explanation: "0.04 BAC - Section 522.022. CDL holders have a lower alcohol limit of 0.04 when operating commercial vehicles.",
                section: "522.022"
            },
            {
                id: 25,
                chapter: "Chapter 522",
                question: "A CDL holder who gets a DWI in their personal car will face CDL disqualification.",
                type: "multiple-choice",
                options: ["True", "False"],
                correct: 0,
                explanation: "TRUE - Section 522.021. CDL disqualifications apply for DWI convictions in ANY motor vehicle, not just commercial vehicles.",
                section: "522.021"
            }
        ];

        let currentQuiz = {
            answers: {},
            currentQuestion: 0,
            score: 0,
            completed: false
        };

        function initializeQuiz() {
            const container = document.getElementById('quizContainer');
            if (!container) return;

            container.innerHTML = '';
            
            quizData.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.id = `question-${question.id}`;
                
                let optionsHTML = '';
                
                if (question.type === 'multiple-choice') {
                    optionsHTML = `
                        <div class="question-options multiple-choice">
                            ${question.options.map((option, optionIndex) => `
                                <div class="option" onclick="selectAnswer(${question.id}, ${optionIndex})" data-option="${optionIndex}">
                                    <span class="option-label">${String.fromCharCode(65 + optionIndex)}.</span>
                                    <span class="option-text">${option}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (question.type === 'text') {
                    optionsHTML = `
                        <div class="question-options">
                            <input type="text" class="text-input" id="text-input-${question.id}" 
                                   placeholder="Type your answer here..." 
                                   onblur="selectTextAnswer(${question.id}, this.value)"
                                   onkeypress="if(event.key==='Enter') selectTextAnswer(${question.id}, this.value)">
                        </div>
                    `;
                }
                
                questionDiv.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${question.id}</div>
                        <div class="question-chapter">${question.chapter}</div>
                    </div>
                    <div class="question-text">${question.question}</div>
                    ${optionsHTML}
                    <div class="feedback" id="feedback-${question.id}"></div>
                `;
                
                container.appendChild(questionDiv);
            });
        }

        function selectAnswer(questionId, selectedOption) {
            const question = quizData.find(q => q.id === questionId);
            if (!question || currentQuiz.answers[questionId]) return; // Already answered
            
            const questionDiv = document.getElementById(`question-${questionId}`);
            const options = questionDiv.querySelectorAll('.option');
            const feedback = document.getElementById(`feedback-${questionId}`);
            
            // Mark as answered
            currentQuiz.answers[questionId] = selectedOption;
            questionDiv.classList.add('answered');
            
            // Show selection
            options[selectedOption].classList.add('selected');
            
            // Show correct/incorrect
            const isCorrect = selectedOption === question.correct;
            if (isCorrect) {
                currentQuiz.score++;
                options[selectedOption].classList.add('correct');
                questionDiv.classList.add('correct');
                feedback.className = 'feedback correct show';
                feedback.innerHTML = `
                    <strong>✅ Correct!</strong><br>
                    ${question.explanation}<br>
                    <small><strong>Reference:</strong> TRC Section ${question.section}</small>
                `;
            } else {
                options[selectedOption].classList.add('incorrect');
                options[question.correct].classList.add('correct');
                questionDiv.classList.add('incorrect');
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `
                    <strong>❌ Incorrect.</strong><br>
                    The correct answer is: <strong>${question.options[question.correct]}</strong><br>
                    ${question.explanation}<br>
                    <small><strong>Reference:</strong> TRC Section ${question.section}</small>
                `;
            }
            
            updateQuizProgress();
            
            // Auto-scroll to next question after a delay
            setTimeout(() => {
                const nextQuestion = document.getElementById(`question-${questionId + 1}`);
                if (nextQuestion && !currentQuiz.answers[questionId + 1]) {
                    nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 2000);
        }

        function selectTextAnswer(questionId, answer) {
            const question = quizData.find(q => q.id === questionId);
            if (!question || currentQuiz.answers[questionId]) return; // Already answered
            
            const input = document.getElementById(`text-input-${questionId}`);
            const questionDiv = document.getElementById(`question-${questionId}`);
            const feedback = document.getElementById(`feedback-${questionId}`);
            
            if (!answer.trim()) return; // Empty answer
            
            // Mark as answered
            currentQuiz.answers[questionId] = answer.trim();
            questionDiv.classList.add('answered');
            input.disabled = true;
            
            // Check if correct
            const normalizedAnswer = answer.trim().toLowerCase();
            const correctAnswers = [question.correct.toLowerCase()];
            if (question.alternateAnswers) {
                correctAnswers.push(...question.alternateAnswers.map(a => a.toLowerCase()));
            }
            
            const isCorrect = correctAnswers.some(correct => 
                normalizedAnswer === correct || 
                normalizedAnswer.includes(correct) || 
                correct.includes(normalizedAnswer)
            );
            
            if (isCorrect) {
                currentQuiz.score++;
                input.classList.add('correct');
                questionDiv.classList.add('correct');
                feedback.className = 'feedback correct show';
                feedback.innerHTML = `
                    <strong>✅ Correct!</strong><br>
                    ${question.explanation}<br>
                    <small><strong>Reference:</strong> TRC Section ${question.section}</small>
                `;
            } else {
                input.classList.add('incorrect');
                questionDiv.classList.add('incorrect');
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `
                    <strong>❌ Incorrect.</strong><br>
                    The correct answer is: <strong>${question.correct}</strong><br>
                    ${question.explanation}<br>
                    <small><strong>Reference:</strong> TRC Section ${question.section}</small>
                `;
            }
            
            updateQuizProgress();
            
            // Auto-scroll to next question after a delay
            setTimeout(() => {
                const nextQuestion = document.getElementById(`question-${questionId + 1}`);
                if (nextQuestion && !currentQuiz.answers[questionId + 1]) {
                    nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 2000);
        }

        function updateQuizProgress() {
            const totalQuestions = quizData.length;
            const answeredQuestions = Object.keys(currentQuiz.answers).length;
            const percentage = (answeredQuestions / totalQuestions) * 100;
            
            const progressBar = document.getElementById('quizProgressBar');
            const progressText = document.getElementById('quizProgressText');
            
            if (progressBar) {
                // Create and update progress bar directly
                progressBar.style.background = `linear-gradient(90deg, #3498db ${percentage}%, rgba(255,255,255,0.1) ${percentage}%)`;
            }
            
            if (progressText) {
                progressText.textContent = `${answeredQuestions} of ${totalQuestions} questions answered`;
            }
            
            // Show results if all questions answered
            if (answeredQuestions === totalQuestions && !currentQuiz.completed) {
                currentQuiz.completed = true;
                setTimeout(showQuizResults, 1000);
            }
        }

        function showQuizResults() {
            const resultsDiv = document.getElementById('quizResults');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const resultsBreakdown = document.getElementById('resultsBreakdown');
            
            if (!resultsDiv || !scoreDisplay || !resultsBreakdown) return;
            
            const totalQuestions = quizData.length;
            const percentage = Math.round((currentQuiz.score / totalQuestions) * 100);
            
            // Determine score category
            let scoreClass = 'poor';
            let scoreMessage = 'Keep studying!';
            if (percentage >= 90) {
                scoreClass = 'excellent';
                scoreMessage = 'Outstanding! 🌟';
            } else if (percentage >= 80) {
                scoreClass = 'good';
                scoreMessage = 'Great job! 👏';
            } else if (percentage >= 70) {
                scoreClass = 'fair';
                scoreMessage = 'Good effort! 📈';
            }
            
            scoreDisplay.className = `score-display ${scoreClass}`;
            scoreDisplay.innerHTML = `
                ${percentage}%<br>
                <small style="font-size: 0.6em; opacity: 0.9;">${scoreMessage}</small>
            `;
            
            resultsBreakdown.innerHTML = `
                <div class="result-stat">
                    <h5>Correct Answers</h5>
                    <div class="value" style="color: #2ecc71;">${currentQuiz.score}</div>
                </div>
                <div class="result-stat">
                    <h5>Incorrect Answers</h5>
                    <div class="value" style="color: #e74c3c;">${totalQuestions - currentQuiz.score}</div>
                </div>
                <div class="result-stat">
                    <h5>Completion Rate</h5>
                    <div class="value" style="color: #3498db;">100%</div>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Show completion notification
            showNotification(`Quiz completed! You scored ${percentage}% (${currentQuiz.score}/${totalQuestions})`, percentage >= 80 ? 'success' : 'info');
        }

        function restartQuiz(moduleNum = 1) {
            if (moduleNum === 2) {
                currentQuiz2 = {
                    answers: {},
                    score: 0,
                    completed: false
                };
                
                const resultsDiv = document.getElementById('quiz2Results');
                if (resultsDiv) {
                    resultsDiv.style.display = 'none';
                }
                
                const questions = document.querySelectorAll('#quiz2Questions .quiz-question');
                questions.forEach(questionDiv => {
                    questionDiv.className = 'quiz-question';
                    const options = questionDiv.querySelectorAll('.option');
                    options.forEach(option => {
                        option.className = 'option';
                    });
                    const feedback = questionDiv.querySelector('.feedback');
                    if (feedback) {
                        feedback.className = 'feedback';
                        feedback.innerHTML = '';
                    }
                });
                
                showNotification('Module 2 Quiz restarted!', 'info');
            } else {
                // Handle Module 1 quiz restart
                currentQuiz = {
                    answers: {},
                    currentQuestion: 0,
                    score: 0,
                    completed: false
                };
                
                const resultsDiv = document.getElementById('quizResults');
                if (resultsDiv) {
                    resultsDiv.style.display = 'none';
                }
                
                const questions = document.querySelectorAll('#quizContainer .quiz-question');
                questions.forEach(questionDiv => {
                    questionDiv.className = 'quiz-question';
                    const options = questionDiv.querySelectorAll('.option');
                    options.forEach(option => {
                        option.className = 'option';
                    });
                    const textInput = questionDiv.querySelector('.text-input');
                    if (textInput) {
                        textInput.value = '';
                        textInput.disabled = false;
                        textInput.className = 'text-input';
                    }
                    const feedback = questionDiv.querySelector('.feedback');
                    if (feedback) {
                        feedback.className = 'feedback';
                        feedback.innerHTML = '';
                    }
                });
                
                showNotification('Quiz restarted!', 'info');
            }
        }

        function checkDateAnswer(input, correctAnswer, sectionId) {
            const userAnswer = input.value.trim();
            
            // Various acceptable formats for the date
            const acceptableAnswers = [
                'june 7, 2021',
                'june 7 2021', 
                'june 8, 2021',
                'june 8 2021',
                '6/7/2021',
                '6/8/2021',
                '06/07/2021',
                '06/08/2021',
                'tuesday, june 8',
                'june 8'
            ];
            
            const normalizedUser = userAnswer.toLowerCase().replace(/[^a-z0-9]/g, '');
            const isCorrect = acceptableAnswers.some(answer => 
                normalizedUser.includes(answer.replace(/[^a-z0-9]/g, '')) ||
                normalizedUser === answer.replace(/[^a-z0-9]/g, '')
            );
            
            if (userAnswer) {
                input.disabled = true;
                if (isCorrect) {
                    input.classList.add('correct');
                    showNotification(`Correct! The first enforcement day is Tuesday, June 8, 2021`, 'success');
                } else {
                    input.classList.add('incorrect');
                    input.value = `${userAnswer} → Tuesday, June 8, 2021`;
                    showNotification(`The correct answer is Tuesday, June 8, 2021 (after 5th business day)`, 'info');
                }
                
                // Show feedback after date is completed
                setTimeout(() => {
                    const feedback = document.getElementById(`feedback-apply-it-${sectionId}`);
                    if (!feedback.classList.contains('show')) {
                        feedback.classList.add('show');
                        feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 1000);
            }
        }

        function selectMultipleChoice(sectionId, choice, isViolation) {
            const option = document.querySelector(`[data-answer="${choice}"]`);
            
            if (option.classList.contains('selected')) {
                // Deselect
                option.classList.remove('selected', 'correct', 'incorrect');
                delete applyItAnswers[`${sectionId}_${choice}`];
            } else {
                // Select
                option.classList.add('selected');
                if (isViolation) {
                    option.classList.add('correct');
                } else {
                    option.classList.add('incorrect');
                }
                applyItAnswers[`${sectionId}_${choice}`] = { choice, isViolation };
            }
            
            // Check if we should show feedback
            const section = document.getElementById(`apply-it-${sectionId}`);
            const allOptions = section.querySelectorAll('[data-answer]');
            const selectedOptions = section.querySelectorAll('.selected');
            
            // Show feedback if at least 2 options selected or after 3 seconds
            if (selectedOptions.length >= 2) {
                setTimeout(() => {
                    const feedback = document.getElementById(`feedback-apply-it-${sectionId}`);
                    if (!feedback.classList.contains('show')) {
                        feedback.classList.add('show');
                        feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 1000);
            }
        }

        // Interactive Apply It System
        let applyItAnswers = {};

        // Enhanced Apply It function for better user experience
        function selectApplyItAnswer(sectionId, answer, isCorrect, event) {
            // Find the clicked element more reliably
            let clickedElement = null;
            
            if (event && event.target) {
                clickedElement = event.target;
            } else {
                // Fallback: find element by onclick attribute
                clickedElement = document.querySelector(`[onclick*="selectApplyItAnswer(${typeof sectionId === 'string' ? "'" + sectionId + "'" : sectionId}, '${answer}', ${isCorrect})"]`);
            }
            
            if (!clickedElement) {
                console.log('Could not find clicked element');
                return;
            }
            
            const parentSection = clickedElement.closest('.apply-it-section');
            if (!parentSection) {
                console.log('Could not find parent section');
                return;
            }
            
            const options = parentSection.querySelectorAll('.apply-it-option');
            let feedbackDiv = parentSection.querySelector('.apply-it-feedback');
            
            if (!feedbackDiv) {
                feedbackDiv = createFeedbackDiv(parentSection);
            }
            
            // Disable all options and remove any existing states
            options.forEach(option => {
                option.style.pointerEvents = 'none';
                option.classList.remove('selected', 'correct', 'incorrect');
                option.innerHTML = option.innerHTML.replace(/ <span.*?<\/span>/, ''); // Remove existing icons
            });
            
            // Add selection state with enhanced animation
            clickedElement.classList.add('selected');
            
            // Wait for selection animation to complete
            setTimeout(() => {
                if (isCorrect) {
                    clickedElement.classList.remove('selected');
                    clickedElement.classList.add('correct');
                    clickedElement.innerHTML += ' <span style="animation: correctBounce 0.6s ease-out;">✅</span>';
                    
                    showFeedback(feedbackDiv, 'Excellent! That\'s the correct answer.', 'correct');
                    showNotification('Correct! 🎉', 'success');
                    
                    // Add points or progress tracking
                    updateApplyItProgress();
                } else {
                    clickedElement.classList.remove('selected');
                    clickedElement.classList.add('incorrect');
                    clickedElement.innerHTML += ' <span style="animation: errorShake 0.6s ease-out;">❌</span>';
                    
                    // Find and highlight the correct answer
                    const correctOption = Array.from(options).find(opt => {
                        const onclickStr = opt.getAttribute('onclick') || '';
                        return onclickStr.includes('true');
                    });
                    
                    if (correctOption) {
                        setTimeout(() => {
                            correctOption.classList.add('correct');
                            correctOption.innerHTML += ' <span style="animation: correctBounce 0.6s ease-out;">✅ Correct Answer</span>';
                        }, 800);
                    }
                    
                    showFeedback(feedbackDiv, 'Not quite right. The correct answer is highlighted above.', 'incorrect');
                    showNotification('Try again next time! 📚', 'info');
                }
            }, 300);
        }

        // Create feedback div if it doesn't exist
        function createFeedbackDiv(parentSection) {
            const feedbackDiv = document.createElement('div');
            feedbackDiv.className = 'apply-it-feedback';
            feedbackDiv.style.display = 'none';
            parentSection.appendChild(feedbackDiv);
            return feedbackDiv;
        }

        // Enhanced feedback display
        function showFeedback(feedbackDiv, message, type) {
            feedbackDiv.className = `apply-it-feedback ${type}`;
            feedbackDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">${type === 'correct' ? '🎯' : '💡'}</span>
                    <strong>${type === 'correct' ? 'Correct!' : 'Not Quite'}</strong>
                </div>
                <p style="margin-top: 10px; opacity: 0.9;">${message}</p>
            `;
            
            feedbackDiv.style.display = 'block';
            feedbackDiv.classList.add('show');
            
            // Smooth scroll to feedback
            setTimeout(() => {
                feedbackDiv.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'nearest',
                    inline: 'nearest'
                });
            }, 100);
        }

        // Enhanced Apply It functions
        function checkApplyIt(element, isCorrect) {
            if (!element) return;
            
            const parentSection = element.closest('.apply-it-section');
            if (!parentSection) return;
            
            const options = parentSection.querySelectorAll('.apply-it-option');
            let feedbackDiv = parentSection.querySelector('.apply-it-feedback');
            
            if (!feedbackDiv) {
                feedbackDiv = createFeedbackDiv(parentSection);
            }
            
            // Disable all options and remove any existing states
            options.forEach(option => {
                option.style.pointerEvents = 'none';
                option.classList.remove('selected', 'correct', 'incorrect');
                option.innerHTML = option.innerHTML.replace(/ <span.*?<\/span>/, ''); // Remove existing icons
            });
            
            // Add selection state with enhanced animation
            element.classList.add('selected');
            
            // Wait for selection animation to complete
            setTimeout(() => {
                if (isCorrect) {
                    element.classList.remove('selected');
                    element.classList.add('correct');
                    element.innerHTML += ' <span style="animation: correctBounce 0.6s ease-out;">✅</span>';
                    
                    showFeedback(feedbackDiv, 'Excellent! That\'s the correct answer.', 'correct');
                    showNotification('Correct! 🎉', 'success');
                    
                    // Add points or progress tracking
                    updateApplyItProgress();
                } else {
                    element.classList.remove('selected');
                    element.classList.add('incorrect');
                    element.innerHTML += ' <span style="animation: errorShake 0.6s ease-out;">❌</span>';
                    
                    // Find and highlight the correct answer
                    const correctOption = Array.from(options).find(opt => {
                        const onclickStr = opt.getAttribute('onclick') || '';
                        return onclickStr.includes('true');
                    });
                    
                    if (correctOption) {
                        setTimeout(() => {
                            correctOption.classList.add('correct');
                            correctOption.innerHTML += ' <span style="animation: correctBounce 0.6s ease-out;">✅ Correct Answer</span>';
                        }, 800);
                    }
                    
                    showFeedback(feedbackDiv, 'Not quite right. The correct answer is highlighted above.', 'incorrect');
                    showNotification('Try again next time! 📚', 'info');
                }
            }, 300);
        }

        function checkApplyItMultiple(element, isCorrect) {
            if (!element) return;
            
            const parentSection = element.closest('.apply-it-section');
            if (!parentSection) return;
            
            let feedbackDiv = parentSection.querySelector('.apply-it-feedback');
            if (!feedbackDiv) {
                feedbackDiv = createFeedbackDiv(parentSection);
            }
            
            // Add selection state first
            element.classList.add('selected');
            
            setTimeout(() => {
                if (isCorrect) {
                    element.classList.remove('selected');
                    element.classList.add('correct');
                    element.innerHTML += ' <span style="animation: correctBounce 0.6s ease-out;">✅</span>';
                    element.style.pointerEvents = 'none';
                    
                    showNotification('Correct selection! 🎯', 'success');
                } else {
                    element.classList.remove('selected');
                    element.classList.add('incorrect');
                    element.innerHTML += ' <span style="animation: errorShake 0.6s ease-out;">❌</span>';
                    element.style.pointerEvents = 'none';
                    
                    showNotification('Incorrect selection', 'info');
                }
                
                // Check if all correct answers are selected
                const correctOptions = Array.from(parentSection.querySelectorAll('.apply-it-option')).filter(opt => {
                    const onclickStr = opt.getAttribute('onclick') || '';
                    return onclickStr.includes('true');
                });
                const selectedCorrect = parentSection.querySelectorAll('.apply-it-option.correct').length;
                
                if (selectedCorrect === correctOptions.length) {
                    // All correct answers found
                    setTimeout(() => {
                        showFeedback(feedbackDiv, 'Excellent! You\'ve identified all correct answers.', 'correct');
                        showNotification('All correct answers found! 🎉', 'success');
                        
                        // Disable remaining options
                        parentSection.querySelectorAll('.apply-it-option:not(.correct):not(.incorrect)').forEach(opt => {
                            opt.style.pointerEvents = 'none';
                            opt.style.opacity = '0.6';
                        });
                        
                        updateApplyItProgress();
                    }, 500);
                } else if (parentSection.querySelectorAll('.apply-it-option.incorrect').length > 0) {
                    // Some incorrect selections made
                    setTimeout(() => {
                        showFeedback(feedbackDiv, 'Some selections are incorrect. Try to identify all correct answers.', 'incorrect');
                    }, 500);
                }
            }, 300);
        }

        function selectApplyItAnswerProgressive(button, sectionId, correctAnswer, feedbackText) {
            const parentQuestion = button.closest('.scenario-question');
            const buttons = parentQuestion.querySelectorAll('.choice-btn');
            const feedbackDiv = document.getElementById(`${sectionId}-feedback`);
            
            // Disable all buttons
            buttons.forEach(btn => btn.disabled = true);
            
            // Add selected class to clicked button
            button.classList.add('selected');
            
            // Show feedback
            feedbackDiv.innerHTML = feedbackText;
            feedbackDiv.classList.add('show');
            
            // Progressive revelation for multi-step scenarios
            setTimeout(() => {
                const nextContainer = document.getElementById(`${getNextSectionId(sectionId)}-container`);
                if (nextContainer) {
                    nextContainer.style.display = 'block';
                    nextContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    // Show completion message if this was the last question
                    const completeContainer = document.getElementById(`${getBaseSectionId(sectionId)}-complete`);
                    if (completeContainer) {
                        completeContainer.style.display = 'block';
                        completeContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }, 1500);
        }

        function getNextSectionId(currentId) {
            // Extract base section and current number
            const parts = currentId.split(/(\d+)$/);
            if (parts.length >= 2) {
                const base = parts[0];
                const currentNum = parseInt(parts[1]);
                return `${base}${currentNum + 1}`;
            }
            return null;
        }

        function getBaseSectionId(sectionId) {
            // Remove number suffix to get base section id
            return sectionId.replace(/\d+$/, '');
        }

        function checkFillBlank(input, correctAnswer, sectionId, partId) {
            const userAnswer = input.value.trim();
            
            // Define alternate acceptable answers for different scenarios
            let acceptableAnswers = [correctAnswer.toLowerCase()];
            
            // Add specific alternate answers based on the correct answer
            if (correctAnswer.toLowerCase().includes('improperly displayed registration insignia')) {
                acceptableAnswers.push(
                    'improperly displayed registration insignia',
                    'improper registration insignia',
                    'wrong registration insignia placement',
                    'registration insignia violation',
                    'insignia placement violation',
                    'improper insignia display',
                    'misplaced registration insignia'
                );
            }
            
            const normalizedUser = userAnswer.toLowerCase().replace(/[^a-z0-9\s]/g, '');
            
            const isCorrect = acceptableAnswers.some(answer => {
                const normalizedAnswer = answer.replace(/[^a-z0-9\s]/g, '');
                return normalizedUser === normalizedAnswer || 
                       normalizedUser.includes(normalizedAnswer) ||
                       normalizedAnswer.includes(normalizedUser);
            });
            
            if (userAnswer) {
                input.disabled = true;
                if (isCorrect) {
                    input.classList.add('correct');
                    showNotification(`Correct! ${correctAnswer}`, 'success');
                } else {
                    input.classList.add('incorrect');
                    input.value = `${userAnswer} → ${correctAnswer}`;
                    showNotification(`The correct answer is ${correctAnswer}`, 'info');
                }
                
                // Check if this was the last fill-in-the-blank for this section
                const section = document.getElementById(`apply-it-${sectionId}`);
                const allBlanks = section.querySelectorAll('.apply-it-fill-blank');
                const completedBlanks = section.querySelectorAll('.apply-it-fill-blank.correct, .apply-it-fill-blank.incorrect');
                
                if (allBlanks.length === completedBlanks.length) {
                    // All blanks completed, show feedback if not already shown
                    const feedback = document.getElementById(`feedback-apply-it-${sectionId}`);
                    if (!feedback.classList.contains('show')) {
                        feedback.classList.add('show');
                        setTimeout(() => {
                            feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 300);
                    }
                }
            }
        }

        // Add progress tracking for Apply It sections
        function updateApplyItProgress() {
            const totalApplyItSections = document.querySelectorAll('.apply-it-section').length;
            const completedApplyItSections = Object.keys(applyItAnswers).length;
            
            if (totalApplyItSections > 0) {
                const applyItProgress = Math.round((completedApplyItSections / totalApplyItSections) * 100);
                console.log(`Apply It Progress: ${completedApplyItSections}/${totalApplyItSections} (${applyItProgress}%)`);
            }
        }

        // Add CSS for progress bar animation
        function addProgressBarStyles() {
            const style = document.createElement('style');
            style.textContent = `
                .quiz-progress-bar::before {
                    width: var(--progress, 0%);
                }
            `;
            document.head.appendChild(style);
        }

        // Module 2 Quiz Data and Functions
        const quiz2Data = [
            {
                id: 1,
                question: "A 'driver license' is defined as:",
                options: [
                    "Any permit to operate a motor vehicle",
                    "An authorization issued by the department for the operation of a motor vehicle",
                    "A commercial driver's license only",
                    "An identification card with driving privileges"
                ],
                correct: 1,
                explanation: "Section 521.001(3) defines a driver license as an authorization issued by the department for the operation of a motor vehicle."
            },
            {
                id: 2,
                question: "A Segway operator is required to have a driver's license.",
                options: ["True", "False"],
                correct: 1,
                explanation: "False. Segways are excluded from the definition of motor vehicle, so no driver's license is required."
            },
            {
                id: 3,
                question: "The maximum GCWR for a Class C license when operating a combination is:",
                options: ["24,000 lbs", "26,000 lbs", "28,000 lbs", "30,000 lbs"],
                correct: 1,
                explanation: "Class C licenses are limited to combinations under 26,001 lbs GCWR."
            },
            {
                id: 4,
                question: "A Class A license holder can operate motorcycles without a Class M license.",
                options: ["True", "False"],
                correct: 1,
                explanation: "False. Motorcycles always require a Class M license regardless of other license classes held."
            },
            {
                id: 5,
                question: "The minimum GVWR that requires a CDL for a single unit vehicle is:",
                options: ["24,001 lbs", "26,001 lbs", "28,001 lbs", "30,001 lbs"],
                correct: 1,
                explanation: "Commercial motor vehicles with GVWR of 26,001 lbs or more require a CDL."
            },
            {
                id: 6,
                question: "A recreational vehicle operated for personal use requires a CDL if it weighs over 26,000 lbs.",
                options: ["True", "False"],
                correct: 1,
                explanation: "False. Recreational vehicles operated for personal use are exempt from CDL requirements."
            },
            {
                id: 7,
                question: "The alcohol limit for CDL holders operating a commercial motor vehicle is:",
                options: ["0.02 BAC", "0.04 BAC", "0.06 BAC", "0.08 BAC"],
                correct: 1,
                explanation: "CDL holders have a lower alcohol limit of 0.04 when operating commercial vehicles."
            },
            {
                id: 8,
                question: "A CDL holder who gets a DWI in their personal car will face CDL disqualification.",
                options: ["True", "False"],
                correct: 0,
                explanation: "True. CDL disqualifications apply for DWI convictions in ANY motor vehicle, not just commercial vehicles."
            }
        ];

        let currentQuiz2 = {
            answers: {},
            score: 0,
            completed: false
        };

        function initializeQuiz2() {
            const container = document.getElementById('quiz2Questions');
            if (!container) return;

            container.innerHTML = '';
            
            quiz2Data.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.id = `question2-${question.id}`;
                
                const optionsHTML = question.options.map((option, optionIndex) => `
                    <div class="option" onclick="selectQuiz2Answer(${question.id}, ${optionIndex})" data-option="${optionIndex}">
                        <span class="option-label">${String.fromCharCode(65 + optionIndex)}.</span>
                        <span class="option-text">${option}</span>
                    </div>
                `).join('');
                
                questionDiv.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${question.id}</div>
                        <div class="question-chapter">Module 2</div>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="question-options multiple-choice">
                        ${optionsHTML}
                    </div>
                    <div class="feedback" id="feedback2-${question.id}"></div>
                `;
                
                container.appendChild(questionDiv);
            });
        }

        function selectQuiz2Answer(questionId, selectedOption) {
            const question = quiz2Data.find(q => q.id === questionId);
            if (!question || currentQuiz2.answers[questionId]) return;
            
            const questionDiv = document.getElementById(`question2-${questionId}`);
            const options = questionDiv.querySelectorAll('.option');
            const feedback = document.getElementById(`feedback2-${questionId}`);
            
            currentQuiz2.answers[questionId] = selectedOption;
            questionDiv.classList.add('answered');
            
            options[selectedOption].classList.add('selected');
            
            const isCorrect = selectedOption === question.correct;
            if (isCorrect) {
                currentQuiz2.score++;
                options[selectedOption].classList.add('correct');
                questionDiv.classList.add('correct');
                feedback.className = 'feedback correct show';
                feedback.innerHTML = `<strong>✅ Correct!</strong><br>${question.explanation}`;
            } else {
                options[selectedOption].classList.add('incorrect');
                options[question.correct].classList.add('correct');
                questionDiv.classList.add('incorrect');
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `<strong>❌ Incorrect.</strong><br>The correct answer is: <strong>${question.options[question.correct]}</strong><br>${question.explanation}`;
            }
            
            updateQuiz2Progress();
            
            setTimeout(() => {
                const nextQuestion = document.getElementById(`question2-${questionId + 1}`);
                if (nextQuestion && !currentQuiz2.answers[questionId + 1]) {
                    nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 2000);
        }

        function updateQuiz2Progress() {
            const totalQuestions = quiz2Data.length;
            const answeredQuestions = Object.keys(currentQuiz2.answers).length;
            
            if (answeredQuestions === totalQuestions && !currentQuiz2.completed) {
                currentQuiz2.completed = true;
                setTimeout(() => showQuiz2Results(), 1000);
            }
        }

        function showQuiz2Results() {
            const resultsDiv = document.getElementById('quiz2Results');
            const scoreDisplay = document.getElementById('score2Display');
            const resultsBreakdown = document.getElementById('results2Breakdown');
            
            if (!resultsDiv || !scoreDisplay || !resultsBreakdown) return;
            
            const totalQuestions = quiz2Data.length;
            const percentage = Math.round((currentQuiz2.score / totalQuestions) * 100);
            
            let scoreClass = 'poor';
            let scoreMessage = 'Keep studying!';
            if (percentage >= 90) {
                scoreClass = 'excellent';
                scoreMessage = 'Outstanding! 🌟';
            } else if (percentage >= 80) {
                scoreClass = 'good';
                scoreMessage = 'Great job! 👏';
            } else if (percentage >= 70) {
                scoreClass = 'fair';
                scoreMessage = 'Good effort! 📈';
            }
            
            scoreDisplay.className = `score-display ${scoreClass}`;
            scoreDisplay.innerHTML = `${percentage}%<br><small style="font-size: 0.6em; opacity: 0.9;">${scoreMessage}</small>`;
            
            resultsBreakdown.innerHTML = `
                <div class="result-stat">
                    <h5>Correct Answers</h5>
                    <div class="value" style="color: #2ecc71;">${currentQuiz2.score}</div>
                </div>
                <div class="result-stat">
                    <h5>Incorrect Answers</h5>
                    <div class="value" style="color: #e74c3c;">${totalQuestions - currentQuiz2.score}</div>
                </div>
                <div class="result-stat">
                    <h5>Completion Rate</h5>
                    <div class="value" style="color: #3498db;">100%</div>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            showNotification(`Module 2 Quiz completed! You scored ${percentage}%`, percentage >= 80 ? 'success' : 'info');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            showModule(0); // Show overview by default
            updateModuleProgress();
            
            // Initialize interactive quizzes
            initializeQuiz();
            initializeQuiz2(); // Initialize Module 2 quiz
            addProgressBarStyles();
            
            // Track scroll for completion
            window.addEventListener('scroll', trackModuleCompletion);
            
            // Auto-save progress every 30 seconds
            setInterval(saveProgress, 30000);
            
            // Save progress before page unload
            window.addEventListener('beforeunload', saveProgress);
            
            // Show welcome message
            setTimeout(() => {
                showNotification('Welcome to the Texas Transportation Code Study Guide! Use arrow keys to navigate.', 'info');
            }, 1000);
        });

        // Add smooth scroll behavior for better UX
        document.documentElement.style.scrollBehavior = 'smooth';
        
        // Debug: Confirm JavaScript loaded completely
        console.log('JavaScript loading completed successfully. showModule function:', typeof showModule);
    </script>
</body>
</html>
